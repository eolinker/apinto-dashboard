"use strict";(self.webpackChunkapinto=self.webpackChunkapinto||[]).push([[619],{4619:(Qt,_,s)=>{s.r(_),s.d(_,{ApplicationModule:()=>wt});var F=s(6895),p=s(9132),t=s(4650);let x=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-application-management"]],decls:1,vars:0,template:function(e,i){1&e&&t._UZ(0,"router-outlet")},dependencies:[p.lC],encapsulation:2}),a})();var D=s(7504),r=s(4006),z=s(1461),B=s(7623);const M=[{label:"HS256",value:"HS256"},{label:"HS384",value:"HS384"},{label:"HS512",value:"HS512"},{label:"RS256",value:"RS256"},{label:"RS384",value:"RS384"},{label:"RS512",value:"RS512"},{label:"ES256",value:"ES256"},{label:"ES384",value:"ES384"},{label:"ES512",value:"ES512"}],H=[{label:"Header",value:"header"},{label:"Query",value:"query"}],E=[{label:"exp",value:"exp"},{label:"nbf",value:"nbf"}],O=[{title:"\u5e94\u7528\u540d\u79f0"},{title:"\u5e94\u7528ID"},{title:"\u63cf\u8ff0"},{title:"\u66f4\u65b0\u8005"},{title:"\u66f4\u65b0\u65f6\u95f4"},{title:"\u64cd\u4f5c",right:!0}],U=[{key:"name",copy:!0},{key:"id",copy:!0},{key:"desc"},{key:"operator"},{key:"updateTime"},{type:"btn",right:!0,btns:[{title:"\u67e5\u770b"},{title:"\u5220\u9664"}]}],P=[{key:"key",type:"input",placeholder:"\u8bf7\u8f93\u5165Key"},{key:"value",type:"input",placeholder:"\u8bf7\u8f93\u5165Value"},{type:"btn",btns:[{title:"\u6dfb\u52a0",action:"add"}]},{type:"btn",btns:[{title:"\u6dfb\u52a0",action:"add"},{title:"\u51cf\u5c11",action:"delete"}]}],J=[{title:"\u9274\u6743\u7c7b\u578b"},{title:"\u53c2\u6570\u4f4d\u7f6e"},{title:"\u53c2\u6570\u540d"},{title:"\u53c2\u6570\u4fe1\u606f"},{title:"\u8fc7\u671f\u65f6\u95f4"},{title:"\u900f\u4f20\u4e0a\u6e38"},{title:"\u66f4\u65b0\u8005"},{title:"\u66f4\u65b0\u65f6\u95f4"},{title:"\u64cd\u4f5c",right:!0}],w=[{key:"driver",copy:!0},{key:"paramPosition"},{key:"paramName"},{key:"paramInfo",copy:!0},{key:"expireTimeString"},{key:"isTransparent"},{key:"operator"},{key:"updateTime"},{type:"btn",right:!0,btns:[{title:"\u67e5\u770b"},{title:"\u5220\u9664"}]}],Q=[{key:"key",type:"input",placeholder:"\u8bf7\u8f93\u5165Key",checkMode:"change",check:a=>!a||/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(a),errorTip:"\u9996\u5b57\u6bcd\u5fc5\u987b\u4e3a\u82f1\u6587"},{key:"value",type:"input",placeholder:"\u8bf7\u8f93\u5165Value"},{type:"btn",btns:[{title:"\u6dfb\u52a0"}]},{type:"btn",btns:[{title:"\u6dfb\u52a0"},{title:"\u51cf\u5c11"}]}],Y=[{key:"key",type:"input",placeholder:"\u8bf7\u8f93\u5165Key"},{key:"value",type:"input",placeholder:"\u8bf7\u8f93\u5165Value"},{type:"btn",btns:[{title:"\u6dfb\u52a0"}]},{type:"btn",btns:[{title:"\u6dfb\u52a0"},{title:"\u51cf\u5c11"}]}];var R=s(9538),u=s(9561),m=s(3),N=s(8344),q=s(4944),b=s(2366),V=s(5259),k=s(8002),g=s(3679),d=s(6704),f=s(999),A=s(2663);function K(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"nz-form-item",19)(1,"nz-form-control")(2,"dynamic-component",20),t.NdJ("apiDataChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.createAuthForm=n)})("apiDataChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.getDataFromDynamicComponent(n))}),t.qZA()()()}if(2&a){const e=t.oxw();t.xp6(2),t.Q6J("apiData",e.createAuthForm)("baseData",e.baseData)("nzDisabled",e.nzDisabled)("startValidate",e.startValidateDynamic)}}function j(a,l){1&a&&(t.TgZ(0,"nz-form-item",1)(1,"label",33)(2,"span",4),t._uU(3,"*"),t.qZA(),t._uU(4,"Secret\uff1a"),t.qZA(),t.TgZ(5,"nz-form-control",8),t._UZ(6,"input",34),t.qZA()())}function G(a,l){1&a&&(t.TgZ(0,"nz-form-item",1)(1,"label",35)(2,"span",4),t._uU(3,"*"),t.qZA(),t._uU(4,"RSA\u516c\u94a5\uff1a"),t.qZA(),t.TgZ(5,"nz-form-control",8),t._UZ(6,"input",36),t.qZA()())}function W(a,l){if(1&a&&(t.TgZ(0,"nz-form-item",1)(1,"label",37),t._uU(2,"\u662f\u5426Base64\u52a0\u5bc6\uff1a"),t.qZA(),t.TgZ(3,"nz-form-control"),t._UZ(4,"eo-ng-switch",38),t.qZA()()),2&a){const e=t.oxw(2);t.xp6(4),t.Q6J("nzDisabled",e.nzDisabled)}}function X(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"nz-form-item",5)(1,"label",21)(2,"span",4),t._uU(3,"*"),t.qZA(),t._uU(4,"Iss\uff1a"),t.qZA(),t.TgZ(5,"nz-form-control",8),t._UZ(6,"input",22),t.qZA()(),t.TgZ(7,"nz-form-item",1)(8,"label",23)(9,"span",4),t._uU(10,"*"),t.qZA(),t._uU(11,"\u7b7e\u540d\u7b97\u6cd5\uff1a"),t.qZA(),t.TgZ(12,"nz-form-control",8)(13,"eo-ng-select",24),t.NdJ("disabledEdit",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.disabledEdit(n))}),t.qZA()()(),t.YNc(14,j,7,0,"nz-form-item",25),t.YNc(15,G,7,0,"nz-form-item",25),t.TgZ(16,"nz-form-item",1)(17,"label",26),t._uU(18,"\u7528\u6237\u540d\uff1a"),t.qZA(),t.TgZ(19,"nz-form-control",8),t._UZ(20,"input",27),t.qZA()(),t.TgZ(21,"nz-form-item",1)(22,"label",28),t._uU(23," \u7528\u6237\u540dJsonPath\uff1a"),t.qZA(),t.TgZ(24,"nz-form-control",8),t._UZ(25,"input",29),t.qZA()(),t.TgZ(26,"nz-form-item",1)(27,"label",30),t._uU(28,"\u6821\u9a8c\u5b57\u6bb5\uff1a"),t.qZA(),t.TgZ(29,"nz-form-control",31)(30,"eo-ng-select",32),t.NdJ("disabledEdit",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.disabledEdit(n))}),t.qZA()()(),t.YNc(31,W,5,1,"nz-form-item",25)}if(2&a){const e=t.oxw();t.xp6(13),t.Q6J("nzOptions",e.listOfAlgorithm)("nzDisabled",e.nzDisabled),t.xp6(1),t.Q6J("ngIf",e.validateForm.controls.algorithm.value.includes("HS")),t.xp6(1),t.Q6J("ngIf",!e.validateForm.controls.algorithm.value.includes("HS")),t.xp6(14),t.Q6J("nzSpan",5),t.xp6(1),t.Q6J("nzOptions",e.listOfVerify)("nzDisabled",e.nzDisabled)("nzAllowClear",!0),t.xp6(1),t.Q6J("ngIf",e.validateForm.controls.algorithm.value.includes("HS"))}}function $(a,l){if(1&a&&(t.TgZ(0,"div")(1,"nz-form-item",39)(2,"label",15),t._uU(3,"\u6807\u7b7e\u4fe1\u606f\uff1a"),t.qZA(),t.TgZ(4,"nz-form-control"),t._UZ(5,"eo-ng-apinto-table",40),t.qZA()()()),2&a){const e=t.oxw();t.xp6(5),t.Q6J("nzTbody",e.labelHeaderTableBody)("nzData",e.labelHeaderList)("nzNoScroll",!0)}}const tt=function(a){return{"mb-0":a}};let et=(()=>{class a{constructor(e,i,n){this.message=e,this.api=i,this.fb=n,this.appId="",this.authId="",this.autoTips=z.Sm,this.driverList=[],this.validateForm=new r.cw({}),this.showDynamicTips=!1,this.baseData=null,this.startValidateDynamic=!1,this.nzDisabled=!1,this.listOfAlgorithm=[...M],this.positionList=[...H],this.listOfVerify=[...E],this.canBeSave=!1,this.labelHeaderTableBody=[...P],this.labelHeaderList=[{key:"",value:""},{key:"",value:""}],this.createAuthForm={position:"header",uuid:"",tokenName:"Authorization",isTransparent:!1,expireTime:0,expireTimeDate:null,driver:"basic",config:{userName:"",password:"",apikey:"",ak:"",sk:"",iss:"",algorithm:"",secret:"",publicKey:"",label:[{key:"",value:""}]}},this.disabledDate=o=>(0,B.Z)(o,new Date)<0,this.validateForm=this.fb.group({driver:["basic",[r.kI.required]],isTransparent:[!1],position:["header"],tokenName:["Authorization"],expireTimeDate:[""],iss:[""],algorithm:["HS256"],secret:[""],publicKey:[""],user:[""],userPath:[""],claimsToVerify:[[]],signatureIsBase64:[!1]})}ngOnInit(){this.getDriversList(),this.authId&&this.getAuthMessage(),this.initTable()}initTable(){this.labelHeaderTableBody[0].disabledFn=()=>this.nzDisabled,this.labelHeaderTableBody[1].disabledFn=()=>this.nzDisabled,this.labelHeaderTableBody[2].btns[0].disabledFn=()=>this.nzDisabled,this.labelHeaderTableBody[2].showFn=e=>e===this.labelHeaderList[0],this.labelHeaderTableBody[3].btns[0].disabledFn=()=>this.nzDisabled,this.labelHeaderTableBody[3].btns[1].disabledFn=()=>this.nzDisabled,this.labelHeaderTableBody[3].showFn=e=>e!==this.labelHeaderList[0]}disabledEdit(e){this.nzDisabled=e}getAuthMessage(){this.api.get("application/auth",{appId:this.appId,uuid:this.authId}).subscribe(e=>{if(0===e.code){this.createAuthForm=e.data.auth,(0,R.m)(this.validateForm,{...e.data.auth,algorithm:"HS256",claimsToVerify:[],...e.data.auth.config});const i=e.data.auth;if(this.createAuthForm.expireTime&&this.validateForm.controls.expireTimeDate.setValue(new Date(1e3*Number(i.expireTime))),i?.config?.label&&Object.keys(i.config.label)){const n=[];for(const o in Object.keys(i.config.label))n.push({key:Object.keys(i.config.label)[o],value:i.config.label[Object.keys(i.config.label)[o]]});n.length<2&&n.push({key:"",value:""}),this.labelHeaderList=[...n],this.createAuthForm.config.label=n}else this.createAuthForm.config.label=[{key:"",value:""}],this.labelHeaderList=[{key:"",value:""},{key:"",value:""}];this.createAuthForm.config.userName=this.createAuthForm.config?.userName?this.createAuthForm.config.userName:"",this.createAuthForm.config.password=this.createAuthForm.config?.password?this.createAuthForm.config.password:"",this.createAuthForm.config.apikey=this.createAuthForm.config?.apikey?this.createAuthForm.config.apikey:"",this.createAuthForm.config.ak=this.createAuthForm.config?.ak?this.createAuthForm.config.ak:"",this.createAuthForm.config.sk=this.createAuthForm.config?.sk?this.createAuthForm.config.sk:"",this.createAuthForm.config.iss=this.createAuthForm.config?.iss?this.createAuthForm.config.iss:"",this.createAuthForm.config.algorithm=this.createAuthForm.config?.algorithm?this.createAuthForm.config.algorithm:"HS256",this.createAuthForm.config.secret=this.createAuthForm.config?.secret?this.createAuthForm.config.secret:"",this.createAuthForm.config.publicKey=this.createAuthForm.config?.publicKey?this.createAuthForm.config.publicKey:""}})}getDriversList(){this.driverList=[],this.api.get("application/drivers").subscribe(e=>{if(0===e.code)for(const i in e.data.drivers)this.driverList=[...this.driverList,{label:this.getAuthDriver(e.data.drivers[i].name),value:e.data.drivers[i].name,render:e.data.drivers[i].render}],this.validateForm.controls.driver.value===e.data.drivers[i].name&&(this.baseData=e.data.drivers[i].render)})}changeBasedata(){this.showDynamicTips=!1;for(const e in this.driverList)this.driverList[e].value===this.validateForm.controls.driver.value&&(this.baseData=this.driverList[e].render);this.getDataFromDynamicComponent(this.createAuthForm)}getDataFromDynamicComponent(e){switch(this.canBeSave=!1,this.validateForm.controls.driver.value){case"basic":if(!e.config.userName||!e.config.password)return void(this.canBeSave=!1);this.canBeSave=!0,this.showDynamicTips=!1;break;case"apikey":if(!e.config.apikey)return void(this.canBeSave=!1);this.canBeSave=!0,this.showDynamicTips=!1;break;case"aksk":if(!e.config.ak||!e.config.sk)return void(this.canBeSave=!1);this.canBeSave=!0,this.showDynamicTips=!1;break;case"jwt":if(!(!e.config.algorithm?.includes("HS")||e.config.iss&&e.config.secret)){this.canBeSave=!1;break}if(!(!e.config.algorithm?.includes("RS")&&!e.config.algorithm?.includes("ES")||e.config.iss&&e.config.publicKey)){this.canBeSave=!1;break}if(!e.config.algorithm||!e.config.algorithm.includes("HS")&&!e.config.algorithm.includes("ES")&&!e.config.algorithm.includes("RS")){this.canBeSave=!1,this.showDynamicTips=!0;break}this.canBeSave=!0}}getAuthDriver(e){switch(e){case"basic":return"Basic";case"apikey":return"ApiKey";case"aksk":return"AkSk";case"jwt":return"Jwt";default:return e}}saveAuth(){if(this.startValidateDynamic=!0,this.showDynamicTips=!this.canBeSave,this.validateForm.valid&&(this.canBeSave||"jwt"===this.validateForm.controls.driver.value)){const e=new Map;let i;if("jwt"!==this.validateForm.controls.driver.value){if(this.createAuthForm.expireTime=this.validateForm.controls.expireTimeDate.value?Math.floor(new Date(this.validateForm.controls.expireTimeDate.value.setHours(23,59,59)).getTime()/1e3):0,this.createAuthForm.config.publicKey=null===this.createAuthForm.config.publicKey?"":this.createAuthForm.config.publicKey,this.createAuthForm.config.secret=null===this.createAuthForm.config.secret?"":this.createAuthForm.config.secret,this.createAuthForm.config?.label&&this.createAuthForm.config?.label?.length>0)for(const o in this.createAuthForm.config.label)null!==this.createAuthForm.config.label[o].key&&""!==this.createAuthForm.config.label[o].key&&null!==this.createAuthForm.config.label[o].value&&""!==this.createAuthForm.config.label[o].value&&e.set(this.createAuthForm.config.label[o].key,this.createAuthForm.config.label[o].value);const n=Object.create(null);for(const[o,c]of e)n[o]=c;this.createAuthForm.config.label=n,i={...this.createAuthForm,driver:this.validateForm.controls.driver.value,isTransparent:this.validateForm.controls.isTransparent.value,expireTime:this.validateForm.controls.expireTimeDate.value?Math.floor(new Date(this.validateForm.controls.expireTimeDate.value.setHours(23,59,59)).getTime()/1e3):0,position:this.validateForm.controls.position.value,tokenName:this.validateForm.controls.tokenName.value}}else{for(const o of this.labelHeaderList)o.key&&o.value&&e.set(o.key,o.value);const n=Object.create(null);for(const[o,c]of e)n[o]=c;i={driver:this.validateForm.controls.driver.value,isTransparent:this.validateForm.controls.isTransparent.value,expireTime:this.validateForm.controls.expireTimeDate.value?Math.floor(new Date(this.validateForm.controls.expireTimeDate.value.setHours(23,59,59)).getTime()/1e3):0,position:this.validateForm.controls.position.value,tokenName:this.validateForm.controls.tokenName.value,config:{iss:this.validateForm.controls.iss.value,algorithm:this.validateForm.controls.algorithm.value,secret:this.validateForm.controls.secret.value,publicKey:this.validateForm.controls.publicKey.value,user:this.validateForm.controls.user.value,userPath:this.validateForm.controls.userPath.value,claimsToVerify:this.validateForm.controls.claimsToVerify.value,signatureIsBase64:this.validateForm.controls.signatureIsBase64.value,label:n}},i.config.algorithm.includes("HS")?delete i.config.publicKey:(delete i.config.secret,delete i.config.signatureIsBase64)}this.authId?this.api.put("application/auth",{...i},{appId:this.appId,uuid:this.createAuthForm.uuid}).subscribe(n=>{0===n.code?(this.message.success(n.msg||"\u4fee\u6539\u9274\u6743\u6210\u529f",{nzDuration:1e3}),this.closeModal&&this.closeModal(!0)):this.closeModal&&this.closeModal()}):this.api.post("application/auth",{...i},{appId:this.appId}).subscribe(n=>{0===n.code?(this.message.success(n.msg||"\u65b0\u589e\u9274\u6743\u6210\u529f",{nzDuration:1e3}),this.closeModal&&this.closeModal(!0)):this.closeModal&&this.closeModal()})}else Object.values(this.validateForm.controls).forEach(e=>{e.invalid&&(e.markAsDirty(),e.updateValueAndValidity({onlySelf:!0}))})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(u.VY),t.Y36(m.s),t.Y36(r.QS))},a.\u0275cmp=t.Xpm({type:a,selectors:[["eo-ng-application-authentication-form"]],inputs:{closeModal:"closeModal"},decls:35,vars:19,consts:[["nz-form","","autocomplete","off",1,"authDrawer",3,"nzNoColon","nzAutoTips","formGroup"],[1,"form-row"],[1,"label"],["eoNgFeedbackTooltip","","nzTooltipTitle","\u8f6c\u53d1\u65f6\u9ed8\u8ba4\u5c06\u9274\u6743\u4fe1\u606f\u900f\u4f20\u5230\u4e0a\u6e38","nzTooltipPlacement","top","nzTooltipTrigger","hover",3,"nzTooltipVisible"],[1,"required-symbol"],[1,""],["name","transparent","formControlName","isTransparent","nzCheckedChildren","\u5f00","nzUnCheckedChildren","\u5173",3,"nzDisabled"],["name","driver","required","","formControlName","driver",1,"w-INPUT_NORMAL",3,"nzOptions","nzDisabled","ngModelChange"],[1,"form-input"],[3,"nzCompact"],["name","position","required","","formControlName","position","eoNgUserAccess","application",1,"form-input",3,"nzOptions","nzDisabled","disabledEdit"],["type","text","eo-ng-input","","name","tokenName","formControlName","tokenName","placeholder","\u8bf7\u8f93\u5165TokenName","required","","eoNgUserAccess","application",1,"w206"],["class","form-row mb-0",4,"ngIf","ngIfElse"],["jwtTemplateRef",""],[1,"form-row",3,"ngClass"],["for","driver",1,"label"],["nzErrorTip","\u8fc7\u671f\u65f6\u95f4\u4e0d\u5f97\u65e9\u4e8e\u5f53\u524d\u65f6\u95f4",1,"form-input"],["name","expireTime","formControlName","expireTimeDate",1,"w-INPUT_NORMAL",3,"nzDisabledDate","nzAllowClear","nzDisabled"],[4,"ngIf"],[1,"form-row","mb-0"],["ngDefaultControl","","name","dynamic","id","dynamic",3,"apiData","baseData","nzDisabled","startValidate","apiDataChange"],["for","iss",1,"label"],["type","text","eo-ng-input","","name","iss","formControlName","iss","placeholder","\u8bf7\u8f93\u5165Iss","required","","eoNgUserAccess","application",1,"w-INPUT_NORMAL"],["for","algorithm",1,"label"],["name","algorithm","required","","formControlName","algorithm","eoNgUserAccess","application",1,"w-INPUT_NORMAL",3,"nzOptions","nzDisabled","disabledEdit"],["class","form-row",4,"ngIf"],["for","user",1,"label"],["type","text","eo-ng-input","","name","iss","formControlName","user","placeholder","\u8bf7\u8f93\u5165\u7528\u6237\u540d","eoNgUserAccess","application",1,"w-INPUT_NORMAL"],["for","userPath",1,"label"],["type","text","eo-ng-input","","name","userPath","formControlName","userPath","placeholder","\u8bf7\u8f93\u5165\u7528\u6237\u540dJsonPath","eoNgUserAccess","application",1,"w-INPUT_NORMAL"],["for","claimsToVerify",1,"label"],[3,"nzSpan"],["name","claimsToVerify","formControlName","claimsToVerify","eoNgUserAccess","application","nzPlaceHolder","\u8bf7\u9009\u62e9\u6821\u9a8c\u5b57\u6bb5","nzMode","multiple",1,"w-INPUT_NORMAL",3,"nzOptions","nzDisabled","nzAllowClear","disabledEdit"],["for","secret",1,"label"],["type","text","eo-ng-input","","name","secret","formControlName","secret","placeholder","\u8bf7\u8f93\u5165Secret","required","","eoNgUserAccess","application",1,"w-INPUT_NORMAL"],["for","publicKey",1,"label"],["type","text","eo-ng-input","","name","iss","formControlName","publicKey","placeholder","\u8bf7\u8f93\u5165RSA\u516c\u94a5","required","","eoNgUserAccess","application",1,"w-INPUT_NORMAL"],["for","signatureIsBase64",1,"label"],["name","signatureIsBase64","formControlName","signatureIsBase64",3,"nzDisabled"],[1,"form-row","w-[200px]","mb-0"],["eoNgUserAccess","application",1,"arrayItem","label",3,"nzTbody","nzData","nzNoScroll"]],template:function(e,i){if(1&e&&(t.TgZ(0,"form",0)(1,"nz-form-item",1)(2,"label",2)(3,"span",3)(4,"span",4),t._uU(5,"*"),t.qZA(),t._uU(6,"\u9690\u85cf\u9274\u6743\u4fe1\u606f\uff1a "),t.qZA()(),t.TgZ(7,"nz-form-control",5),t._UZ(8,"eo-ng-switch",6),t.qZA()(),t.TgZ(9,"nz-form-item",1)(10,"label",2)(11,"span",4),t._uU(12,"*"),t.qZA(),t._uU(13,"\u9274\u6743\u7c7b\u578b\uff1a"),t.qZA(),t.TgZ(14,"nz-form-control")(15,"eo-ng-select",7),t.NdJ("ngModelChange",function(){return i.changeBasedata()}),t.qZA()()(),t.TgZ(16,"nz-form-item",1)(17,"label",2)(18,"span",4),t._uU(19,"*"),t.qZA(),t._uU(20,"\u53c2\u6570\u4f4d\u7f6e\uff1a"),t.qZA(),t.TgZ(21,"nz-form-control",8)(22,"eo-ng-input-group",9)(23,"eo-ng-select",10),t.NdJ("disabledEdit",function(o){return i.disabledEdit(o)}),t.qZA(),t.TgZ(24,"nz-form-control"),t._UZ(25,"input",11),t.qZA()()()(),t.YNc(26,K,3,4,"nz-form-item",12),t.YNc(27,X,32,9,"ng-template",null,13,t.W1O),t.TgZ(29,"nz-form-item",14)(30,"label",15),t._uU(31,"\u8fc7\u671f\u65f6\u95f4\uff1a"),t.qZA(),t.TgZ(32,"nz-form-control",16),t._UZ(33,"nz-date-picker",17),t.qZA()(),t.YNc(34,$,6,3,"div",18),t.qZA()),2&e){const n=t.MAs(28);t.Q6J("nzNoColon",!0)("nzAutoTips",i.autoTips)("formGroup",i.validateForm),t.xp6(3),t.Q6J("nzTooltipVisible",!1),t.xp6(5),t.Q6J("nzDisabled",i.nzDisabled),t.xp6(7),t.Q6J("nzOptions",i.driverList)("nzDisabled",i.nzDisabled),t.xp6(7),t.Q6J("nzCompact",!0),t.xp6(1),t.Q6J("nzOptions",i.positionList)("nzDisabled",i.nzDisabled),t.xp6(3),t.Q6J("ngIf","jwt"!==i.validateForm.controls.driver.value)("ngIfElse",n),t.xp6(3),t.Q6J("ngClass",t.VKq(17,tt,"jwt"!==i.validateForm.controls.driver.value)),t.xp6(4),t.Q6J("nzDisabledDate",i.disabledDate)("nzAllowClear",!0)("nzDisabled",i.nzDisabled),t.xp6(1),t.Q6J("ngIf","jwt"===i.validateForm.controls.driver.value)}},dependencies:[F.mk,F.O5,N.Hf,r._Y,r.Fj,r.JJ,r.JL,r.Q7,q._,u.Cl,b.oO,b.aI,V.uw,k.q,g.t3,g.SK,d.Lr,d.Nx,d.Fd,r.sg,r.u,f.g,A.a],encapsulation:2}),a})();var y=s(8513),v=s(2266),C=s(4162);const it=["authContentTpl"];let at=(()=>{class a{constructor(e,i,n,o,c,h){this.message=e,this.api=i,this.baseInfo=n,this.modalService=o,this.router=c,this.navigationService=h,this.appId="",this.nzDisabled=!1,this.authenticationTableHeadName=[...J],this.authenticationTableBody=[...w],this.authenticationList=[],this.authTableClick=T=>{this.openDrawer(T.data.uuid)},this.closeModal=T=>{T&&this.getAuthsData(),this.modalRef?.close()},this.navigationService.reqFlashBreadcrumb([{title:"\u5e94\u7528\u7ba1\u7406",routerLink:"application"},{title:"\u9274\u6743\u7ba1\u7406"}])}ngOnInit(){this.appId=this.baseInfo.allParamsInfo.appId,this.initTable(),this.appId||this.router.navigate(["/","application"]),this.getAuthsData()}initTable(){this.authenticationTableBody[4].styleFn=e=>e.expireTime&&(0,B.Z)(1e3*e.expireTime,new Date)<0?"color:red":"",this.authenticationTableBody[8].btns[0].click=e=>{this.openDrawer(e.data.uuid)},this.authenticationTableBody[8].btns[1].disabledFn=()=>this.nzDisabled,this.authenticationTableBody[8].btns[1].click=e=>{this.delete(e.data)}}disabledEdit(e){this.nzDisabled=e}openDrawer(e){this.modalRef=this.modalService.create({nzTitle:"\u914d\u7f6e\u9274\u6743\u4fe1\u606f",nzWidth:D.G_,nzContent:et,nzComponentParams:{authId:e,appId:this.appId,closeModal:this.closeModal,nzDisabled:this.nzDisabled},nzOkDisabled:this.nzDisabled,nzOnOk:i=>(i.saveAuth(),!1)})}delete(e,i){i?.stopPropagation(),this.modalService.create({nzTitle:"\u5220\u9664",nzContent:"\u8be5\u6570\u636e\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u627e\u56de\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\uff1f",nzClosable:!0,nzClassName:"delete-modal",nzWidth:D.G_,nzOkDanger:!0,nzOnOk:()=>{this.api.delete("application/auth",{uuid:e.uuid}).subscribe(n=>{0===n.code&&(this.message.success(n.msg||"\u5220\u9664\u6210\u529f!",{nzDuration:1e3}),this.getAuthsData())})}})}getAuthsData(){this.api.get("application/auths",{appId:this.appId}).subscribe(e=>{if(0===e.code){for(const i in e.data.auths)e.data.auths[i].driver=this.getAuthDriver(e.data.auths[i].driver),e.data.auths[i].isTransparent=e.data.auths[i].isTransparent?"\u662f":"\u5426",e.data.auths[i].expireTimeString=0===e.data.auths[i].expireTime?"\u6c38\u4e0d\u8fc7\u671f":this.getDateInList(e.data.auths[i].expireTime);this.authenticationList=e.data.auths}})}getAuthDriver(e){switch(e){case"basic":return"Basic";case"apikey":return"ApiKey";case"aksk":return"AkSk";case"jwt":return"Jwt";default:return e}}getDateInList(e){try{if(Number(e)||0===Number(e)){const i=new Date(1e3*Number(e)),n=i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1,o=i.getDate()<10?"0"+i.getDate():i.getDate(),c=i.getHours()<10?"0"+i.getHours():i.getHours(),h=i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes(),T=i.getSeconds()<10?"0"+i.getSeconds():i.getSeconds();return`${i.getFullYear()}-${n}-${o} ${c}:${h}:${T}`}return"\u65e5\u671f\u6570\u636e\u683c\u5f0f\u6709\u8bef"}catch{return"\u65e5\u671f\u6570\u636e\u683c\u5f0f\u6709\u8bef"}}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(u.VY),t.Y36(m.s),t.Y36(y.D),t.Y36(u._B),t.Y36(p.F0),t.Y36(v.a))},a.\u0275cmp=t.Xpm({type:a,selectors:[["eo-ng-application-authentication"]],viewQuery:function(e,i){if(1&e&&t.Gf(it,7,t.Rgc),2&e){let n;t.iGM(n=t.CRH())&&(i.authContentTpl=n.first)}},decls:6,vars:6,consts:[[1,""],[1,"list-header","pl-btnbase","pr-btnrbase","py-btnybase","flex","flex-nowrap","items-center","justify-between"],["eo-ng-button","","eoNgUserAccess","application",1,"ant-btn-primary",3,"disabledEdit","click"],[1,"list-content"],[1,"",3,"nzTbody","nzThead","nzData","nzTrClick","nzMaxOperatorButton","nzNoScroll"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("disabledEdit",function(o){return i.disabledEdit(o)})("click",function(){return i.openDrawer()}),t._uU(3," \u914d\u7f6e\u9274\u6743 "),t.qZA()(),t.TgZ(4,"div",3),t._UZ(5,"eo-ng-apinto-table",4),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("nzTbody",i.authenticationTableBody)("nzThead",i.authenticationTableHeadName)("nzData",i.authenticationList)("nzTrClick",i.authTableClick)("nzMaxOperatorButton",2)("nzNoScroll",!0))},dependencies:[C.qK,f.g,A.a],styles:[".authDrawer[_ngcontent-%COMP%]   .label-large[_ngcontent-%COMP%]{width:126px;height:32px;line-height:32px;padding:0;text-align:right}.small-row[_ngcontent-%COMP%]{width:210px;margin-right:20px}.dynamic-control[_ngcontent-%COMP%]{margin-bottom:0!important}"]}),a})();var S=s(6084);const nt=["tab1Tpl"],ot=["tab2Tpl"],st=["tab3Tpl"];function lt(a,l){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u4e0a\u7ebf\u7ba1\u7406"),t.qZA())}function rt(a,l){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u5e94\u7528\u4fe1\u606f"),t.qZA())}function ct(a,l){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u9274\u6743\u7ba1\u7406"),t.qZA())}function ut(a,l){1&a&&(t.TgZ(0,"div",8),t._uU(1," \u9274\u6743\u7ba1\u7406 "),t.qZA())}function pt(a,l){if(1&a&&(t.YNc(0,ct,2,0,"span",6),t.YNc(1,ut,2,0,"div",7)),2&a){const e=t.oxw();t.Q6J("ngIf","anonymous"!==e.appId),t.xp6(1),t.Q6J("ngIf","anonymous"===e.appId)}}let dt=(()=>{class a{constructor(e,i,n,o,c){this.baseInfo=e,this.router=i,this.cdRef=n,this.elem=o,this.renderer=c,this.tab1Tpl="\u4e0a\u7ebf\u7ba1\u7406",this.tab2Tpl="\u5e94\u7528\u4fe1\u606f",this.tab3Tpl="\u9274\u6743\u7ba1\u7406",this.appId="",this.options=[],this.tabOptions=[]}ngOnInit(){this.appId=this.baseInfo.allParamsInfo.appId,this.appId||this.router.navigate(["/","application"])}ngAfterViewInit(){this.tabOptions=[{title:this.tab1Tpl,routerLink:".",queryParamsHandling:"merge"},{title:this.tab2Tpl,routerLink:"message",queryParamsHandling:"merge"},{title:this.tab3Tpl,routerLink:"authentication",queryParamsHandling:"merge"}],"anonymous"===this.appId&&this.tabOptions.pop(),this.cdRef.detectChanges()}ngAfterViewChecked(){const e=this.elem.nativeElement.querySelector("[nz-tabs-ink-bar]");this.renderer.removeAttribute(e,"hidden")}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.D),t.Y36(p.F0),t.Y36(t.sBO),t.Y36(t.SBq),t.Y36(t.Qsj))},a.\u0275cmp=t.Xpm({type:a,selectors:[["eo-ng-application-content"]],viewQuery:function(e,i){if(1&e&&(t.Gf(nt,7,t.Rgc),t.Gf(ot,7,t.Rgc),t.Gf(st,7,t.Rgc)),2&e){let n;t.iGM(n=t.CRH())&&(i.tab1Tpl=n.first),t.iGM(n=t.CRH())&&(i.tab2Tpl=n.first),t.iGM(n=t.CRH())&&(i.tab3Tpl=n.first)}},decls:10,vars:2,consts:[[1,"content-tabs-fixed"],[3,"nzLinkRouter","nzOptions"],["tab1Tpl",""],["tab2Tpl",""],["tab3Tpl",""],[1,"inside-content-fixed-top-51"],[4,"ngIf"],["eoNgFeedbackTooltip","","eoNgFeedbackTooltip","","nzTooltipPlacement","bottom","nzTooltipTrigger","hover","nzTooltipTitle","\u533f\u540d\u5e94\u7528\u4e0d\u5f00\u653e\u9274\u6743\u7ba1\u7406",4,"ngIf"],["eoNgFeedbackTooltip","","eoNgFeedbackTooltip","","nzTooltipPlacement","bottom","nzTooltipTrigger","hover","nzTooltipTitle","\u533f\u540d\u5e94\u7528\u4e0d\u5f00\u653e\u9274\u6743\u7ba1\u7406"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"eo-ng-tabs",1),t.YNc(2,lt,2,0,"ng-template",null,2,t.W1O),t.YNc(4,rt,2,0,"ng-template",null,3,t.W1O),t.YNc(6,pt,2,2,"ng-template",null,4,t.W1O),t.qZA(),t.TgZ(8,"div",5),t._UZ(9,"router-outlet"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("nzLinkRouter",!0)("nzOptions",i.tabOptions))},dependencies:[F.O5,u.Cl,S.n4,p.lC],encapsulation:2}),a})(),Z=(()=>{class a{constructor(e,i,n,o,c){this.message=e,this.api=i,this.router=n,this.fb=o,this.navigationService=c,this.editPage=!1,this.appId="",this.validateForm=new r.cw({}),this.autoTips=z.Sm,this.customAttrTableBody=[...Q],this.extraHeaderTableBody=[...Y],this.submitButtonLoading=!1,this.createApplicationForm={customAttrList:[],extraParamList:[]},this.customAttrList=[{key:"",value:"",disabled:!1}],this.extraHeaderList=[{key:"",value:"",disabled:!1}],this.nzDisabled=!1,this.navigationService.reqFlashBreadcrumb([{title:"\u5e94\u7528\u7ba1\u7406",routerLink:"application"},{title:"\u65b0\u5efa\u5e94\u7528"}]),this.validateForm=this.fb.group({name:["",[r.kI.required]],id:[""],desc:[""]})}ngOnInit(){this.initTable(),this.editPage?(this.getApplicationMessage(),this.navigationService.reqFlashBreadcrumb([{title:"\u5e94\u7528\u7ba1\u7406",routerLink:"application"},{title:"\u5e94\u7528\u4fe1\u606f"}])):this.getApplicationId()}initTable(){this.customAttrTableBody[0].disabledFn=()=>this.nzDisabled,this.customAttrTableBody[1].disabledFn=()=>this.nzDisabled,this.customAttrTableBody[2].showFn=e=>e===this.customAttrList[0],this.customAttrTableBody[2].btns[0].click=e=>{this.editArray(e.data,"addCustom")},this.customAttrTableBody[2].btns[0].disabledFn=()=>this.nzDisabled,this.customAttrTableBody[3].showFn=e=>e!==this.customAttrList[0],this.customAttrTableBody[3].btns[0].click=e=>{this.editArray(e.data,"addCustom")},this.customAttrTableBody[3].btns[0].disabledFn=()=>this.nzDisabled,this.customAttrTableBody[3].btns[1].click=e=>{this.editArray(e.data,"deleteCustom")},this.customAttrTableBody[3].btns[1].disabledFn=()=>this.nzDisabled,this.extraHeaderTableBody[0].disabledFn=()=>this.nzDisabled,this.extraHeaderTableBody[1].disabledFn=()=>this.nzDisabled,this.extraHeaderTableBody[2].showFn=e=>e===this.extraHeaderList[0],this.extraHeaderTableBody[2].btns[0].click=e=>{this.editArray(e.data,"addHeader")},this.extraHeaderTableBody[2].btns[0].disabledFn=()=>this.nzDisabled,this.extraHeaderTableBody[3].showFn=e=>e!==this.extraHeaderList[0],this.extraHeaderTableBody[3].btns[0].click=e=>{this.editArray(e.data,"addHeader")},this.extraHeaderTableBody[3].btns[0].disabledFn=()=>this.nzDisabled,this.extraHeaderTableBody[3].btns[1].click=e=>{this.editArray(e.data,"deleteHeader")},this.extraHeaderTableBody[3].btns[1].disabledFn=()=>this.nzDisabled}getApplicationMessage(){this.api.get("application",{appId:this.appId}).subscribe(e=>{0===e.code&&(this.createApplicationForm=e.data.application,this.validateForm.controls.name.setValue(e.data.application.name),this.validateForm.controls.id.setValue(e.data.application.id),this.validateForm.controls.desc.setValue(e.data.application.desc),"\u533f\u540d\u5e94\u7528"===e.data.application.name&&this.validateForm.controls.name.disable(),this.validateForm.controls.id.disable(),this.customAttrList=this.createApplicationForm?.customAttrList?.length>0?this.createApplicationForm.customAttrList:[{key:"",value:"",disabled:!1}],this.extraHeaderList=this.createApplicationForm?.extraParamList?.length>0?this.createApplicationForm.extraParamList:[{key:"",value:"",disabled:!1}])})}getApplicationId(){this.api.get("random/application/id").subscribe(e=>{0===e.code&&this.validateForm.controls.id.setValue(e.data.id)})}disabledEdit(e){this.nzDisabled=e}editArray(e,i){switch(i){case"addCustom":for(const n in this.customAttrList)if(this.customAttrList[n]===e){this.customAttrList.splice(Number(n)+1,0,{key:"",value:"",disabled:!1});break}this.customAttrList=[...this.customAttrList];break;case"deleteCustom":for(const n in this.customAttrList)if(this.customAttrList[n]===e){this.customAttrList.splice(Number(n),1);break}this.customAttrList=[...this.customAttrList];break;case"addHeader":for(const n in this.extraHeaderList)if(this.extraHeaderList[n]===e){this.extraHeaderList.splice(Number(n)+1,0,{key:"",value:"",disabled:!1});break}this.extraHeaderList=[...this.extraHeaderList];break;case"deleteHeader":for(const n in this.extraHeaderList)if(this.extraHeaderList[n]===e){this.extraHeaderList.splice(Number(n),1);break}this.extraHeaderList=[...this.extraHeaderList]}}saveApplication(){this.validateForm.valid?(this.createApplicationForm.customAttrList=this.customAttrList.filter(e=>e.key&&e.value),this.createApplicationForm.extraParamList=this.extraHeaderList.filter(e=>e.key&&e.value),this.submitButtonLoading=!0,this.editPage?this.api.put("application",{...this.createApplicationForm,...this.validateForm.value}).subscribe(e=>{this.submitButtonLoading=!1,0===e.code&&(this.message.success(e.msg||"\u4fee\u6539\u6210\u529f",{nzDuration:1e3}),this.backToList())}):this.api.post("application",{...this.createApplicationForm,...this.validateForm.value}).subscribe(e=>{this.submitButtonLoading=!1,0===e.code&&(this.message.success(e.msg||"\u6dfb\u52a0\u6210\u529f",{nzDuration:1e3}),this.backToList())})):Object.values(this.validateForm.controls).forEach(e=>{e.invalid&&(e.markAsDirty(),e.updateValueAndValidity({onlySelf:!0}))})}backToList(){this.router.navigate(["/","application"])}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(u.VY),t.Y36(m.s),t.Y36(p.F0),t.Y36(r.QS),t.Y36(v.a))},a.\u0275cmp=t.Xpm({type:a,selectors:[["eo-ng-application-create"]],inputs:{editPage:"editPage",appId:"appId"},decls:34,vars:24,consts:[[1,"mt-formtop"],["nz-form","","autocomplete","off",3,"nzNoColon","nzAutoTips","formGroup"],["nzRequired","",3,"nzSpan"],[3,"nzSpan"],["eo-ng-input","","required","","name","name","placeholder","\u8bf7\u8f93\u5165","formControlName","name","eoNgUserAccess","application",1,"w-INPUT_NORMAL",3,"disabledEdit"],["eo-ng-input","","required","","placeholder","\u8bf7\u8f93\u5165","formControlName","id","eoNgUserAccess","application",1,"w-INPUT_NORMAL"],["eoNgFeedbackTooltip","","nzTooltipTitle","\u7528\u4e8e\u5e94\u7528\u8c03\u7528\u7edf\u8ba1\u6307\u6807\u6216\u7b56\u7565\u5339\u914d","nzTooltipPlacement","left","nzTooltipTrigger","hover",3,"nzTooltipVisible"],[1,"arrayItem","custom",3,"nzTbody","nzData","nzNoScroll"],["name","desc","rows","3","eo-ng-input","","formControlName","desc","placeholder","\u8bf7\u8f93\u5165","eoNgUserAccess","application",1,"w-INPUT_NORMAL"],[1,"mb-0"],["nzExtra","\u7528\u4e8e\u8f6c\u53d1\u4e0a\u6e38\u7cfb\u7edf\u9274\u6743",3,"nzSpan"],["eoNgUserAccess","application",1,"arrayItem","header",3,"nzTbody","nzData","nzNoScroll"],[1,"mb-0","sticky","bg-white","bottom-0","py-mbase","z-50"],[3,"nzOffset","nzSpan"],["type","submit","eo-ng-button","","eoNgUserAccess","application",1,"ant-btn-primary",3,"nzLoading","click"],["eo-ng-button","",1,"ml-btnybase",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"form",1)(2,"nz-form-item")(3,"nz-form-label",2),t._uU(4,"\u5e94\u7528\u540d\u79f0\uff1a"),t.qZA(),t.TgZ(5,"nz-form-control",3)(6,"input",4),t.NdJ("disabledEdit",function(o){return i.disabledEdit(o)}),t.qZA()()(),t.TgZ(7,"nz-form-item")(8,"nz-form-label",2),t._uU(9,"\u5e94\u7528ID\uff1a"),t.qZA(),t.TgZ(10,"nz-form-control",3),t._UZ(11,"input",5),t.qZA()(),t.TgZ(12,"nz-form-item")(13,"nz-form-label",3)(14,"span",6),t._uU(15,"\u81ea\u5b9a\u4e49\u5c5e\u6027\uff1a "),t.qZA()(),t.TgZ(16,"nz-form-control",3),t._UZ(17,"eo-ng-apinto-table",7),t.qZA()(),t.TgZ(18,"nz-form-item")(19,"nz-form-label",3),t._uU(20,"\u63cf\u8ff0\uff1a"),t.qZA(),t.TgZ(21,"nz-form-control",3),t._UZ(22,"textarea",8),t.qZA()(),t.TgZ(23,"nz-form-item",9)(24,"nz-form-label",3),t._uU(25,"Header\u989d\u5916\u53c2\u6570\uff1a"),t.qZA(),t.TgZ(26,"nz-form-control",10),t._UZ(27,"eo-ng-apinto-table",11),t.qZA()(),t.TgZ(28,"nz-form-item",12)(29,"nz-form-control",13)(30,"button",14),t.NdJ("click",function(){return i.saveApplication()}),t._uU(31),t.qZA(),t.TgZ(32,"button",15),t.NdJ("click",function(){return i.backToList()}),t._uU(33," \u53d6\u6d88 "),t.qZA()()()()()),2&e&&(t.xp6(1),t.Q6J("nzNoColon",!0)("nzAutoTips",i.autoTips)("formGroup",i.validateForm),t.xp6(2),t.Q6J("nzSpan",7),t.xp6(2),t.Q6J("nzSpan",12),t.xp6(3),t.Q6J("nzSpan",7),t.xp6(2),t.Q6J("nzSpan",12),t.xp6(3),t.Q6J("nzSpan",7),t.xp6(1),t.Q6J("nzTooltipVisible",!1),t.xp6(2),t.Q6J("nzSpan",5),t.xp6(1),t.Q6J("nzTbody",i.customAttrTableBody)("nzData",i.customAttrList)("nzNoScroll",!0),t.xp6(2),t.Q6J("nzSpan",7),t.xp6(2),t.Q6J("nzSpan",12),t.xp6(3),t.Q6J("nzSpan",7),t.xp6(2),t.Q6J("nzSpan",5),t.xp6(1),t.Q6J("nzTbody",i.extraHeaderTableBody)("nzData",i.extraHeaderList)("nzNoScroll",!0),t.xp6(2),t.Q6J("nzOffset",7)("nzSpan",12),t.xp6(1),t.Q6J("nzLoading",i.submitButtonLoading),t.xp6(1),t.hij(" ",i.editPage?"\u63d0\u4ea4":"\u4fdd\u5b58"," "))},dependencies:[r._Y,r.Fj,r.JJ,r.JL,r.Q7,u.Cl,b.oO,C.qK,g.t3,g.SK,d.Lr,d.Nx,d.iK,d.Fd,r.sg,r.u,f.g,A.a],styles:["td[_ngcontent-%COMP%]   input.ant-input[_ngcontent-%COMP%]{width:140px!important}"]}),a})();var ht=s(7706);let I=(()=>{class a{constructor(e,i,n,o,c){this.message=e,this.modalService=i,this.api=n,this.router=o,this.navigationService=c,this.applicationName="",this.applicationNameForSear="",this.nzDisabled=!1,this.applicationsForm={applications:[],total:0,pageNum:1,pageSize:20},this.applicationsTableHeadName=[...O],this.applicationsTableBody=[...U],this.applicationsTableClick=h=>{this.router.navigate(["/","application","content",h.data.id])},this.navigationService.reqFlashBreadcrumb([{title:"\u5e94\u7528\u7ba1\u7406",routerLink:"application"}])}ngOnInit(){this.applicationsTableBody[5].btns[0].click=e=>{this.router.navigate(["/","application","content",e.data.id])},this.applicationsTableBody[5].btns[1].disabledFn=(e,i)=>!i.data.isDelete||this.nzDisabled,this.applicationsTableBody[5].btns[1].click=e=>{this.delete(e.data)},this.getApplicationsList()}disabledEdit(e){this.nzDisabled=e}getApplicationsList(){this.api.get("applications",{name:this.applicationNameForSear,pageNum:this.applicationsForm.pageNum,pageSize:this.applicationsForm.pageSize}).subscribe(e=>{0===e.code&&(this.applicationsForm.applications=e.data.applications,this.applicationsForm.total=e.data.total,this.applicationName=this.applicationNameForSear)})}addApplication(){this.router.navigate(["/","application","create"])}delete(e,i){i?.stopPropagation(),this.modalService.create({nzTitle:"\u5220\u9664",nzContent:"\u8be5\u6570\u636e\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u627e\u56de\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\uff1f",nzClosable:!0,nzWidth:D.G_,nzClassName:"delete-modal",nzOkDanger:!0,nzOnOk:()=>{this.deleteDiscovery(e.id)}})}deleteDiscovery(e){this.api.delete("application",{appId:e}).subscribe(i=>{0===i.code&&(this.getApplicationsList(),this.message.success(i.msg||"\u5220\u9664\u6210\u529f",{nzDuration:1e3}))})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(u.VY),t.Y36(u._B),t.Y36(m.s),t.Y36(p.F0),t.Y36(v.a))},a.\u0275cmp=t.Xpm({type:a,selectors:[["eo-ng-application-management-list"]],decls:8,vars:13,consts:[[1,"w-[100%]","overflow-x-hidden"],[1,"list-header","pl-btnbase","pr-btnrbase","py-btnybase","flex","flex-nowrap","items-center","justify-between"],["eo-ng-button","","eoNgUserAccess","application",1,"ant-btn-primary",3,"disabledEdit","click"],[3,"eoInputVal","eoClick"],["type","text","eo-ng-input","","placeholder","\u641c\u7d22\u5e94\u7528\u540d\u79f0",3,"ngModel","ngModelChange","keyup.enter"],[1,"list-content","pb-[4px]"],[1,"",3,"nzTbody","nzThead","nzData","nzTrClick","nzMaxOperatorButton","nzNoScroll","nzShowPagination","nzFrontPagination","nzTotal","nzPageIndex","nzPageSize","nzPageIndexChange","nzPageSizeChange"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("disabledEdit",function(o){return i.disabledEdit(o)})("click",function(){return i.addApplication()}),t._uU(3," \u65b0\u5efa\u5e94\u7528 "),t.qZA(),t.TgZ(4,"eo-ng-search-input-group",3),t.NdJ("eoClick",function(){return i.applicationNameForSear="",i.getApplicationsList()}),t.TgZ(5,"input",4),t.NdJ("ngModelChange",function(o){return i.applicationNameForSear=o})("keyup.enter",function(){return i.getApplicationsList()}),t.qZA()()(),t.TgZ(6,"div",5)(7,"eo-ng-apinto-table",6),t.NdJ("nzPageIndexChange",function(o){return i.applicationsForm.pageNum=o})("nzPageSizeChange",function(o){return i.applicationsForm.pageSize=o})("nzPageIndexChange",function(){return i.getApplicationsList()})("nzPageSizeChange",function(){return i.getApplicationsList()}),t.qZA()()()),2&e&&(t.xp6(4),t.Q6J("eoInputVal",i.applicationNameForSear),t.xp6(1),t.Q6J("ngModel",i.applicationNameForSear),t.xp6(2),t.Q6J("nzTbody",i.applicationsTableBody)("nzThead",i.applicationsTableHeadName)("nzData",i.applicationsForm.applications)("nzTrClick",i.applicationsTableClick)("nzMaxOperatorButton",2)("nzNoScroll",!0)("nzShowPagination",!0)("nzFrontPagination",!1)("nzTotal",i.applicationsForm.total)("nzPageIndex",i.applicationsForm.pageNum)("nzPageSize",i.applicationsForm.pageSize))},dependencies:[r.Fj,r.JJ,r.On,ht.h,b.oO,C.qK,f.g,A.a],encapsulation:2}),a})(),mt=(()=>{class a{constructor(e,i,n){this.api=e,this.baseInfo=i,this.router=n,this.appId=""}ngOnInit(){this.appId=this.baseInfo.allParamsInfo.appId,this.appId||this.router.navigate(["/","application"])}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(m.s),t.Y36(y.D),t.Y36(p.F0))},a.\u0275cmp=t.Xpm({type:a,selectors:[["eo-ng-application-message"]],decls:1,vars:2,consts:[[3,"editPage","appId"]],template:function(e,i){1&e&&t._UZ(0,"eo-ng-application-create",0),2&e&&t.Q6J("editPage",!0)("appId",i.appId)},dependencies:[Z],encapsulation:2}),a})();var bt=s(3845),L=s(5710);const gt=["clusterStatusTpl"],ft=["disabledStatusTpl"];function At(a,l){1&a&&t._UZ(0,"eo-ng-table-status",5),2&a&&t.Q6J("status",l.item.status)}function Tt(a,l){1&a&&t._UZ(0,"eo-ng-table-disabled",6),2&a&&t.Q6J("disable",l.item.disable)}const Ft=[{path:"",component:x,data:{id:"3"},children:[{path:"",component:I},{path:"create",component:Z},{path:"content/:appId",component:dt,children:[{path:"",component:(()=>{class a{constructor(e,i,n,o,c,h){this.message=e,this.api=i,this.baseInfo=n,this.router=o,this.navigationService=c,this.publishFailModal=h,this.appId="",this.clustersList=[],this.clustersTableHeadName=[...z.Ye],this.clustersTableBody=[...z.Ki],this.type="",this.solutionRouter="",this.solutionParam={},this.nzDisabled=!1,this.navigationService.reqFlashBreadcrumb([{title:"\u5e94\u7528\u7ba1\u7406",routerLink:"application"},{title:"\u4e0a\u7ebf\u7ba1\u7406"}])}ngOnInit(){this.appId=this.baseInfo.allParamsInfo.appId,this.initTable(),this.appId||this.router.navigate(["/","application"]),this.getClustersData()}initTable(){this.clustersTableBody[6].btns[0].disabledFn=()=>this.nzDisabled,this.clustersTableBody[6].btns[0].click=e=>{this.updateOrOnline(e.data,"\u66f4\u65b0")},this.clustersTableBody[6].btns[1].disabledFn=()=>this.nzDisabled,this.clustersTableBody[6].btns[1].click=e=>{this.offline(e.data)},this.clustersTableBody[6].btns[2].disabledFn=()=>this.nzDisabled,this.clustersTableBody[6].btns[2].click=e=>{this.disable(e.data)},this.clustersTableBody[7].btns[0].disabledFn=()=>this.nzDisabled,this.clustersTableBody[7].btns[0].click=e=>{this.updateOrOnline(e.data,"\u66f4\u65b0")},this.clustersTableBody[7].btns[1].disabledFn=()=>this.nzDisabled,this.clustersTableBody[7].btns[1].click=e=>{this.offline(e.data)},this.clustersTableBody[7].btns[2].disabledFn=()=>this.nzDisabled,this.clustersTableBody[7].btns[2].click=e=>{this.enable(e.data)},this.clustersTableBody[8].btns[0].disabledFn=()=>this.nzDisabled,this.clustersTableBody[8].btns[0].click=e=>{this.offline(e.data)},this.clustersTableBody[8].btns[1].disabledFn=()=>this.nzDisabled,this.clustersTableBody[8].btns[1].click=e=>{this.disable(e.data)},this.clustersTableBody[9].btns[0].disabledFn=()=>this.nzDisabled,this.clustersTableBody[9].btns[0].click=e=>{this.offline(e.data)},this.clustersTableBody[9].btns[1].disabledFn=()=>this.nzDisabled,this.clustersTableBody[9].btns[1].click=e=>{this.enable(e.data)},this.clustersTableBody[10].btns[0].disabledFn=()=>this.nzDisabled,this.clustersTableBody[10].btns[0].click=e=>{this.updateOrOnline(e.data,"\u4e0a\u7ebf")},this.clustersTableBody[10].btns[1].disabledFn=()=>this.nzDisabled,this.clustersTableBody[10].btns[1].click=e=>{this.disable(e.data)},this.clustersTableBody[11].btns[0].disabledFn=()=>this.nzDisabled,this.clustersTableBody[11].btns[0].click=e=>{this.updateOrOnline(e.data,"\u4e0a\u7ebf")},this.clustersTableBody[11].btns[1].disabledFn=()=>this.nzDisabled,this.clustersTableBody[11].btns[1].click=e=>{this.enable(e.data)}}ngAfterViewInit(){this.clustersTableBody[2].title=this.clusterStatusTpl,this.clustersTableBody[3].title=this.disabledStatusTpl}getClustersData(){this.api.get("application/onlines",{appId:this.appId}).subscribe(e=>{0===e.code&&(this.clustersList=e.data.clusters)})}disabledEdit(e){this.nzDisabled=e}updateOrOnline(e,i){this.api.put("application/online",{clusterName:e.name||""},{appId:this.appId}).subscribe(n=>{0===n.code?(this.message.success(n.msg||i+"\u6210\u529f",{nzDuration:1e3}),this.getClustersData()):(this.solutionRouter=n.data?.router?.name?n.data.router.name:"",this.solutionParam=n.data?.router?.params?n.data.router.params:{},this.solutionRouter?this.publishFailModal.openModal(n.msg,"\u5e94\u7528",this.solutionRouter,this.solutionParam):this.message.error(n.msg||"\u64cd\u4f5c\u5931\u8d25"))})}offline(e){this.api.put("application/offline",{clusterName:e.name||""},{appId:this.appId}).subscribe(i=>{0===i.code&&(this.message.success(i.msg||"\u4e0b\u7ebf\u6210\u529f",{nzDuration:1e3}),this.getClustersData())})}enable(e){this.api.put("application/enable",{clusterName:e.name||""},{appId:this.appId}).subscribe(i=>{0===i.code&&(this.message.success(i.msg||"\u542f\u7528\u6210\u529f",{nzDuration:1e3}),this.getClustersData())})}disable(e){this.api.put("application/disable",{clusterName:e.name||""},{appId:this.appId}).subscribe(i=>{0===i.code&&(this.message.success(i.msg||"\u505c\u7528\u6210\u529f",{nzDuration:1e3}),this.getClustersData())})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(u.VY),t.Y36(m.s),t.Y36(y.D),t.Y36(p.F0),t.Y36(v.a),t.Y36(bt.i))},a.\u0275cmp=t.Xpm({type:a,selectors:[["eo-ng-application-publish"]],viewQuery:function(e,i){if(1&e&&(t.Gf(gt,7,t.Rgc),t.Gf(ft,7,t.Rgc)),2&e){let n;t.iGM(n=t.CRH())&&(i.clusterStatusTpl=n.first),t.iGM(n=t.CRH())&&(i.disabledStatusTpl=n.first)}},decls:7,vars:5,consts:[[1,""],[1,"list-content","tab-list"],["eoNgUserAccess","application",1,"",3,"nzTbody","nzThead","nzData","nzMaxOperatorButton","nzNoScroll","disabledEdit"],["clusterStatusTpl",""],["disabledStatusTpl",""],[3,"status"],[3,"disable"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"eo-ng-apinto-table",2),t.NdJ("disabledEdit",function(o){return i.disabledEdit(o)}),t.qZA()()(),t.YNc(3,At,1,1,"ng-template",null,3,t.W1O),t.YNc(5,Tt,1,1,"ng-template",null,4,t.W1O)),2&e&&(t.xp6(2),t.Q6J("nzTbody",i.clustersTableBody)("nzThead",i.clustersTableHeadName)("nzData",i.clustersList)("nzMaxOperatorButton",2)("nzNoScroll",!0))},dependencies:[L.q,L.s,f.g,A.a],encapsulation:2}),a})()},{path:"message",component:mt},{path:"authentication",component:at}]},{path:"**",component:I}]}];let zt=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[p.Bz.forChild(Ft),p.Bz]}),a})();var yt=s(6681),vt=s(3278),Ct=s(7127),Dt=s(8694),_t=s(8019),Bt=s(9356),Nt=s(2129),kt=s(605),St=s(1293),Zt=s(4383),It=s(8213),Lt=s(7218),xt=s(8284),Mt=s(5156),Ht=s(269),Et=s(7570),Ot=s(2732),Ut=s(2968),Pt=s(7901),Jt=s(3111);let wt=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[Bt.pM,Nt.XS,F.ez,yt._,N.HO,r.u5,Ot.D,kt.Q7,u.hB,u.mx,S.iJ,Ct.um,Ht.HQ,b.FC,vt.YT,St.Sn,_t.Hb,Dt.l,k.r,Zt.Rt,C.r1,Ut.m,d.U5,r.UX,xt.wm,Et.cg,It.Wr,g.Jb,Mt.Qp,Lt.C,Pt.Z,zt,Jt.a]}),a})()}}]);