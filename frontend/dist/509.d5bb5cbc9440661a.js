(self.webpackChunkapinto=self.webpackChunkapinto||[]).push([[509],{4509:(le,Q,b)=>{"use strict";b.r(Q),b.d(Q,{DeployModule:()=>Mi});var _=b(6895),N=b(9132),v=b(7504),h=b(4006),z=b(1461),D=b(3172),e=b(4650),p=b(9561),T=b(3),C=b(2266),E=b(2366),F=b(3679),f=b(6704),y=b(999);const x=function(o){return{"ant-btn-disabled":o}};let U=(()=>{class o{constructor(t,n,u,d){this.message=t,this.api=n,this.fb=u,this.navigationService=d,this.validateForm=new h.cw({}),this.autoTips=z.Sm,this.clusterName="",this.certId="",this.nzDisabled=!1,this.validateForm=this.fb.group({key:["",[h.kI.required]],pem:["",[h.kI.required]]}),this.navigationService.reqFlashBreadcrumb([{title:"\u7f51\u5173\u96c6\u7fa4",routerLink:"deploy/cluster"},{title:"SSL\u8bc1\u4e66"}])}ngOnInit(){}disabledEdit(t){this.nzDisabled=t}save(t){if(this.validateForm.valid)switch(t){case"addCert":this.api.post("cluster/"+this.clusterName+"/certificate",{key:this.encode(this.validateForm.controls.key.value),pem:this.encode(this.validateForm.controls.pem.value)||""}).subscribe(n=>{0===n.code&&this.closeModal&&this.closeModal()});break;case"editCert":this.api.put("cluster/"+this.clusterName+"/certificate/"+this.certId,{key:this.encode(this.validateForm.controls.key.value),pem:this.encode(this.validateForm.controls.pem.value)||""}).subscribe(n=>{0===n.code&&this.closeModal&&this.closeModal()})}else Object.values(this.validateForm.controls).forEach(n=>{n.invalid&&(n.markAsDirty(),n.updateValueAndValidity({onlySelf:!0}))})}readSingleFile(t,n){if(t.target?.files[0]){const u=new FileReader;let d;u.onload=S=>{if(d=S.target?.result,d)switch(n){case"key":this.validateForm.controls.key.setValue(d?.toString()||"");break;case"pem":this.validateForm.controls.pem.setValue(d?.toString()||"")}},u.readAsText(t.target?.files[0],"utf-8")}}encode(t){return D.lW.from(t).toString("base64")}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s),e.Y36(h.QS),e.Y36(C.a))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-cert-form"]],inputs:{closeModal:"closeModal"},decls:21,vars:13,consts:[["nz-form","",3,"nzNoColon","nzAutoTips","formGroup"],[1,"mb-mbase"],["nzRequired","",3,"nzSpan"],[3,"nzSpan"],[1,"ant-btn",3,"ngClass"],["type","file","eo-ng-button","","eoNgUserAccess","deploy/cluster",3,"change"],["rows","3","eo-ng-input","","formControlName","key","placeholder","\u5bc6\u94a5\u6587\u4ef6\u7684\u540e\u7f00\u540d\u4e00\u822c\u4e3a.key\u7684\u6587\u4ef6\u5185\u5bb9","eoNgUserAccess","deploy/cluster",1,"mt-btnybase","cert_textarea"],[1,"mb-0"],["rows","3","eo-ng-input","","formControlName","pem","placeholder","\u8bc1\u4e66\u6587\u4ef6\u7684\u540e\u7f00\u540d\u4e00\u822c\u4e3a.crt\u6216.pem\u7684\u6587\u4ef6\u5185\u5bb9","eoNgUserAccess","deploy/cluster",1,"mt-btnybase","cert_textarea"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0)(1,"nz-form-item",1)(2,"nz-form-label",2),e._uU(3,"\u5bc6\u94a5\uff1a"),e.qZA(),e.TgZ(4,"nz-form-control",3)(5,"p")(6,"label",4)(7,"span"),e._uU(8,"\u4e0a\u4f20\u5bc6\u94a5"),e.qZA(),e.TgZ(9,"input",5),e.NdJ("change",function(d){return n.readSingleFile(d,"key")}),e.qZA()()(),e._UZ(10,"textarea",6),e.qZA()(),e.TgZ(11,"nz-form-item",7)(12,"nz-form-label",2),e._uU(13,"\u8bc1\u4e66\uff1a"),e.qZA(),e.TgZ(14,"nz-form-control",3)(15,"p")(16,"label",4)(17,"span"),e._uU(18,"\u4e0a\u4f20\u8bc1\u4e66"),e.qZA(),e.TgZ(19,"input",5),e.NdJ("change",function(d){return n.readSingleFile(d,"pem")}),e.qZA()()(),e._UZ(20,"textarea",8),e.qZA()()()),2&t&&(e.Q6J("nzNoColon",!0)("nzAutoTips",n.autoTips)("formGroup",n.validateForm),e.xp6(2),e.Q6J("nzSpan",4),e.xp6(2),e.Q6J("nzSpan",15),e.xp6(2),e.Q6J("ngClass",e.VKq(9,x,n.nzDisabled)),e.xp6(6),e.Q6J("nzSpan",4),e.xp6(2),e.Q6J("nzSpan",15),e.xp6(2),e.Q6J("ngClass",e.VKq(11,x,n.nzDisabled)))},dependencies:[_.mk,h._Y,h.Fj,h.JJ,h.JL,E.oO,F.t3,F.SK,f.Lr,f.Nx,f.iK,f.Fd,h.sg,h.u,y.g],styles:["textarea.cert_textarea[_ngcontent-%COMP%]{width:446px!important;max-width:446px!important;height:86px}label.ant-btn[_ngcontent-%COMP%]{font-size:14px;font-family:Helvetica Neue,Helvetica,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Noto Sans CJK SC,WenQuanYi Micro Hei,Arial,sans-serif;white-space:nowrap;text-align:center;border-radius:var(--border-radius);padding:7px 8px!important;height:32px;line-height:14px;text-shadow:none;box-shadow:none}label.ant-btn[_ngcontent-%COMP%]:not(.ant-btn-disabled):focus, label.ant-btn[_ngcontent-%COMP%]:not(.ant-btn-disabled):hover, label.ant-btn[_ngcontent-%COMP%]:not(.ant-btn-disabled):active{border:1px solid var(--primary-color)!important;background-color:#fff!important;color:var(--primary-color)!important}label.ant-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}label.ant-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{font-size:16px;margin-right:4px}label.ant-btn.ant-btn-disabled[_ngcontent-%COMP%], label.ant-btn.ant-btn-disabled[_ngcontent-%COMP%]:active, label.ant-btn.ant-btn-disabled[_ngcontent-%COMP%]:focus, label.ant-btn.ant-btn-disabled[_ngcontent-%COMP%]:hover{color:#00000040!important;border-color:#d9d9d9!important;background:#f5f5f5!important;text-shadow:none!important;box-shadow:none!important;cursor:not-allowed}"]}),o})();const J=[{title:"\u8bc1\u4e66"},{title:"\u8bc1\u4e66\u6709\u6548\u671f"},{title:"\u66f4\u65b0\u8005"},{title:"\u66f4\u65b0\u65f6\u95f4"},{title:"\u64cd\u4f5c",right:!0}],B=[{key:"name",copy:!0},{key:"validTime"},{key:"operator"},{key:"updateTime"},{type:"btn",right:!0,btns:[{title:"\u4fee\u6539"},{title:"\u5220\u9664"}]}],$=[{title:"\u540d\u79f0"},{title:"\u7ba1\u7406\u5730\u5740"},{title:"\u670d\u52a1\u5730\u5740"},{title:"\u72b6\u6001"}],ie=[{key:"name",copy:!0},{key:"adminAddr",json:!0,copy:!0},{key:"serviceAddr",json:!0,copy:!0},{key:"status"}],ue=[{title:"KEY",resizeable:!0},{title:"OLD VALUE",resizeable:!0},{title:"NEW VALUE",resizeable:!0},{title:"\u7c7b\u578b",resizeable:!0},{title:"\u64cd\u4f5c\u65f6\u95f4"}],pe=[{key:"key",copy:!0},{key:"oldValue",copy:!0},{key:"newValue",copy:!0},{key:"optType"},{key:"createTime"}],ce=[{width:45},{title:"\u7248\u672c\u540d\u79f0",resizeable:!0},{title:"\u53d1\u5e03\u8005",resizeable:!0},{title:"\u53d1\u5e03\u65f6\u95f4"}],de=[{key:""},{key:"name",copy:!0},{key:"operator"},{key:"createTime"}],Te=[{title:"KEY",resizeable:!0},{title:"\u53d1\u5e03\u7684\u503c",resizeable:!0},{title:"\u672a\u53d1\u5e03\u7684\u503c",resizeable:!0},{title:"\u7c7b\u578b",resizeable:!0},{title:"\u64cd\u4f5c\u65f6\u95f4"}],ve=[{key:"key"},{key:"finishValue",copy:!0},{key:"noReleasedValue",copy:!0},{key:"optType"},{key:"createTime"}],he=[{title:"KEY",resizeable:!0},{title:"VALUE",resizeable:!0},{title:"\u63cf\u8ff0",resizeable:!0},{title:"\u53d1\u5e03\u72b6\u6001",resizeable:!0},{title:"\u66f4\u65b0\u8005",resizeable:!0},{title:"\u66f4\u65b0\u65f6\u95f4"},{title:"\u64cd\u4f5c",right:!0}],me=[{title:"\u96c6\u7fa4\u540d\u79f0"},{title:"\u63cf\u8ff0"},{title:"\u73af\u5883"},{title:"\u72b6\u6001"},{title:"\u64cd\u4f5c",right:!0}],ze=[{title:"\u63d2\u4ef6\u540d\u79f0",width:150},{title:"\u53d1\u5e03\u72b6\u6001"},{title:"\u72b6\u6001"},{title:"\u914d\u7f6e",width:200},{title:"\u66f4\u65b0\u65f6\u95f4"},{title:"\u64cd\u4f5c",right:!0}],X=[{label:"\u5168\u5c40\u542f\u7528",value:"GLOBAL"},{label:"\u542f\u7528",value:"ENABLE"},{label:"\u7981\u7528",value:"DISABLE"}],De=[{title:"\u63d2\u4ef6\u540d\u79f0"},{title:"\u53d1\u5e03\u7684\u914d\u7f6e"},{title:"\u672a\u53d1\u5e03\u7684\u914d\u7f6e"},{title:"\u7c7b\u578b"},{title:"\u64cd\u4f5c\u65f6\u95f4"}],Fe=[{key:"name"},{key:"finishValue",json:!0,copy:!0},{key:"noReleasedValue",json:!0,copy:!0},{key:"optType"},{key:"createTime"}],ge=[{title:"\u63d2\u4ef6\u540d\u79f0"},{title:"\u65e7\u914d\u7f6e"},{title:"\u65b0\u914d\u7f6e"},{title:"\u7c7b\u578b"},{title:"\u64cd\u4f5c\u65f6\u95f4"}],I=[{key:"name"},{key:"oldValue",json:!0,copy:!0},{key:"newValue",json:!0,copy:!0},{key:"optType"},{key:"createTime"}];var Z=b(8513),M=b(4162),O=b(2663);let fe=(()=>{class o{constructor(t,n,u,d,S,L){this.message=t,this.modalService=n,this.api=u,this.baseInfo=d,this.router=S,this.navigationService=L,this.clusterName="",this.nzDisabled=!1,this.certsList=[],this.certsTableHeadName=[...J],this.certsTableBody=[...B],this.certTableClick=Y=>{this.openDrawer("editCert",Y.data)},this.closeModal=()=>{this.getCertsList(),this.modalRef?.close()},this.navigationService.reqFlashBreadcrumb([{title:"\u7f51\u5173\u96c6\u7fa4",routerLink:"deploy/cluster"},{title:"SSL\u8bc1\u4e66"}])}ngOnInit(){this.clusterName=this.baseInfo.allParamsInfo.clusterName,this.clusterName||this.router.navigate(["/"]),this.certsTableBody[4].btns[0].disabledFn=()=>this.nzDisabled,this.certsTableBody[4].btns[0].click=t=>{this.openDrawer("editCert",t.data)},this.certsTableBody[4].btns[1].disabledFn=()=>this.nzDisabled,this.certsTableBody[4].btns[1].click=t=>{this.delete(t.data)},this.getCertsList()}disabledEdit(t){this.nzDisabled=t}delete(t,n){n?.stopPropagation(),this.modalService.create({nzTitle:"\u5220\u9664",nzContent:"\u8be5\u6570\u636e\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u627e\u56de\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\uff1f",nzClosable:!0,nzClassName:"delete-modal",nzWidth:v.G_,nzOkDanger:!0,nzOnOk:()=>{this.deleteCert(t)}})}getCertsList(){this.api.get("cluster/"+this.clusterName+"/certificates").subscribe(t=>{0===t.code&&(this.certsList=t.data.certificates)})}openDrawer(t,n,u){u?.stopPropagation(),this.modalRef=this.modalService.create({nzTitle:"addCert"===t?"\u65b0\u5efa\u8bc1\u4e66":"\u4fee\u6539\u8bc1\u4e66",nzWidth:v.G_,nzContent:U,nzComponentParams:{certId:n?.id,clusterName:this.clusterName,closeModal:this.closeModal},nzOkText:"addCert"===t?"\u4fdd\u5b58":"\u63d0\u4ea4",nzOnOk:d=>(d.save(t),!1)})}deleteCert(t){this.api.delete("cluster/"+(this.clusterName||"")+"/certificate/"+(t.id||"")).subscribe(n=>{0===n.code&&(this.getCertsList(),this.message.success(n.msg||"\u5220\u9664\u6210\u529f!",{nzDuration:1e3}))})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(p._B),e.Y36(T.s),e.Y36(Z.D),e.Y36(N.F0),e.Y36(C.a))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-cert"]],decls:6,vars:5,consts:[[1,""],[1,"list-header","pl-btnbase","pr-btnrbase","py-btnybase","flex","flex-nowrap","items-center","justify-between"],["eo-ng-button","","eoNgUserAccess","deploy/cluster",1,"ant-btn-primary",3,"disabledEdit","click"],[1,"list-content"],[1,"",3,"nzTbody","nzThead","nzData","nzTrClick","nzMaxOperatorButton"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("disabledEdit",function(d){return n.disabledEdit(d)})("click",function(){return n.openDrawer("addCert")}),e._uU(3," \u65b0\u5efa\u8bc1\u4e66 "),e.qZA()(),e.TgZ(4,"div",3),e._UZ(5,"eo-ng-apinto-table",4),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("nzTbody",n.certsTableBody)("nzThead",n.certsTableHeadName)("nzData",n.certsList)("nzTrClick",n.certTableClick)("nzMaxOperatorButton",2))},dependencies:[M.qK,y.g,O.a]}),o})(),be=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[N.lC],encapsulation:2}),o})(),W=(()=>{class o{constructor(){this.clusterName="",this.clusterDesc="",this.createPluginsTbody=t=>[{type:"sort"},{title:t.pluginName},{key:"extended",copy:!0},{key:"desc"},{key:"updateTime"},{type:"btn",right:!0,btns:[{title:"\u7f16\u8f91",click:n=>{t.router.navigate(["/","deploy","plugin","message",n.data.name])}},{title:"\u5220\u9664",disabledFn:n=>!n.isDelete||t.nzDisabled,click:n=>{t.delete(n.data)}}]}]}createClusterEnvUpdateThead(t){return[{type:"checkbox",click:()=>{t.getClusterCheckedList()}},{title:"\u96c6\u7fa4\u540d\u79f0",resizeable:!0},{title:"\u6240\u5728\u73af\u5883"}]}createClusterEnvUpdateTbody(t){return[{key:"checked",type:"checkbox",click:()=>{t.getClusterCheckedList()}},{key:"name",copy:!0},{key:"env"}]}createClusterEnvUpdate2Thead(t){return[{type:"checkbox",click:()=>{t.getVarCheckedList()}},{title:"KEY",resizeable:!0,copy:!0},{title:"VALUE",resizeable:!0,copy:!0},{title:"\u66f4\u65b0\u65f6\u95f4"}]}createClusterEnvUpdate2Tbody(t){return[{key:"checked",type:"checkbox",click:()=>{t.getVarCheckedList()}},{key:"key"},{key:"value"},{key:"updateTime"}]}createClusterEnvConfigTbody(t){return[{key:"key",copy:!0},{key:"value",copy:!0},{key:"desc"},{key:"publish"},{key:"operator"},{key:"updateTime"},{type:"btn",right:!0,showFn:n=>"DEFECT"!==n.publish,btns:[{title:"\u7f16\u8f91",disabledFn:()=>t.nzDisabled,click:n=>{t.openDrawer("editConfig",n.data)}},{title:"\u5220\u9664",click:n=>{t.delete(n.data)},disabledFn:()=>t.nzDisabled}]},{type:"btn",right:!0,showFn:n=>"DEFECT"===n.publish,btns:[{title:"\u7f16\u8f91",click:n=>{t.openDrawer("editConfig",n.data)},disabledFn:()=>t.nzDisabled}]}]}createClusterTbody(t){return[{key:"title",copy:!0},{key:"desc"},{key:"env"},{key:"status",title:t.clusterStatusTpl},{type:"btn",right:!0,btns:[{title:"\u67e5\u770b",click:n=>{t.router.navigate(["/","deploy","cluster","content",n.data.name]),this.clusterName=n.data.title,this.clusterDesc=n.data.desc}},{title:"\u5220\u9664",disabledFn:()=>t.nzDisabled,click:n=>{t.delete(n.data)}}]}]}createPluginTbody(t){return[{key:"name",copy:!0},{key:"publish"},{key:"status"},{key:"config",json:!0,copy:!0},{key:"updateTime"},{type:"btn",right:!0,btns:[{title:"\u914d\u7f6e",disabledFn:n=>n.isBuiltin||t.nzDisabled,click:n=>{t.openDrawer("editConfig",n.data)}}]}]}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var ee=b(6084);const Ae=["tab1"],Ne=["tab2"],_e=["tab3"],te=["tab5"],V=["tab6"];function oe(o,s){1&o&&(e.TgZ(0,"span"),e._uU(1,"\u5168\u5c40\u53d8\u91cf"),e.qZA())}function Ee(o,s){1&o&&(e.TgZ(0,"span"),e._uU(1,"SSL\u8bc1\u4e66"),e.qZA())}function r(o,s){1&o&&(e.TgZ(0,"span"),e._uU(1,"\u8282\u70b9\u5217\u8868"),e.qZA())}function i(o,s){1&o&&(e.TgZ(0,"span"),e._uU(1,"\u8282\u70b9\u63d2\u4ef6"),e.qZA())}function a(o,s){1&o&&(e.TgZ(0,"span"),e._uU(1,"\u96c6\u7fa4\u7ba1\u7406"),e.qZA())}let l=(()=>{class o{constructor(t,n,u,d,S){this.service=t,this.baseInfo=n,this.api=u,this.router=d,this.cdRef=S,this.tab1="\u5168\u5c40\u53d8\u91cf",this.tab2="SSL\u8bc1\u4e66",this.tab3="\u8282\u70b9\u5217\u8868",this.tab5="\u8282\u70b9\u63d2\u4ef6",this.tab6="\u96c6\u7fa4\u7ba1\u7406",this.clusterName="",this.clusterDesc="",this._clusterDesc="",this.options=[],this.disabled=!0,this.tabOptions=[],this.nowUrl=this.router.routerState.snapshot.url}ngOnInit(){this.clusterName=this.baseInfo.allParamsInfo.clusterName,this.clusterName||this.router.navigate(["/"]),this.router.url.includes("/message")||this.getClustersData()}ngAfterViewInit(){this.tabOptions=[{title:this.tab3,routerLink:".",queryParamsHandling:"merge"},{title:this.tab5,routerLink:"plugin",queryParamsHandling:"merge"},{title:this.tab1,routerLink:"env",queryParamsHandling:"merge"},{title:this.tab2,routerLink:"cert",queryParamsHandling:"merge"},{title:this.tab6,routerLink:"message",queryParamsHandling:"merge"}],this.cdRef.detectChanges()}ngAfterViewChecked(){document.getElementsByClassName("ant-tabs-ink-bar")[0]?.removeAttribute("hidden")}getClustersData(){this.api.get("cluster",{clusterName:this.clusterName}).subscribe(t=>{0===t.code&&(this.service.clusterName=t.data.cluster.title,this.service.clusterDesc=t.data.cluster.desc,this.clusterDesc=t.data.cluster.desc,this._clusterDesc=t.data.cluster.desc)})}save(){this.api.put("cluster/"+this.clusterName+"/desc",{desc:this._clusterDesc}).subscribe(t=>{0===t.code?this.clusterDesc=this._clusterDesc:this._clusterDesc=this.clusterDesc}),this.disabled=!0}backToList(){this.router.navigate(["/","deploy","cluster"])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(W),e.Y36(Z.D),e.Y36(T.s),e.Y36(N.F0),e.Y36(e.sBO))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-content"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Ae,7,e.Rgc),e.Gf(Ne,7,e.Rgc),e.Gf(_e,7,e.Rgc),e.Gf(te,7,e.Rgc),e.Gf(V,7,e.Rgc)),2&t){let u;e.iGM(u=e.CRH())&&(n.tab1=u.first),e.iGM(u=e.CRH())&&(n.tab2=u.first),e.iGM(u=e.CRH())&&(n.tab3=u.first),e.iGM(u=e.CRH())&&(n.tab5=u.first),e.iGM(u=e.CRH())&&(n.tab6=u.first)}},decls:19,vars:4,consts:[[1,"overflow-hidden"],[1,"pl-btnbase","pr-btnrbase","py-btnybase","border-[0px]","border-b-[1px]","border-solid","border-BORDER"],["eo-ng-button","","type","default",1,"mr-btnbase",3,"click"],[1,"font-bold"],[3,"nzLinkRouter","nzOptions"],["tab1",""],["tab2",""],["tab3",""],["tab5",""],["tab6",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"section")(3,"button",2),e.NdJ("click",function(){return n.backToList()}),e._uU(4," \u8fd4\u56de "),e.qZA(),e.TgZ(5,"span",3),e._uU(6),e.qZA()()(),e._UZ(7,"eo-ng-tabs",4),e.YNc(8,oe,2,0,"ng-template",null,5,e.W1O),e.YNc(10,Ee,2,0,"ng-template",null,6,e.W1O),e.YNc(12,r,2,0,"ng-template",null,7,e.W1O),e.YNc(14,i,2,0,"ng-template",null,8,e.W1O),e.YNc(16,a,2,0,"ng-template",null,9,e.W1O),e._UZ(18,"router-outlet"),e.qZA()),2&t&&(e.xp6(6),e.AsE("",n.service.clusterName," \uff1a ",n.service.clusterDesc,""),e.xp6(1),e.Q6J("nzLinkRouter",!0)("nzOptions",n.tabOptions))},dependencies:[ee.n4,M.qK,N.lC],styles:[".cluster-desc-block[_ngcontent-%COMP%]{background-color:var(--bar-background-color);padding:16px}.cluster-desc-block[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;align-items:center}.cluster-desc-block[_ngcontent-%COMP%]   .cluster-desc-title[_ngcontent-%COMP%]{color:#333;font-size:14px;font-weight:500}.cluster-desc-block[_ngcontent-%COMP%]   .cluster-desc-content[_ngcontent-%COMP%]{margin-left:8px;color:#666;display:flex;flex-wrap:nowrap;align-items:center;overflow:hidden}.cluster-desc-block[_ngcontent-%COMP%]   input.cluster-desc-content[_ngcontent-%COMP%]{min-width:346px;width:100%!important}.cluster-desc-block[_ngcontent-%COMP%]   .cluster-desc-text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.cluster-desc-block[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:8px}"]}),o})();var c=b(1042),m=b(8344);const g=["nodeStatusTpl"];function A(o,s){1&o&&(e.ynx(0),e._uU(1,"\u8bf7\u8f93\u5165\u96c6\u7fa4\u5730\u5740"),e.BQk())}function w(o,s){1&o&&(e.ynx(0),e._uU(1,"\u96c6\u7fa4\u5730\u5740\u8f93\u5165\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"),e.BQk())}function k(o,s){1&o&&(e.ynx(0),e._uU(1,"\u65e0\u6cd5\u8fde\u63a5\u8be5\u96c6\u7fa4\uff0c\u8bf7\u68c0\u67e5\u5730\u5740\u662f\u5426\u6709\u8bef\uff0c\u4fee\u6539\u540e\u91cd\u8bd5"),e.BQk())}function R(o,s){if(1&o&&(e.YNc(0,A,2,0,"ng-container",19),e.YNc(1,w,2,0,"ng-container",19),e.YNc(2,k,2,0,"ng-container",19)),2&o){const t=e.oxw(2);e.Q6J("ngIf",t.validateForm.controls.clusterAddr.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.validateForm.controls.clusterAddr.hasError("pattern")),e.xp6(1),e.Q6J("ngIf",t.validateForm.controls.clusterAddr.hasError("source"))}}const P=function(){return{standalone:!0}};function ne(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",5)(1,"nz-form-item")(2,"nz-form-label",6),e._uU(3,"\u96c6\u7fa4\u540d\u79f0\uff1a"),e.qZA(),e.TgZ(4,"nz-form-control",7),e._UZ(5,"input",8,9),e.qZA()(),e.TgZ(7,"nz-form-item")(8,"nz-form-label",6),e._uU(9,"\u73af\u5883\uff1a"),e.qZA(),e.TgZ(10,"nz-form-control",7),e._UZ(11,"eo-ng-select",10),e.qZA()(),e.TgZ(12,"nz-form-item")(13,"nz-form-label",7),e._uU(14,"\u63cf\u8ff0\uff1a"),e.qZA(),e.TgZ(15,"nz-form-control",7),e._UZ(16,"textarea",11),e.qZA()(),e.TgZ(17,"nz-form-item",12)(18,"nz-form-label",6),e._uU(19,"\u96c6\u7fa4\u5730\u5740(\u7f51\u5173\u8282\u70b9)\uff1a"),e.qZA(),e.TgZ(20,"nz-form-control",13)(21,"eo-ng-input-group",14)(22,"eo-ng-select",15),e.NdJ("ngModelChange",function(u){e.CHM(t);const d=e.oxw();return e.KtG(d.clusterProtocol=u)})("ngModelChange",function(){e.CHM(t);const u=e.oxw();return e.KtG(u.checkClusterError=!1)}),e._UZ(23,"eo-ng-option",16)(24,"eo-ng-option",16),e.qZA(),e._UZ(25,"input",17),e.qZA(),e.YNc(26,R,3,3,"ng-template",null,18,e.W1O),e.qZA()()()}if(2&o){const t=e.MAs(27),n=e.oxw();e.xp6(2),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12),e.xp6(4),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12),e.xp6(1),e.Q6J("nzOptions",n.environmentList),e.xp6(2),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12),e.xp6(3),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12)("nzValidateStatus",n.startCheckCluster&&n.validateForm.controls.clusterAddr.invalid?"error":"")("nzErrorTip",t),e.xp6(2),e.Q6J("ngModel",n.clusterProtocol)("ngModelOptions",e.DdM(17,P)),e.xp6(1),e.Q6J("nzLabel","Http")("nzValue","http"),e.xp6(1),e.Q6J("nzLabel","Https")("nzValue","https")}}function Ce(o,s){if(1&o&&(e.TgZ(0,"div",20)(1,"div",21)(2,"p",22),e._uU(3),e.qZA(),e._UZ(4,"eo-ng-apinto-table",23),e.qZA()()),2&o){const t=e.oxw();e.xp6(3),e.hij(" \u68c0\u67e5\u901a\u8fc7\u3002\u8be5\u96c6\u7fa4\u6709",t.nodesList.length||0,"\u4e2a\u8282\u70b9 "),e.xp6(1),e.Q6J("nzTbody",t.nodesTableBody)("nzThead",t.nodesTableHeadName)("nzData",t.nodesList)("nzNoScroll",!0)}}function ye(o,s){1&o&&(e.TgZ(0,"span",27),e._uU(1,"\u672a\u8fd0\u884c"),e.qZA())}function Oe(o,s){1&o&&(e.TgZ(0,"span",28),e._uU(1,"\u8fd0\u884c\u4e2d"),e.qZA())}function Re(o,s){1&o&&(e.ynx(0,24),e.YNc(1,ye,2,0,"span",25),e.YNc(2,Oe,2,0,"span",26),e.BQk()),2&o&&(e.Q6J("ngSwitch",s.item.status),e.xp6(1),e.Q6J("ngSwitchCase","NOTRUNNING"),e.xp6(1),e.Q6J("ngSwitchCase","RUNNING"))}let xe=(()=>{class o{constructor(t,n,u,d,S){this.message=t,this.api=n,this.router=u,this.fb=d,this.navigationService=S,this.validateForm=new h.cw({}),this.source="",this.environmentList=[],this.nodesList=[],this.nodesTableHeadName=[...$],this.nodesTableBody=[...ie],this.submitButtonLoading=!1,this.testButtonLoading=!1,this.nodesTableShow=!1,this.clusterCanBeCreated=!1,this.testFlag=!1,this.testPassAddr="",this.autoTips=z.Sm,this.clusterProtocol="http",this.startCheckCluster=!1,this.checkClusterError=!1,this.checkClusterErrorAddr="",this.newAddr="",this.clusterAddrVadidator=L=>L.value?/([a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?)(:\d+)/.test(L.value)||/(((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3})(:\d*)/.test(L.value)?this.checkClusterError&&L.value===this.checkClusterErrorAddr?{source:!0,error:!0}:{}:{error:!0,pattern:!0}:{error:!0,required:!0},this.validateForm=this.fb.group({clusterName:["",[h.kI.required]],envValue:["",[h.kI.required]],clusterDesc:[""],clusterAddr:["",[this.clusterAddrVadidator]]})}ngOnInit(){this.getEnvList()}ngAfterViewInit(){this.nodesTableBody[3].title=this.nodeStatusTpl}getEnvList(){this.api.get("enum/envs").subscribe(t=>{0===t.code&&(this.environmentList=t.data.envs.map(n=>({label:n.name,value:n.value})),this.validateForm.controls.envValue.setValue(this.environmentList[0].value),this.validateForm.controls.envValue.updateValueAndValidity({onlySelf:!0}))})}testCluster(){this.startCheckCluster=!0,this.validateForm.valid?(this.testFlag=!0,this.testButtonLoading=!0,this.newAddr=this.validateForm.controls.clusterAddr.value,this.newAddr=/^(\/\/)/.test(this.validateForm.controls.clusterAddr.value)?`${this.clusterProtocol}:${this.newAddr}`:/^(\/)/.test(this.validateForm.controls.clusterAddr.value)?`${this.clusterProtocol}:/${this.newAddr}`:`${this.clusterProtocol}://${this.newAddr}`,this.api.get("cluster-test",{clusterAddr:this.newAddr}).subscribe(t=>{this.testButtonLoading=!1,0===t.code?(this.nodesList=t.data.nodes,this.clusterCanBeCreated=t.data.isUpdate,this.source=t.data.source,this.nodesList.length>0&&(this.nodesTableShow=!0),this.source&&(this.testPassAddr=this.validateForm.controls.clusterAddr.value),this.validateForm.controls.clusterAddr.updateValueAndValidity({onlySelf:!0})):(this.checkClusterError=!0,this.checkClusterErrorAddr=this.validateForm.controls.clusterAddr.value,this.validateForm.controls.clusterAddr.markAsDirty(),this.validateForm.controls.clusterAddr.updateValueAndValidity({onlySelf:!0}))})):Object.values(this.validateForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}saveCluster(){if(this.validateForm.markAllAsTouched(),this.validateForm.valid||this.checkValidForm()){const t=`cluster_${(0,c.Z)().replace(/-/g,"_")}`,n={title:this.validateForm.controls.clusterName.value,name:t,desc:this.validateForm.controls.clusterDesc.value||"",addr:this.newAddr,source:this.source||"",env:this.validateForm.controls.envValue.value};this.submitButtonLoading=!0,this.api.post("cluster",n).subscribe(u=>{this.submitButtonLoading=!1,0===u.code&&this.router.navigate(["/","deploy","cluster","content",t])})}else Object.values(this.validateForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}checkValidForm(){for(const t in this.validateForm.controls)if(this.validateForm.controls[t].invalid)return!1;return!0}cancel(){this.nodesTableShow?this.nodesTableShow=!1:this.closeModal&&this.closeModal()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s),e.Y36(N.F0),e.Y36(h.QS),e.Y36(C.a))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-cluster-create"]],viewQuery:function(t,n){if(1&t&&e.Gf(g,7,e.Rgc),2&t){let u;e.iGM(u=e.CRH())&&(n.nodeStatusTpl=u.first)}},decls:6,vars:5,consts:[[1,""],["nz-form","",3,"nzNoColon","nzAutoTips","formGroup"],["class","list-header flex-nowrap items-center justify-between",4,"ngIf"],["class","mt-btnybase mb-0","style","padding-bottom: '0px'",4,"ngIf"],["nodeStatusTpl",""],[1,"list-header","flex-nowrap","items-center","justify-between"],["nzRequired","",3,"nzSpan"],[3,"nzSpan"],["eo-ng-input","","formControlName","clusterName","placeholder","\u8bf7\u8f93\u5165\u96c6\u7fa4\u540d\u79f0","eoNgUserAccess","deploy/cluster",1,"w-INPUT_NORMAL"],["clusterNameInput",""],["formControlName","envValue","nzAllowClear","","eoNgUserAccess","deploy/cluster",1,"w-INPUT_NORMAL",3,"nzOptions"],["rows","6","eo-ng-input","","formControlName","clusterDesc","placeholder","\u8bf7\u8f93\u5165","eoNgUserAccess","deploy/cluster",1,"w-INPUT_NORMAL"],[1,"mb-0"],[3,"nzSpan","nzValidateStatus","nzErrorTip"],["nzCompact","",1,"w-INPUT_NORMAL"],[1,"w-[25%]",3,"ngModel","ngModelOptions","ngModelChange"],[3,"nzLabel","nzValue"],["type","text","eo-ng-input","","formControlName","clusterAddr","placeholder","\u8bf7\u8f93\u5165",1,"w-[75%]"],["nodeErrorTpl",""],[4,"ngIf"],[1,"mt-btnybase","mb-0",2,"padding-bottom","'0px'"],[2,"width","524px","margin","auto"],[1,"font-bold","mb-btnybase"],["nzTableLayout","fixed",3,"nzTbody","nzThead","nzData","nzNoScroll"],[3,"ngSwitch"],["class","red-bold",4,"ngSwitchCase"],["class","green-bold",4,"ngSwitchCase"],[1,"red-bold"],[1,"green-bold"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"form",1),e.YNc(2,ne,28,18,"div",2),e.YNc(3,Ce,5,5,"div",3),e.qZA()(),e.YNc(4,Re,3,3,"ng-template",null,4,e.W1O)),2&t&&(e.xp6(1),e.Q6J("nzNoColon",!0)("nzAutoTips",n.autoTips)("formGroup",n.validateForm),e.xp6(1),e.Q6J("ngIf",!n.nodesTableShow),e.xp6(1),e.Q6J("ngIf",n.nodesTableShow))},dependencies:[_.O5,_.RF,_.n9,m.Hf,m.x8,h._Y,h.Fj,h.JJ,h.JL,h.On,E.oO,E.aI,F.t3,F.SK,f.Lr,f.Nx,f.iK,f.Fd,h.sg,h.u,y.g,O.a]}),o})();function Me(o,s){1&o&&(e.ynx(0),e._uU(1,"\u82f1\u6587\u3001\u4e0b\u5212\u7ebf\u53ca\u5706\u70b9\u7ec4\u5408"),e.BQk())}function Je(o,s){1&o&&(e.ynx(0),e._uU(1,"\u5fc5\u586b\u9879"),e.BQk())}function Ye(o,s){if(1&o&&(e.YNc(0,Me,2,0,"ng-container",11),e.YNc(1,Je,2,0,"ng-container",11)),2&o){const t=s.$implicit;e.Q6J("ngIf",t.hasError("pattern")),e.xp6(1),e.Q6J("ngIf",t.hasError("required"))}}function Qe(o,s){if(1&o&&e._UZ(0,"p",15),2&o){const t=e.oxw(2);e.Q6J("innerHtml",t.valueAfterTest,e.oJD)}}function qe(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"p",12),e._uU(1," \u6ce8\u610f\uff1a\u9690\u85cf\u5b57\u7b26(\u7a7a\u683c\u3001\u6362\u884c\u7b26\u3001\u5236\u8868\u7b26Tab)\u5bb9\u6613\u5bfc\u81f4\u914d\u7f6e\u51fa\u9519\uff0c\u5982\u679c\u9700\u8981\u68c0\u6d4bValue\u4e2d\u9690\u85cf\u5b57\u7b26\uff0c\u8bf7\u70b9\u51fb"),e.TgZ(2,"a",13),e.NdJ("click",function(){e.CHM(t);const u=e.oxw();return e.KtG(u.detect())}),e._uU(3,"\u68c0\u6d4b\u9690\u85cf\u5b57\u7b26"),e.qZA()(),e.YNc(4,Qe,1,1,"p",14)}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",t.showValueAfterTest)}}let Se=(()=>{class o{constructor(t,n,u){this.message=t,this.api=n,this.fb=u,this.autoTips=z.Sm,this.validateAddConfigForm=new h.cw({}),this.valueAfterTest="",this.showValueAfterTest=!1,this.clusterName="",this.closeModal=d=>{}}ngOnInit(){this.validateAddConfigForm=this.fb.group({key:[this.editData?.key||"",[h.kI.required,h.kI.pattern(/^[A-Za-z_\\.]*$/)]],value:[this.editData?.value||""],desc:[this.editData?.desc||""]}),this.editData&&(this.validateAddConfigForm.controls.key.disable(),this.validateAddConfigForm.controls.desc.disable())}detect(){""!==this.validateAddConfigForm.value.value&&(this.valueAfterTest=this.validateAddConfigForm.value.value.replace(/(\n|\r|\r\n|\u21b5)/g,"#\u6362\u884c\u7b26#").replace(/\t/g,"#\u5236\u8868\u7b26#").replace(/\s/g,"#\u7a7a\u683c#").replace(/#\u7a7a\u683c#/g,'<span class="detected-symbol">#\u7a7a\u683c#</span>').replace(/#\u6362\u884c\u7b26#/g,'<span class="detected-symbol">#\u6362\u884c\u7b26#</span>').replace(/#\u5236\u8868\u7b26#/g,'<span class="detected-symbol">#\u5236\u8868\u7b26#</span>'),this.showValueAfterTest=!0)}save(){this.validateAddConfigForm.valid?this.editData?this.api.put("cluster/"+this.clusterName+"/variable",{value:this.validateAddConfigForm.value.value||""},{key:this.validateAddConfigForm.controls.key.value||""}).subscribe(t=>0===t.code&&(this.message.success(t.msg||"\u7f16\u8f91\u6210\u529f",{nzDuration:1e3}),this.closeModal(!0),!0)):this.api.post("cluster/"+this.clusterName+"/variable",{key:this.validateAddConfigForm.value.key||"",value:this.validateAddConfigForm.value.value||"",desc:this.validateAddConfigForm.value.desc||""},{key:this.validateAddConfigForm.value.key||""}).subscribe(t=>{0===t.code&&(this.message.success(t.msg||"\u6dfb\u52a0\u6210\u529f",{nzDuration:1e3}),this.closeModal(!0))}):Object.values(this.validateAddConfigForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s),e.Y36(h.QS))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-environment-config-form"]],inputs:{editData:"editData"},decls:20,vars:11,consts:[["nz-form","",1,"deploy-drawer",3,"nzNoColon","nzAutoTips","formGroup"],["nzRequired","",3,"nzSpan"],[3,"nzSpan","nzErrorTip"],["eo-ng-input","","formControlName","key","eoNgUserAccess","deploy/cluster","placeholder","\u82f1\u6587\u3001\u4e0b\u5212\u7ebf\u53ca\u5706\u70b9\u7ec4\u5408",1,"w-INPUT_NORMAL"],["matchKeyErrorTpl",""],[3,"nzSpan"],[3,"nzSpan","nzExtra"],["rows","8","eoNgUserAccess","deploy/cluster","eo-ng-input","","formControlName","value","placeholder","\u8bf7\u8f93\u5165",1,"w-INPUT_NORMAL"],["valueExtraTpl",""],[1,"mb-0"],["eo-ng-input","","formControlName","desc","placeholder","\u8bf7\u8f93\u5165","eoNgUserAccess","deploy/cluster",1,"w-INPUT_NORMAL"],[4,"ngIf"],[1,"w-INPUT_NORMAL"],[3,"click"],["class","detect_value_bg w-INPUT_NORMAL",3,"innerHtml",4,"ngIf"],[1,"detect_value_bg","w-INPUT_NORMAL",3,"innerHtml"]],template:function(t,n){if(1&t&&(e.TgZ(0,"form",0)(1,"nz-form-item")(2,"nz-form-label",1),e._uU(3,"KEY\uff1a"),e.qZA(),e.TgZ(4,"nz-form-control",2),e._UZ(5,"input",3),e.YNc(6,Ye,2,2,"ng-template",null,4,e.W1O),e.qZA()(),e.TgZ(8,"nz-form-item")(9,"nz-form-label",5),e._uU(10,"VALUE\uff1a"),e.qZA(),e.TgZ(11,"nz-form-control",6),e._UZ(12,"textarea",7),e.qZA()(),e.YNc(13,qe,5,1,"ng-template",null,8,e.W1O),e.TgZ(15,"nz-form-item",9)(16,"nz-form-label",5),e._uU(17,"\u63cf\u8ff0\uff1a"),e.qZA(),e.TgZ(18,"nz-form-control",5),e._UZ(19,"textarea",10),e.qZA()()()),2&t){const u=e.MAs(7),d=e.MAs(14);e.Q6J("nzNoColon",!0)("nzAutoTips",n.autoTips)("formGroup",n.validateAddConfigForm),e.xp6(2),e.Q6J("nzSpan",6),e.xp6(2),e.Q6J("nzSpan",13)("nzErrorTip",u),e.xp6(5),e.Q6J("nzSpan",6),e.xp6(2),e.Q6J("nzSpan",13)("nzExtra",d),e.xp6(5),e.Q6J("nzSpan",6),e.xp6(2),e.Q6J("nzSpan",13)}},dependencies:[_.O5,h._Y,h.Fj,h.JJ,h.JL,E.oO,F.t3,F.SK,f.Lr,f.Nx,f.iK,f.Fd,h.sg,h.u,y.g],styles:[".detect_value_bg[_ngcontent-%COMP%]{background-color:var(--bar-background-color);padding-left:var(--LAYOUT_PADDING);word-break:break-all}"]}),o})();function He(o,s){1&o&&(e.TgZ(0,"div",13)(1,"div",14)(2,"div",15),e._uU(3," \u5fc5\u586b\u9879\uff01 "),e.qZA()()())}function Ve(o,s){1&o&&(e.TgZ(0,"div",13)(1,"div",14)(2,"div",15),e._uU(3," \u5fc5\u586b\u9879\uff01 "),e.qZA()()())}let Ge=(()=>{class o{constructor(t,n,u){this.message=t,this.api=n,this.service=u,this.clustersList=[],this.clusterTableHeadName=[...this.service.createClusterEnvUpdateThead(this)],this.clusterTableBody=[...this.service.createClusterEnvUpdateTbody(this)],this.configsTable2HeadName=[...this.service.createClusterEnvUpdate2Thead(this)],this.configsTable2Body=[...this.service.createClusterEnvUpdate2Tbody(this)],this.updateConfigsList=[],this.clusterName="",this.updateConfigForm={clusters:[],variables:[]},this.startValidate=!1}ngOnInit(){this.getUpdateData()}getUpdateData(){this.api.get("cluster/"+this.clusterName+"/variable/sync-conf").subscribe(t=>{0===t.code&&(this.clustersList=t.data.info.clusters,this.updateConfigsList=t.data.info.variables)})}getVarCheckedList(){setTimeout(()=>{this.updateConfigForm.variables=this.updateConfigsList?.filter(t=>t.checked)},0)}getClusterCheckedList(){setTimeout(()=>{this.updateConfigForm.clusters=this.clustersList.filter(t=>t.checked)},0)}save(){this.getClusterCheckedList(),this.getVarCheckedList(),this.startValidate=!0,this.updateConfigForm.clusters?.length>0&&this.updateConfigForm.variables?.length>0&&this.api.post("cluster/"+this.clusterName+"/variable/sync-conf",this.updateConfigForm).subscribe(t=>{0===t.code&&(this.message.success(t.msg||"\u540c\u6b65\u6210\u529f",{nzDuration:1e3}),this.closeModal&&this.closeModal())})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s),e.Y36(W))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-environment-config-update"]],inputs:{closeModal:"closeModal"},decls:22,vars:11,consts:[[1,"update-config-drawer"],[1,"drawer-list-header"],["nz-row","","nzJustify","start","nzAligh","top",1,"mb-[20px]"],["nz-col",""],[1,"label","table-label","w-[82px]"],[1,"required-symbol"],["nz-col","",1,"",2,"width","100%"],[1,"drawer-list-content"],[1,"drawer-table",3,"nzTbody","nzThead","nzData","nzNoScroll","nzScrollY","nzDataChange"],["class","ant-form-item-with-help",4,"ngIf"],["nz-row","","nzJustify","start","nzAligh","top"],[1,"drawer-list-content",2,"padding-bottom","0px"],[1,"drawer-table",3,"nzTbody","nzThead","nzData","nzNoScroll","nzDataChange"],[1,"ant-form-item-with-help"],[1,"ant-form-item-explain"],["role","alert",1,"ant-form-item-explain-error",2,"margin-left","var(--LAYOUT_PADDING)"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4)(5,"span",5),e._uU(6,"*"),e.qZA(),e._uU(7,"\u540c\u6b65\u96c6\u7fa4\uff1a"),e.qZA()(),e.TgZ(8,"div",6)(9,"div",7)(10,"eo-ng-apinto-table",8),e.NdJ("nzDataChange",function(d){return n.clustersList=d}),e.qZA(),e.YNc(11,He,4,0,"div",9),e.qZA()()()(),e.TgZ(12,"div",10)(13,"div",3)(14,"label",4)(15,"span",5),e._uU(16,"*"),e.qZA(),e._uU(17,"\u540c\u6b65\u914d\u7f6e\uff1a"),e.qZA()(),e.TgZ(18,"div",6)(19,"div",11)(20,"eo-ng-apinto-table",12),e.NdJ("nzDataChange",function(d){return n.updateConfigsList=d}),e.qZA(),e.YNc(21,Ve,4,0,"div",9),e.qZA()()()()),2&t&&(e.xp6(10),e.Q6J("nzTbody",n.clusterTableBody)("nzThead",n.clusterTableHeadName)("nzData",n.clustersList)("nzNoScroll",!0)("nzScrollY",120),e.xp6(1),e.Q6J("ngIf",n.startValidate&&(!n.updateConfigForm.clusters||0===n.updateConfigForm.clusters.length)),e.xp6(9),e.Q6J("nzTbody",n.configsTable2Body)("nzThead",n.configsTable2HeadName)("nzData",n.updateConfigsList)("nzNoScroll",!0),e.xp6(1),e.Q6J("ngIf",n.startValidate&&(!n.updateConfigForm.variables||0===n.updateConfigForm.variables.length)))},dependencies:[_.O5,F.t3,F.SK,O.a],encapsulation:2}),o})(),We=(()=>{class o{constructor(t,n){this.message=t,this.api=n,this.operateRecordsData={historys:[],total:0},this.operateRecordTabelHeadName=[...ue],this.operateRecordTableBody=[...pe],this.operateRecordsPage={pageNum:1,pageSize:15,total:0},this.pageSizeOptions=[15,20,50,100],this.clusterName=""}ngOnInit(){this.getOperateRecords()}ngAfterViewInit(){this.operateRecordTableBody[3].title=this.publishTypeTpl}getOperateRecords(){this.api.get("cluster/"+this.clusterName+"/variable/update-history",{pageNum:this.operateRecordsPage.pageNum,pageSize:this.operateRecordsPage.pageSize}).subscribe(t=>{0===t.code&&(this.operateRecordsData=t.data,this.operateRecordsPage.total=t.data.total)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-environment-history-change"]],inputs:{publishTypeTpl:"publishTypeTpl"},decls:2,vars:10,consts:[[1,"drawer-list-content","drawer-table","pb-[4px]",2,"margin-top","0px"],["nzTableLayout","fixed",1,"drawer-table",3,"nzTbody","nzThead","nzData","nzNoScroll","nzShowPagination","nzFrontPagination","nzTotal","nzPageIndex","nzPageSize","nzPageSizeOptions","nzDataChange","nzPageIndexChange","nzPageSizeChange"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"eo-ng-apinto-table",1),e.NdJ("nzDataChange",function(d){return n.operateRecordsData.historys=d})("nzPageIndexChange",function(d){return n.operateRecordsPage.pageNum=d})("nzPageSizeChange",function(d){return n.operateRecordsPage.pageSize=d})("nzPageIndexChange",function(){return n.getOperateRecords()})("nzPageSizeChange",function(){return n.getOperateRecords()}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("nzTbody",n.operateRecordTableBody)("nzThead",n.operateRecordTabelHeadName)("nzData",n.operateRecordsData.historys)("nzNoScroll",!0)("nzShowPagination",!0)("nzFrontPagination",!1)("nzTotal",n.operateRecordsPage.total)("nzPageIndex",n.operateRecordsPage.pageNum)("nzPageSize",n.operateRecordsPage.pageSize)("nzPageSizeOptions",n.pageSizeOptions))},dependencies:[O.a],encapsulation:2}),o})();var ae=b(269);let ke=(()=>{class o{constructor(){this.expand=!1,this.spaceMode=!1,this.expandChange=new e.vpe}onHostClick(){this.spaceMode||(this.expand=!this.expand,this.expandChange.emit(this.expand))}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=e.lG2({type:o,selectors:[["","eo-ng-row-expand-button",""]],hostAttrs:[1,"ant-table-row-expand-icon"],hostVars:7,hostBindings:function(t,n){1&t&&e.NdJ("click",function(){return n.onHostClick()}),2&t&&(e.Ikx("type","button"),e.ekj("ant-table-row-expand-icon-expanded",!n.spaceMode&&n.expand)("ant-table-row-expand-icon-collapsed",!n.spaceMode&&!n.expand)("ant-table-row-expand-icon-spaced",n.spaceMode))},inputs:{expand:"expand",spaceMode:"spaceMode"},outputs:{expandChange:"expandChange"}}),o})();const je=["showInnerTableBtnTpl"];function Ke(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"tr"),e._UZ(1,"td",5),e.TgZ(2,"td",6)(3,"div",7)(4,"eo-ng-apinto-table",8),e.NdJ("nzDataChange",function(u){e.CHM(t);const d=e.oxw().item;return e.KtG(d.data.details=u)}),e.qZA()()()()}if(2&o){const t=e.oxw().item,n=e.oxw();e.xp6(4),e.Q6J("nzTbody",n.publishRecordDetailsTableBody)("nzThead",n.publishRecordDetailsTabelHeadName)("nzData",t.data.details)("nzScrollY",9999)}}function $e(o,s){1&o&&e.YNc(0,Ke,5,4,"tr",4),2&o&&e.Q6J("ngIf",s.item.data.isExpand)}function Xe(o,s){1&o&&e._UZ(0,"button",9),2&o&&e.Q6J("expand",s.item.isExpand)}let et=(()=>{class o{constructor(t,n){this.message=t,this.api=n,this.publishRecordsData={historys:[],total:0},this.publishRecordTabelHeadName=[...ce],this.publishRecordTableBody=[...de],this.publishRecordDetailsTabelHeadName=[...ue],this.publishRecordDetailsTableBody=[...pe],this.pageSizeOptions=[15,20,50,100],this.publishRecordsPage={pageNum:1,pageSize:15,total:0},this.clusterName="",this.publishRTableClick=u=>{u.data.isExpand=!u.data.isExpand}}ngOnInit(){this.getPublishRecords()}ngAfterViewInit(){this.publishRecordTableBody[0].title=this.showInnerTableBtnTpl,this.publishRecordDetailsTableBody[3].title=this.publishTypeTpl}getPublishRecords(){this.api.get("cluster/"+this.clusterName+"/variable/publish-history",{pageNum:this.publishRecordsPage.pageNum,pageSize:this.publishRecordsPage.pageSize}).subscribe(t=>{if(0===t.code){this.publishRecordsData=t.data;for(const n of t.data.historys)n.isExpand=!1;this.publishRecordsPage.total=t.data.total}})}expandChange(){this.publishRecordsData.historys=[...this.publishRecordsData.historys]}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-environment-history-publish"]],viewQuery:function(t,n){if(1&t&&e.Gf(je,7,e.Rgc),2&t){let u;e.iGM(u=e.CRH())&&(n.showInnerTableBtnTpl=u.first)}},inputs:{publishTypeTpl:"publishTypeTpl"},decls:6,vars:12,consts:[[1,"drawer-list-content","drawer-table",2,"margin-top","0px"],[1,"drawer-table",3,"nzTbody","nzThead","nzData","nzTrBottomTmp","nzTrClick","nzNoScroll","nzShowPagination","nzFrontPagination","nzTotal","nzPageIndex","nzPageSize","nzPageSizeOptions","nzDataChange","nzPageIndexChange","nzPageSizeChange"],["nzTrBottomTmp",""],["showInnerTableBtnTpl",""],[4,"ngIf"],[2,"border-right","none","background-color","#e8e8e8"],["colspan","3",2,"background-color","pink","border","none","padding","0","margin-top","-2px"],[2,"width","100%"],["nzTableLayout","fixed",1,"floatR","innerTable",3,"nzTbody","nzThead","nzData","nzScrollY","nzDataChange"],["eo-ng-row-expand-button","",3,"expand"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"eo-ng-apinto-table",1),e.NdJ("nzDataChange",function(d){return n.publishRecordsData.historys=d})("nzPageIndexChange",function(d){return n.publishRecordsPage.pageNum=d})("nzPageSizeChange",function(d){return n.publishRecordsPage.pageSize=d})("nzPageIndexChange",function(){return n.getPublishRecords()})("nzPageSizeChange",function(){return n.getPublishRecords()}),e.qZA()(),e.YNc(2,$e,1,1,"ng-template",null,2,e.W1O),e.YNc(4,Xe,1,1,"ng-template",null,3,e.W1O)),2&t){const u=e.MAs(3);e.xp6(1),e.Q6J("nzTbody",n.publishRecordTableBody)("nzThead",n.publishRecordTabelHeadName)("nzData",n.publishRecordsData.historys)("nzTrBottomTmp",u)("nzTrClick",n.publishRTableClick)("nzNoScroll",!0)("nzShowPagination",!0)("nzFrontPagination",!1)("nzTotal",n.publishRecordsPage.total)("nzPageIndex",n.publishRecordsPage.pageNum)("nzPageSize",n.publishRecordsPage.pageSize)("nzPageSizeOptions",n.pageSizeOptions)}},dependencies:[_.O5,ae.Uo,ae.$Z,ke,O.a],encapsulation:2}),o})();function tt(o,s){if(1&o&&(e.TgZ(0,"div",12),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.unpublishMsg," ")}}let nt=(()=>{class o{constructor(t,n,u){this.message=t,this.api=n,this.fb=u,this.autoTips=z.Sm,this.validatePublishForm=new h.cw({}),this.clusterName="",this.unpublishMsg="",this.nzDisabled=!1,this.publishSource="",this.publishData={source:"",variables:[],isPublish:!1,versionName:""},this.publishTabelHeadName=[...Te],this.publishTableBody=[...ve],this.closeModal=d=>{},this.validatePublishForm=this.fb.group({versionName:["",[h.kI.required]],desc:[""]})}ngOnInit(){this.getPublishData()}ngAfterViewInit(){this.publishTableBody[3].title=this.publishTypeTpl}disabledEdit(t){this.nzDisabled=t}getPublishData(){this.api.get("cluster/"+this.clusterName+"/variable/to-publishs").subscribe(t=>{0===t.code&&(this.publishData=t.data,this.publishData.variables=this.publishData.variables||[],this.validatePublishForm.controls.versionName.setValue(t.data.versionName),this.publishSource=t.data.source,this.unpublishMsg=t.data.unpublishMsg,!this.publishData.isPublish&&!this.unpublishMsg&&(this.unpublishMsg=0===this.publishData.variables.length?"\u65e0\u73af\u5883\u53d8\u91cf\u53ef\u53d1\u5e03":"\u5f53\u524d\u73af\u5883\u53d8\u91cf\u4e0d\u53ef\u53d1\u5e03"))})}save(t){return"publish"===t&&(this.validatePublishForm.valid&&this.publishData.isPublish?(this.api.post("cluster/"+this.clusterName+"/variable/publish",{versionName:this.validatePublishForm.value.versionName,desc:this.validatePublishForm.value.desc,source:this.publishSource}).subscribe(n=>0===n.code&&(this.message.success(n.msg||"\u53d1\u5e03\u6210\u529f",{nzDuration:1e3}),this.closeModal(!0),!0)),!1):(Object.values(this.validatePublishForm.controls).forEach(n=>{n.invalid&&(n.markAsDirty(),n.updateValueAndValidity({onlySelf:!0}))}),!1))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s),e.Y36(h.QS))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-environment-publish"]],inputs:{publishTypeTpl:"publishTypeTpl"},decls:23,vars:9,consts:[["nz-form","",3,"nzNoColon","nzAutoTips","formGroup"],[1,"drawer-list-header"],[1,"label",2,"width","100px"],[1,"required-symbol"],["eo-ng-input","","eoNgUserAccess","deploy/cluster","formControlName","versionName","placeholder","\u8bf7\u8f93\u5165",1,"w-INPUT_NORMAL"],["rows","8","eo-ng-input","","eoNgUserAccess","deploy/cluster","formControlName","desc","placeholder","\u8bf7\u8f93\u5165",1,"w-INPUT_NORMAL"],[1,"mb-0"],[1,"label","table-label",2,"width","100px"],[3,"nzValidateStatus","nzErrorTip"],[2,"width","100%"],[1,"drawer-table",3,"nzTbody","nzThead","nzData","nzNoScroll","nzDataChange"],["unpublishMsgTpl",""],[1,"drawer-list-footer"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div")(1,"form",0)(2,"div",1)(3,"nz-form-item")(4,"label",2)(5,"span",3),e._uU(6,"*"),e.qZA(),e._uU(7,"\u53d1\u5e03\u540d\u79f0\uff1a"),e.qZA(),e.TgZ(8,"nz-form-control"),e._UZ(9,"input",4),e.qZA()(),e.TgZ(10,"nz-form-item")(11,"label",2),e._uU(12,"\u63cf\u8ff0\uff1a"),e.qZA(),e.TgZ(13,"nz-form-control"),e._UZ(14,"textarea",5),e.qZA()()(),e.TgZ(15,"nz-form-item",6)(16,"label",7),e._uU(17,"\u73af\u5883\u53d8\u91cf\u5217\u8868\uff1a"),e.qZA(),e.TgZ(18,"nz-form-control",8)(19,"div",9)(20,"eo-ng-apinto-table",10),e.NdJ("nzDataChange",function(d){return n.publishData.variables=d}),e.qZA()(),e.YNc(21,tt,2,1,"ng-template",null,11,e.W1O),e.qZA()()()()),2&t){const u=e.MAs(22);e.xp6(1),e.Q6J("nzNoColon",!0)("nzAutoTips",n.autoTips)("formGroup",n.validatePublishForm),e.xp6(17),e.Q6J("nzValidateStatus",n.publishData.isPublish?"":"error")("nzErrorTip",u),e.xp6(2),e.Q6J("nzTbody",n.publishTableBody)("nzThead",n.publishTabelHeadName)("nzData",n.publishData.variables)("nzNoScroll",!0)}},dependencies:[h._Y,h.Fj,h.JJ,h.JL,E.oO,F.t3,F.SK,f.Lr,f.Nx,f.Fd,h.sg,h.u,y.g,O.a],encapsulation:2}),o})();var re=b(9041);const it=["operatorStatusTpl"],ot=["publishStatusTpl"],at=["publishTypeTpl"];function rt(o,s){1&o&&(e.TgZ(0,"span",21),e._uU(1,"\u65b0"),e.qZA())}function st(o,s){1&o&&(e.TgZ(0,"span",22),e._uU(1,"\u6539"),e.qZA())}function lt(o,s){1&o&&(e.TgZ(0,"span",23),e._uU(1,"\u5220"),e.qZA())}function ut(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",12)(1,"span",13),e._uU(2),e.qZA(),e.ynx(3,14),e.YNc(4,rt,2,0,"span",15),e.YNc(5,st,2,0,"span",16),e.YNc(6,lt,2,0,"span",17),e.BQk(),e.TgZ(7,"span",18),e.NdJ("copyCallback",function(){e.CHM(t);const u=e.oxw();return e.KtG(u.copyCallback())})("click",function(u){return u.stopPropagation()}),e.O4$(),e.TgZ(8,"svg",19),e._UZ(9,"use",20),e.qZA()()()}if(2&o){const t=s.item;e.xp6(1),e.Q6J("nzTooltipTitle",t.key)("nzTooltipVisible",!1),e.xp6(1),e.hij(" ",t.key,""),e.xp6(1),e.Q6J("ngSwitch",t.publish),e.xp6(1),e.Q6J("ngSwitchCase","NEW"),e.xp6(1),e.Q6J("ngSwitchCase","MODIFY"),e.xp6(1),e.Q6J("ngSwitchCase","DELETE"),e.xp6(1),e.Q6J("copyText",t.key)}}function pt(o,s){1&o&&(e.TgZ(0,"span",27),e._uU(1,"\u672a\u53d1\u5e03"),e.qZA())}function ct(o,s){1&o&&(e.TgZ(0,"span",28),e._uU(1,"\u5df2\u53d1\u5e03"),e.qZA())}function dt(o,s){1&o&&(e.TgZ(0,"span",29),e._uU(1,"\u7f3a\u5931"),e.qZA())}function ht(o,s){1&o&&(e.ynx(0,14),e.YNc(1,pt,2,0,"span",24),e.YNc(2,ct,2,0,"span",25),e.YNc(3,dt,2,0,"span",26),e.BQk()),2&o&&(e.Q6J("ngSwitch",s.item.publish),e.xp6(1),e.Q6J("ngSwitchCase","UNPUBLISHED"),e.xp6(1),e.Q6J("ngSwitchCase","PUBLISHED"),e.xp6(1),e.Q6J("ngSwitchCase","DEFECT"))}function mt(o,s){1&o&&(e.TgZ(0,"span",28),e._uU(1,"\u65b0\u589e"),e.qZA())}function gt(o,s){1&o&&(e.TgZ(0,"span",29),e._uU(1,"\u66f4\u65b0"),e.qZA())}function ft(o,s){1&o&&(e.TgZ(0,"span",31),e._uU(1,"\u7f3a\u5931"),e.qZA())}function bt(o,s){1&o&&(e.ynx(0,14),e.YNc(1,mt,2,0,"span",25),e.YNc(2,gt,2,0,"span",26),e.YNc(3,ft,2,0,"span",30),e.BQk()),2&o&&(e.Q6J("ngSwitch",s.item.optType),e.xp6(1),e.Q6J("ngSwitchCase","NEW"),e.xp6(1),e.Q6J("ngSwitchCase","MODIFY"),e.xp6(1),e.Q6J("ngSwitchCase","DELETE"))}let _t=(()=>{class o{constructor(t,n,u,d,S,L,Y){this.baseInfo=t,this.message=n,this.modalService=u,this.api=d,this.router=S,this.navigationService=L,this.service=Y,this.clusterName="",this.nowUrl=this.router.routerState.snapshot.url,this.configsList=[],this.nzDisabled=!1,this.configsTableHeadName=[...he],this.configsTableBody=[...this.service.createClusterEnvConfigTbody(this)],this.autoTips=z.Sm,this.configTableClick=j=>{this.openDrawer("editConfig",j.data)},this.closeModal=j=>{j&&this.getConfigsList(),this.drawerRef?.close()},this.navigationService.reqFlashBreadcrumb([{title:"\u7f51\u5173\u96c6\u7fa4",routerLink:"deploy/cluster"},{title:"\u5168\u5c40\u53d8\u91cf"}])}ngOnInit(){this.clusterName=this.baseInfo.allParamsInfo.clusterName,this.clusterName||this.router.navigate(["/"]),this.getConfigsList()}ngAfterViewInit(){this.configsTableBody[0].title=this.operatorStatusTpl,this.configsTableBody[3].title=this.publishStatusTpl}getConfigsList(){this.api.get("cluster/"+this.clusterName+"/variables").subscribe(t=>{0===t.code&&(this.configsList=t.data.variables)})}disabledEdit(t){this.nzDisabled=t}delete(t,n){n?.stopPropagation(),this.modalService.create({nzTitle:"\u5220\u9664",nzContent:"\u8be5\u6570\u636e\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u627e\u56de\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\uff1f",nzClosable:!0,nzClassName:"delete-modal",nzWidth:v.G_,nzOkDanger:!0,nzOnOk:()=>{this.deleteConfig(t)}})}deleteConfig(t){this.api.delete("cluster/"+this.clusterName+"/variable",{key:t.key}).subscribe(n=>{0===n.code&&(this.message.success(n.msg||"\u5220\u9664\u6210\u529f",{nzDuration:1e3}),this.getConfigsList())})}openDrawer(t,n,u){switch(u?.stopPropagation(),t){case"addConfig":this.drawerRef=this.modalService.create({nzTitle:"\u65b0\u5efa\u914d\u7f6e",nzWidth:v.G_,nzContent:Se,nzComponentParams:{clusterName:this.clusterName,closeModal:this.closeModal},nzOkText:"\u4fdd\u5b58",nzOnOk:d=>(d.save(),!1)});break;case"editConfig":this.drawerRef=this.modalService.create({nzTitle:"\u7f16\u8f91\u914d\u7f6e",nzWidth:v.G_,nzContent:Se,nzComponentParams:{clusterName:this.clusterName,editData:n,closeModal:this.closeModal},nzOkDisabled:this.nzDisabled,nzOkText:"\u63d0\u4ea4",nzOnOk:d=>(d.save(),!1)});break;case"updateConfig":this.drawerRef=this.modalService.create({nzTitle:"\u540c\u6b65\u914d\u7f6e",nzWidth:v.iE,nzContent:Ge,nzComponentParams:{clusterName:this.clusterName,closeModal:this.closeModal},nzOkDisabled:this.nzDisabled,nzOkText:"\u63d0\u4ea4",nzOnOk:d=>(d.save(),!1)});break;case"operateRecords":this.drawerRef=this.modalService.create({nzTitle:"\u66f4\u6539\u5386\u53f2",nzWidth:v.iE,nzContent:We,nzComponentParams:{publishTypeTpl:this.publishTypeTpl,clusterName:this.clusterName},nzFooter:null});break;case"publishRecords":this.drawerRef=this.modalService.create({nzTitle:"\u53d1\u5e03\u5386\u53f2",nzWidth:v.iE,nzContent:et,nzComponentParams:{clusterName:this.clusterName,publishTypeTpl:this.publishTypeTpl},nzFooter:null});break;case"publish":this.drawerRef=this.modalService.create({nzTitle:"\u53d1\u5e03",nzWidth:v.iE,nzContent:nt,nzComponentParams:{clusterName:this.clusterName,publishTypeTpl:this.publishTypeTpl,closeModal:this.closeModal},nzOkDisabled:this.nzDisabled,nzOkText:"\u63d0\u4ea4",nzOnOk:d=>(d.save(t),!1)})}}copyCallback(){this.message.success("\u590d\u5236\u6210\u529f",{nzDuration:1e3})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(Z.D),e.Y36(p.VY),e.Y36(p._B),e.Y36(T.s),e.Y36(N.F0),e.Y36(C.a),e.Y36(W))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-environment"]],viewQuery:function(t,n){if(1&t&&(e.Gf(it,7,e.Rgc),e.Gf(ot,7,e.Rgc),e.Gf(at,7,e.Rgc)),2&t){let u;e.iGM(u=e.CRH())&&(n.operatorStatusTpl=u.first),e.iGM(u=e.CRH())&&(n.publishStatusTpl=u.first),e.iGM(u=e.CRH())&&(n.publishTypeTpl=u.first)}},decls:22,vars:5,consts:[[1,""],[1,"list-header","pl-btnbase","pr-btnrbase","py-btnybase","flex","flex-nowrap","items-center","justify-between"],["eo-ng-button","","eoNgUserAccess","deploy/cluster",1,"ant-btn-primary",3,"disabledEdit","click"],["eo-ng-button","","eoNgUserAccess","deploy/cluster",1,"ml-btnybase","ant-btn-primary",3,"click"],["eo-ng-button","","eoNgUserAccess","deploy/cluster",1,"ml-btnybase",3,"click"],["eo-ng-button","",1,"ml-btnybase","floatR",3,"click"],["eo-ng-button","",1,"floatR",3,"click"],[1,"list-content"],[1,"",3,"nzTbody","nzThead","nzData","nzTrClick","nzMaxOperatorButton","nzDataChange"],["operatorStatusTpl",""],["publishStatusTpl",""],["publishTypeTpl",""],[1,"leading-[22px]","flex","items-center"],["eoNgFeedbackTooltip","","nzTooltipPlacement","top","nzTooltipTrigger","hover",3,"nzTooltipTitle","nzTooltipVisible"],[3,"ngSwitch"],["class","status-new-icon",4,"ngSwitchCase"],["class","status-change-icon",4,"ngSwitchCase"],["class","status-delete-icon",4,"ngSwitchCase"],["eo-copy","","nzType","primary",1,"h-[20px]","leading-[22px]","text-[12px]","opacity-0","cursor-pointer","inline-flex","items-center",3,"copyText","copyCallback","click"],[1,"iconpark-icon"],["href","#copy"],[1,"status-new-icon"],[1,"status-change-icon"],[1,"status-delete-icon"],["class","red-bold",4,"ngSwitchCase"],["class","green-bold",4,"ngSwitchCase"],["style","font-weight: bold",4,"ngSwitchCase"],[1,"red-bold"],[1,"green-bold"],[2,"font-weight","bold"],["class","grey-bold",4,"ngSwitchCase"],[1,"grey-bold"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),e.NdJ("disabledEdit",function(d){return n.disabledEdit(d)})("click",function(){return n.openDrawer("addConfig")}),e._uU(4," \u65b0\u5efa\u914d\u7f6e "),e.qZA(),e.TgZ(5,"button",3),e.NdJ("click",function(){return n.openDrawer("publish")}),e._uU(6," \u53d1\u5e03 "),e.qZA(),e.TgZ(7,"button",4),e.NdJ("click",function(){return n.openDrawer("updateConfig")}),e._uU(8," \u540c\u6b65\u914d\u7f6e "),e.qZA()(),e.TgZ(9,"div")(10,"button",5),e.NdJ("click",function(){return n.openDrawer("publishRecords")}),e._uU(11," \u53d1\u5e03\u5386\u53f2 "),e.qZA(),e.TgZ(12,"button",6),e.NdJ("click",function(){return n.openDrawer("operateRecords")}),e._uU(13," \u66f4\u6539\u5386\u53f2 "),e.qZA()()(),e.TgZ(14,"div",7)(15,"eo-ng-apinto-table",8),e.NdJ("nzDataChange",function(d){return n.configsList=d}),e.qZA()()(),e.YNc(16,ut,10,8,"ng-template",null,9,e.W1O),e.YNc(18,ht,4,4,"ng-template",null,10,e.W1O),e.YNc(20,bt,4,4,"ng-template",null,11,e.W1O)),2&t&&(e.xp6(15),e.Q6J("nzTbody",n.configsTableBody)("nzThead",n.configsTableHeadName)("nzData",n.configsList)("nzTrClick",n.configTableClick)("nzMaxOperatorButton",2))},dependencies:[_.RF,_.n9,p.Cl,M.qK,y.g,O.a,re.jw],styles:["label[_ngcontent-%COMP%]{line-height:32px}.ant-col-4[_ngcontent-%COMP%]{text-align:right}"]}),o})();const Ct=["clusterStatusTpl"],yt=["clusterNameInput"];function Tt(o,s){1&o&&e._uU(0),2&o&&e.hij("and ",s.$implicit.length," more selected")}function vt(o,s){1&o&&(e.TgZ(0,"span",12),e._uU(1,"\u5f02\u5e38"),e.qZA())}function zt(o,s){1&o&&(e.TgZ(0,"span",13),e._uU(1,"\u6b63\u5e38"),e.qZA())}function Dt(o,s){1&o&&(e.TgZ(0,"span",14),e._uU(1,"\u90e8\u5206\u6b63\u5e38"),e.qZA())}function Ft(o,s){1&o&&(e.ynx(0,8),e.YNc(1,vt,2,0,"span",9),e.YNc(2,zt,2,0,"span",10),e.YNc(3,Dt,2,0,"span",11),e.BQk()),2&o&&(e.Q6J("ngSwitch",s.item.status),e.xp6(1),e.Q6J("ngSwitchCase","ABNORMAL"),e.xp6(1),e.Q6J("ngSwitchCase","NORMAL"),e.xp6(1),e.Q6J("ngSwitchCase","PARTIALLY_NORMAL"))}let At=(()=>{class o{constructor(t,n,u,d,S,L){this.message=t,this.modalService=n,this.api=u,this.router=d,this.navigationService=S,this.service=L,this.nowUrl=this.router.routerState.snapshot.url,this.nzDisabled=!1,this.validateForm=new h.cw({}),this.source="",this.clustersList=[],this.clustersDisplayList=[],this.clustersTableHeadName=[...me],this.clustersTableBody=[],this.environmentList=[],this.autoTips=z.Sm,this.nodesTableShow=!1,this.clusterCanBeCreated=!1,this.env=[],this.clusterTableClick=Y=>{this.router.navigate(["/","deploy","cluster","content",Y.data.name]),this.service.clusterName=Y.data.title,this.service.clusterDesc=Y.data.desc},this.navigationService.reqFlashBreadcrumb([{title:"\u7f51\u5173\u96c6\u7fa4",routerLink:"deploy/cluster"}])}ngOnInit(){this.getClustersData(),this.getEnvList()}ngAfterViewInit(){this.clustersTableBody=[...this.service.createClusterTbody(this)]}getClustersData(){this.api.get("clusters").subscribe(t=>{0===t.code&&(this.clustersList=t.data.clusters,this.clustersDisplayList=[...this.clustersList])})}getEnvList(){this.api.get("cluster/enum").subscribe(t=>{0===t.code&&(this.environmentList=t.data.envs.map(n=>({label:n.name,value:n.name})))})}disabledEdit(t){this.nzDisabled=t}delete(t){this.modalService.create({nzTitle:"\u5220\u9664",nzContent:"\u8be5\u6570\u636e\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u627e\u56de\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\uff1f",nzClosable:!0,nzClassName:"delete-modal",nzWidth:v.G_,nzOkDanger:!0,nzOnOk:()=>{this.deleteCluster(t)}})}deleteCluster(t){this.api.delete("cluster",{clusterName:t.name}).subscribe(n=>{0===n.code&&(this.message.success(n.msg||"\u5220\u9664\u6210\u529f",{nzDuration:1e3}),this.getClustersData())})}addCluster(){this.modalRef=this.modalService.create({nzTitle:"\u65b0\u5efa\u96c6\u7fa4",nzWidth:v.G_,nzContent:xe,nzComponentParams:{closeModal:()=>{this.modalRef?.close()}},nzFooter:[{label:"\u53d6\u6d88",type:"default",onClick:()=>{this.modalRef?.close()}},{label:"\u4e0b\u4e00\u6b65\uff0c\u68c0\u67e5\u96c6\u7fa4",type:"primary",onClick:t=>{t.testCluster()},disabled:()=>this.nzDisabled,show:t=>!t.nodesTableShow&&!t.checkClusterError,loading:t=>t.testButtonLoading},{label:"\u91cd\u65b0\u68c0\u67e5",type:"primary",onClick:t=>{t.testCluster()},disabled:()=>this.nzDisabled,show:t=>!t.nodesTableShow&&t.checkClusterError,loading:t=>t.testButtonLoading},{label:"\u4e0a\u4e00\u6b65",type:"default",onClick:t=>{t.cancel()},show:t=>t.nodesTableShow},{label:"\u5b8c\u6210",type:"primary",onClick:t=>{t.saveCluster()},disabled:()=>this.nzDisabled,show:t=>t.nodesTableShow,loading:t=>t.submitButtonLoading}]})}handleEnvChange(){this.clustersDisplayList=this.clustersList.filter(t=>-1!==this.env.indexOf(t.env))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(p._B),e.Y36(T.s),e.Y36(N.F0),e.Y36(C.a),e.Y36(W))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-list"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Ct,7,e.Rgc),e.Gf(yt,5)),2&t){let u;e.iGM(u=e.CRH())&&(n.clusterStatusTpl=u.first),e.iGM(u=e.CRH())&&(n.clusterNameInput=u.first)}},decls:11,vars:11,consts:[[1,""],[1,"list-header","pl-btnbase","pr-btnrbase","py-btnybase","flex","flex-nowrap","items-center","justify-between"],["eo-ng-button","","eoNgUserAccess","deploy/cluster",1,"ant-btn-primary",3,"disabledEdit","click"],["nzMode","multiple","nzPlaceHolder","\u6240\u6709\u73af\u5883","nzAllowClear","",1,"w-INPUT_NORMAL",3,"nzMaxTagCount","nzMaxTagPlaceholder","nzShowCheckAll","nzDisabled","ngModel","nzOptions","ngModelChange","nzOpenChange"],["tagPlaceHolder",""],[1,"list-content"],[1,"",3,"nzTbody","nzThead","nzData","nzTrClick","nzMaxOperatorButton"],["clusterStatusTpl",""],[3,"ngSwitch"],["class","red-bold",4,"ngSwitchCase"],["class","green-bold",4,"ngSwitchCase"],["class","orange-bold",4,"ngSwitchCase"],[1,"red-bold"],[1,"green-bold"],[1,"orange-bold"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("disabledEdit",function(d){return n.disabledEdit(d)})("click",function(){return n.addCluster()}),e._uU(3," \u65b0\u5efa\u96c6\u7fa4 "),e.qZA(),e.TgZ(4,"eo-ng-select",3),e.NdJ("ngModelChange",function(d){return n.env=d})("nzOpenChange",function(d){return d?null:n.handleEnvChange()}),e.qZA(),e.YNc(5,Tt,1,1,"ng-template",null,4,e.W1O),e.qZA(),e.TgZ(7,"div",5),e._UZ(8,"eo-ng-apinto-table",6),e.qZA()(),e.YNc(9,Ft,4,4,"ng-template",null,7,e.W1O)),2&t){const u=e.MAs(6);e.xp6(4),e.Q6J("nzMaxTagCount",3)("nzMaxTagPlaceholder",u)("nzShowCheckAll",!0)("nzDisabled",n.nzDisabled)("ngModel",n.env)("nzOptions",n.environmentList),e.xp6(4),e.Q6J("nzTbody",n.clustersTableBody)("nzThead",n.clustersTableHeadName)("nzData",n.clustersDisplayList)("nzTrClick",n.clusterTableClick)("nzMaxOperatorButton",2)}},dependencies:[_.RF,_.n9,m.Hf,h.JJ,h.On,M.qK,y.g,O.a],encapsulation:2}),o})();function Nt(o,s){1&o&&(e.ynx(0),e._uU(1,"\u8bf7\u8f93\u5165\u96c6\u7fa4\u5730\u5740"),e.BQk())}function Et(o,s){1&o&&(e.ynx(0),e._uU(1,"\u96c6\u7fa4\u5730\u5740\u8f93\u5165\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"),e.BQk())}function wt(o,s){1&o&&(e.ynx(0),e._uU(1,"\u96c6\u7fa4\u5730\u5740\u9700\u8981\u901a\u8fc7\u6d4b\u8bd5"),e.BQk())}function xt(o,s){if(1&o&&(e.YNc(0,Nt,2,0,"ng-container",9),e.YNc(1,Et,2,0,"ng-container",9),e.YNc(2,wt,2,0,"ng-container",9)),2&o){const t=s.$implicit;e.Q6J("ngIf",t.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.hasError("pattern")),e.xp6(1),e.Q6J("ngIf",t.hasError("source"))}}function St(o,s){if(1&o&&(e.TgZ(0,"nz-form-item",10),e._UZ(1,"label",11),e.TgZ(2,"nz-form-control")(3,"div",12),e._UZ(4,"eo-ng-apinto-table",13),e.qZA()()()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("nzTbody",t.nodesTableBody)("nzThead",t.nodesTableHeadName2)("nzData",t.nodesTestList)("nzNoScroll",!0)}}let kt=(()=>{class o{constructor(t,n,u){this.message=t,this.api=n,this.fb=u,this.nodesTableBody=[],this.autoTips=z.Sm,this.validateResetNodeForm=new h.cw({}),this.clusterName="",this.testFlag=!1,this.testPassAddr="",this.nodesTestTableShow=!1,this.clusterCanBeCreated=!1,this.nodesTestList=[],this.source="",this.nodesTableHeadName2=[...$],this.clusterAddrVadidator=d=>d.value?!this.testFlag||/(\w+):\/\/([a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?)(:\d*)/.test(d.value)||/(\w+):\/\/(((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3})(:\d*)/.test(d.value)?this.testFlag&&d.value!==this.testPassAddr?{source:!0,error:!0}:{}:{error:!0,pattern:!0}:{error:!0,required:!0},this.closeModal=()=>{},this.validateResetNodeForm=this.fb.group({clusterAddr:["",[this.clusterAddrVadidator]]})}ngOnInit(){}testCluster(){this.validateResetNodeForm.controls.clusterAddr.value&&(/(\w+):\/\/([a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?)(:\d+)/.test(this.validateResetNodeForm.controls.clusterAddr.value)||/(\w+):\/\/(((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3})(:\d*)/.test(this.validateResetNodeForm.controls.clusterAddr.value))?(this.testFlag=!0,this.api.get("cluster-test",{clusterAddr:this.validateResetNodeForm.controls.clusterAddr.value}).subscribe(t=>{0===t.code?(this.nodesTestList=t.data.nodes,this.source=t.data.source,this.clusterCanBeCreated=t.data.isUpdate,this.nodesTestList.length>0&&(this.nodesTestTableShow=!0),this.clusterCanBeCreated&&(this.testPassAddr=this.validateResetNodeForm.controls.clusterAddr.value),this.validateResetNodeForm.controls.clusterAddr.updateValueAndValidity({onlySelf:!0})):(this.validateResetNodeForm.controls.clusterAddr.markAsDirty(),this.validateResetNodeForm.controls.clusterAddr.updateValueAndValidity({onlySelf:!0}))})):(this.validateResetNodeForm.controls.clusterAddr.markAsDirty(),this.validateResetNodeForm.controls.clusterAddr.updateValueAndValidity())}save(){return this.testFlag=!0,this.validateResetNodeForm.controls.clusterAddr.updateValueAndValidity(),this.validateResetNodeForm.controls.clusterAddr.valid&&this.source?(this.api.post("cluster/"+this.clusterName+"/node/reset",{source:this.source||"",clusterAddr:this.validateResetNodeForm.controls.clusterAddr.value||""}).subscribe(t=>0===t.code&&(this.closeModal(),this.message.success(t.msg||"\u91cd\u7f6e\u6210\u529f!",{nzDuration:1e3}),!0)),!1):(Object.values(this.validateResetNodeForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))}),!1)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s),e.Y36(h.QS))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-nodes-form"]],inputs:{nodeStatusTpl:"nodeStatusTpl",serviceAddrTpl:"serviceAddrTpl",adminAddrTpl:"adminAddrTpl",nodesTableBody:"nodesTableBody"},decls:12,vars:5,consts:[["nz-form","",3,"nzNoColon","nzAutoTips","formGroup"],[1,"mb-0"],[1,"label","w-[70px]"],[3,"nzErrorTip"],[1,"flex"],["eo-ng-input","","formControlName","clusterAddr","placeholder","\u8bf7\u8f93\u5165",1,""],["nodeErrorTpl",""],["eo-ng-button","","type","button",1,"ant-btn-primary","ml-btnybase",3,"click"],["class","mt-btnybase mb-0",4,"ngIf"],[4,"ngIf"],[1,"mt-btnybase","mb-0"],[1,"label",2,"width","64px"],[2,"width","100%"],["nzTableLayout","fixed",3,"nzTbody","nzThead","nzData","nzNoScroll"]],template:function(t,n){if(1&t&&(e.TgZ(0,"form",0)(1,"nz-form-item",1)(2,"label",2),e._uU(3,"\u96c6\u7fa4\u5730\u5740\uff1a"),e.qZA(),e.TgZ(4,"nz-form-control",3)(5,"div",4),e._UZ(6,"input",5),e.YNc(7,xt,3,3,"ng-template",null,6,e.W1O),e.TgZ(9,"button",7),e.NdJ("click",function(){return n.testCluster()}),e._uU(10," \u6d4b\u8bd5 "),e.qZA()()()(),e.YNc(11,St,5,4,"nz-form-item",8),e.qZA()),2&t){const u=e.MAs(8);e.Q6J("nzNoColon",!0)("nzAutoTips",n.autoTips)("formGroup",n.validateResetNodeForm),e.xp6(4),e.Q6J("nzErrorTip",u),e.xp6(7),e.Q6J("ngIf",n.nodesTestTableShow)}},dependencies:[_.O5,h._Y,h.Fj,h.JJ,h.JL,E.oO,M.qK,F.t3,F.SK,f.Lr,f.Nx,f.Fd,h.sg,h.u,O.a],styles:["input.ant-input[eo-ng-input][_ngcontent-%COMP%]{width:494px!important}"]}),o})();function Pt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",7),e.NdJ("copyCallback",function(){e.CHM(t);const u=e.oxw(2);return e.KtG(u.copyCallback())}),e.O4$(),e.TgZ(1,"svg",8),e._UZ(2,"use",9),e.qZA()()}if(2&o){const t=e.oxw(2);e.Q6J("copyText",t.addrItem[t.keyName])}}function Bt(o,s){if(1&o){const t=e.EpF();e.O4$(),e.TgZ(0,"svg",10),e.NdJ("click",function(){e.CHM(t);const u=e.oxw(2);return u.addrItem.expand=!0,e.KtG(u.addrItemChange.emit(u._addrItem))}),e._UZ(1,"use",11),e.qZA()}}const Zt=function(o){return{addrLong:o}},Ut=function(o){return{"w-[86%]":o}};function It(o,s){if(1&o&&(e.TgZ(0,"span",3)(1,"span")(2,"span",4),e._uU(3),e.qZA(),e.YNc(4,Pt,3,1,"button",5),e.qZA(),e.YNc(5,Bt,2,0,"svg",6),e.qZA()),2&o){const t=e.oxw(),n=e.MAs(4);e.Q6J("nzTooltipTitle",n)("nzTooltipTitleContext",e.VKq(8,Zt,t.addrItem[t.keyName]))("nzTooltipVisible",!1)("nzTooltipTrigger","hover"),e.xp6(2),e.Q6J("ngClass",e.VKq(10,Ut,t.addrItem[t.keyName].includes(","))),e.xp6(1),e.hij("",t.addrItem[t.keyName]," "),e.xp6(1),e.Q6J("ngIf",!t.addrItem[t.keyName].includes(",")),e.xp6(1),e.Q6J("ngIf",t.addrItem[t.keyName].includes(","))}}function Lt(o,s){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",16)(2,"span",17),e._uU(3),e.qZA(),e.TgZ(4,"button",18),e.NdJ("copyCallback",function(){e.CHM(t);const u=e.oxw(2);return e.KtG(u.copyCallback())}),e.O4$(),e.TgZ(5,"svg",8),e._UZ(6,"use",9),e.qZA()()(),e.BQk()}if(2&o){const t=s.$implicit;e.xp6(3),e.Oqu(t),e.xp6(1),e.Q6J("copyText",t)}}function Ot(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",12)(1,"div"),e.YNc(2,Lt,7,2,"ng-container",13),e.qZA(),e.O4$(),e.TgZ(3,"svg",14),e.NdJ("click",function(){e.CHM(t);const u=e.oxw();return u.addrItem.expand=!1,e.KtG(u.addrItemChange.emit(u._addrItem))}),e._UZ(4,"use",15),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.addrItem[t.keyName].split(","))}}function Rt(o,s){if(1&o&&(e.ynx(0),e.TgZ(1,"div",19)(2,"span",17),e._uU(3),e.qZA()(),e.BQk()),2&o){const t=s.$implicit;e.xp6(3),e.Oqu(t)}}function Mt(o,s){1&o&&e.YNc(0,Rt,4,1,"ng-container",13),2&o&&e.Q6J("ngForOf",s.addrLong.split(","))}let Jt=(()=>{class o{get addrItem(){return this._addrItem}set addrItem(t){this._addrItem=t,this.addrItemChange.emit(t)}constructor(t){this.message=t,this.addrItemChange=new e.vpe,this._addrItem={expand:!1},this.keyName=""}ngOnInit(){}copyCallback(){this.message.success("\u590d\u5236\u6210\u529f",{nzDuration:1e3})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-copy-addr-list"]],inputs:{addrItem:"addrItem",keyName:"keyName"},outputs:{addrItemChange:"addrItemChange"},decls:5,vars:2,consts:[["class","cluster-node-addr-btn overflow-ellipsis w-[100%] inline-block overflow-hidden align-middle","eoNgFeedbackTooltip","",3,"nzTooltipTitle","nzTooltipTitleContext","nzTooltipVisible","nzTooltipTrigger",4,"ngIf","ngIfElse"],["expandTpl",""],["tooltipTpl",""],["eoNgFeedbackTooltip","",1,"cluster-node-addr-btn","overflow-ellipsis","w-[100%]","inline-block","overflow-hidden","align-middle",3,"nzTooltipTitle","nzTooltipTitleContext","nzTooltipVisible","nzTooltipTrigger"],[1,"overflow-ellipsis","inline-block","overflow-hidden","align-middle",3,"ngClass"],["eo-copy","","eo-ng-button","","nzType","primary","nzGhost","","class","deploy-node-copy-btn ant-btn-text border-transparent h-[22px]",3,"copyText","copyCallback",4,"ngIf"],["class","iconpark-icon ml-[8px]",3,"click",4,"ngIf"],["eo-copy","","eo-ng-button","","nzType","primary","nzGhost","",1,"deploy-node-copy-btn","ant-btn-text","border-transparent","h-[22px]",3,"copyText","copyCallback"],[1,"iconpark-icon"],["href","#copy"],[1,"iconpark-icon","ml-[8px]",3,"click"],["href","#down"],[1,"flex","flex-nowrap","items-center","justify-between"],[4,"ngFor","ngForOf"],[1,"iconpark-icon",3,"click"],["href","#up"],[1,"block","w-[100%]"],[1,"leading-[22px]"],["eo-copy","","eo-ng-button","","nzType","primary","nzGhost","",1,"ml-[8px]","border-transparent","h-[22px]",3,"copyText","copyCallback"],[1,"flex","justify-between"]],template:function(t,n){if(1&t&&(e.YNc(0,It,6,12,"span",0),e.YNc(1,Ot,5,1,"ng-template",null,1,e.W1O),e.YNc(3,Mt,1,1,"ng-template",null,2,e.W1O)),2&t){const u=e.MAs(2);e.Q6J("ngIf",!n.addrItem.expand||!n.addrItem[n.keyName].includes(","))("ngIfElse",u)}},dependencies:[_.mk,_.sg,_.O5,M.qK,p.Cl,re.jw],encapsulation:2}),o})();const Yt=["nodeStatusTpl"],Qt=["adminAddrTpl"],qt=["serviceAddrTpl"];function Ht(o,s){1&o&&(e.TgZ(0,"span",12),e._uU(1,"\u672a\u8fd0\u884c"),e.qZA())}function Vt(o,s){1&o&&(e.TgZ(0,"span",13),e._uU(1,"\u8fd0\u884c\u4e2d"),e.qZA())}function Gt(o,s){1&o&&(e.ynx(0,9),e.YNc(1,Ht,2,0,"span",10),e.YNc(2,Vt,2,0,"span",11),e.BQk()),2&o&&(e.Q6J("ngSwitch",s.item.status),e.xp6(1),e.Q6J("ngSwitchCase","NOTRUNNING"),e.xp6(1),e.Q6J("ngSwitchCase","RUNNING"))}function Wt(o,s){1&o&&e._UZ(0,"eo-ng-copy-addr-list",14),2&o&&e.Q6J("addrItem",s.item)}function jt(o,s){1&o&&e._UZ(0,"eo-ng-copy-addr-list",15),2&o&&e.Q6J("addrItem",s.item)}let Kt=(()=>{class o{constructor(t,n,u,d,S,L){this.modalService=t,this.baseInfo=n,this.message=u,this.api=d,this.router=S,this.navigationService=L,this.clusterName="",this.nowUrl=this.router.routerState.snapshot.url,this.nodesForms={nodes:[],isUpdate:!1},this.nodesTableHeadName=[...$],this.nodesTableBody=[...ie],this.autoTips=z.Sm,this.nzDisabled=!1,this.validateResetNodeForm=new h.cw({}),this.closeModal=()=>{this.getNodeslist(),this.nodesDrawerRef?.close()},this.navigationService.reqFlashBreadcrumb([{title:"\u7f51\u5173\u96c6\u7fa4",routerLink:"deploy/cluster"},{title:"\u8282\u70b9\u5217\u8868"}])}ngOnInit(){this.clusterName=this.baseInfo.allParamsInfo.clusterName,this.clusterName||this.router.navigate(["/"]),this.getNodeslist()}disabledEdit(t){this.nzDisabled=t}getNodeslist(){this.api.get("cluster/"+this.clusterName+"/nodes").subscribe(t=>{0===t.code&&(this.nodesForms=t.data)})}ngAfterViewInit(){this.nodesTableBody[3].title=this.nodeStatusTpl,this.nodesTableBody[2].title=this.serviceAddrTpl,this.nodesTableBody[1].title=this.adminAddrTpl}updateNodes(){this.api.put("cluster/"+this.clusterName+"/node").subscribe(t=>{0===t.code&&(this.message.success(t.msg||"\u64cd\u4f5c\u6210\u529f\uff01",{nzDuration:1e3}),this.getNodeslist())})}openDrawer(t){"resetNodes"===t&&(this.nodesDrawerRef=this.modalService.create({nzTitle:"\u91cd\u7f6e\u914d\u7f6e",nzWidth:v.iE,nzContent:kt,nzComponentParams:{nodeStatusTpl:this.nodeStatusTpl,serviceAddrTpl:this.serviceAddrTpl,adminAddrTpl:this.adminAddrTpl,nodesTableBody:this.nodesTableBody,clusterName:this.clusterName,closeModal:this.closeModal},nzOkDisabled:this.nzDisabled,nzOkText:"\u63d0\u4ea4",nzOnOk:n=>(n.save(),!1)}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p._B),e.Y36(Z.D),e.Y36(p.VY),e.Y36(T.s),e.Y36(N.F0),e.Y36(C.a))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-nodes"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Yt,7,e.Rgc),e.Gf(Qt,7,e.Rgc),e.Gf(qt,7,e.Rgc)),2&t){let u;e.iGM(u=e.CRH())&&(n.nodeStatusTpl=u.first),e.iGM(u=e.CRH())&&(n.adminAddrTpl=u.first),e.iGM(u=e.CRH())&&(n.serviceAddrTpl=u.first)}},decls:14,vars:5,consts:[[1,""],[1,"list-header","pl-btnbase","pr-btnrbase","py-btnybase","flex","flex-nowrap","items-center","justify-between"],["type","button","eo-ng-button","",1,"ant-btn-primary",3,"disabled","click"],["type","button","eo-ng-button","","eoNgUserAccess","deploy/cluster",1,"ml-btnybase",3,"click","disabledEdit"],[1,"list-content"],["nzTableLayout","fixed",1,"",3,"nzTbody","nzThead","nzData","nzNoScroll"],["nodeStatusTpl",""],["adminAddrTpl",""],["serviceAddrTpl",""],[3,"ngSwitch"],["class","red-bold",4,"ngSwitchCase"],["class","green-bold",4,"ngSwitchCase"],[1,"red-bold"],[1,"green-bold"],["keyName","adminAddr",3,"addrItem"],["keyName","serviceAddr",3,"addrItem"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(){return n.updateNodes()}),e._uU(3," \u66f4\u65b0\u914d\u7f6e "),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return n.openDrawer("resetNodes")})("disabledEdit",function(d){return n.disabledEdit(d)}),e._uU(5," \u91cd\u7f6e\u914d\u7f6e "),e.qZA()(),e.TgZ(6,"div",4),e._UZ(7,"eo-ng-apinto-table",5),e.qZA()(),e.YNc(8,Gt,3,3,"ng-template",null,6,e.W1O),e.YNc(10,Wt,1,1,"ng-template",null,7,e.W1O),e.YNc(12,jt,1,1,"ng-template",null,8,e.W1O)),2&t&&(e.xp6(2),e.Q6J("disabled",!n.nodesForms.isUpdate||n.nzDisabled),e.xp6(5),e.Q6J("nzTbody",n.nodesTableBody)("nzThead",n.nodesTableHeadName)("nzData",n.nodesForms.nodes)("nzNoScroll",!0))},dependencies:[_.RF,_.n9,Jt,M.qK,y.g,O.a]}),o})();function $t(o,s){1&o&&(e.ynx(0),e._uU(1,"\u82f1\u6587\u6570\u5b57\u4e0b\u5212\u7ebf\u4efb\u610f\u4e00\u79cd\uff0c\u9996\u5b57\u6bcd\u5fc5\u987b\u4e3a\u82f1\u6587"),e.BQk())}function Xt(o,s){1&o&&(e.ynx(0),e._uU(1,"\u5fc5\u586b\u9879"),e.BQk())}function en(o,s){if(1&o&&(e.YNc(0,$t,2,0,"ng-container",12),e.YNc(1,Xt,2,0,"ng-container",12)),2&o){const t=s.$implicit;e.Q6J("ngIf",t.hasError("pattern")),e.xp6(1),e.Q6J("ngIf",t.hasError("required"))}}let tn=(()=>{class o{constructor(t,n,u,d,S){this.message=t,this.api=n,this.fb=u,this.router=d,this.navigationService=S,this.editPage=!1,this.validateForm=new h.cw({}),this.VariableName="",this.autoTips=z.Sm,this.submitButtonLoading=!1,this.globalEnvDetailList=[],this.validateForm=this.fb.group({key:["",[h.kI.required,h.kI.pattern("^[a-zA-Z][a-zA-Z0-9/_]*")]],desc:[""]}),this.navigationService.reqFlashBreadcrumb([{title:"\u73af\u5883\u53d8\u91cf",routerLink:"deploy/variable"},{title:"\u65b0\u5efa\u914d\u7f6e"}])}ngOnInit(){}save(){this.validateForm.valid?(this.submitButtonLoading=!0,this.api.post("variable",{key:this.validateForm.controls.key.value,desc:this.validateForm.controls.desc.value||""}).subscribe(t=>{this.submitButtonLoading=!1,0===t.code&&(this.message.success(t.msg||"\u65b0\u589e\u73af\u5883\u53d8\u91cf\u6210\u529f\uff01",{nzDuration:1e3}),this.router.navigate(["/","deploy","variable"]))})):Object.values(this.validateForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}backToList(){this.router.navigate(["/","deploy","variable"])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s),e.Y36(h.QS),e.Y36(N.F0),e.Y36(C.a))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-environment-create"]],inputs:{editPage:"editPage"},decls:19,vars:11,consts:[["nz-form","",1,"mt-formtop",3,"nzNoColon","nzAutoTips","formGroup"],["nzRequired","",3,"nzSpan"],[3,"nzSpan","nzErrorTip"],["eo-ng-input","","formControlName","key","placeholder","\u82f1\u6587\u6570\u5b57\u4e0b\u5212\u7ebf\u4efb\u610f\u4e00\u79cd\uff0c\u9996\u5b57\u6bcd\u5fc5\u987b\u4e3a\u82f1\u6587","eoNgUserAccess","deploy/variable",1,"w-INPUT_NORMAL"],["nameErrorTpl",""],[1,"mb-0"],[3,"nzSpan"],["eo-ng-input","","formControlName","desc","placeholder","\u8bf7\u8f93\u5165","eoNgUserAccess","deploy/variable",1,"w-INPUT_NORMAL"],[1,"mb-0","sticky","bg-white","bottom-0","py-mbase","z-50"],[3,"nzOffset","nzSpan"],["eo-ng-button","","eoNgUserAccess","deploy/variable",1,"ant-btn-primary",3,"nzLoading","click"],["eo-ng-button","",1,"ml-btnybase",3,"click"],[4,"ngIf"]],template:function(t,n){if(1&t&&(e.TgZ(0,"form",0)(1,"nz-form-item")(2,"nz-form-label",1),e._uU(3,"KEY\uff1a"),e.qZA(),e.TgZ(4,"nz-form-control",2),e._UZ(5,"input",3),e.YNc(6,en,2,2,"ng-template",null,4,e.W1O),e.qZA()(),e.TgZ(8,"nz-form-item",5)(9,"nz-form-label",6),e._uU(10,"\u63cf\u8ff0\uff1a"),e.qZA(),e.TgZ(11,"nz-form-control",6),e._UZ(12,"textarea",7),e.qZA()(),e.TgZ(13,"nz-form-item",8)(14,"nz-form-control",9)(15,"button",10),e.NdJ("click",function(){return n.save()}),e._uU(16," \u4fdd\u5b58 "),e.qZA(),e.TgZ(17,"button",11),e.NdJ("click",function(){return n.backToList()}),e._uU(18," \u53d6\u6d88 "),e.qZA()()()()),2&t){const u=e.MAs(7);e.Q6J("nzNoColon",!0)("nzAutoTips",n.autoTips)("formGroup",n.validateForm),e.xp6(2),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12)("nzErrorTip",u),e.xp6(5),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12),e.xp6(3),e.Q6J("nzOffset",7)("nzSpan",12),e.xp6(1),e.Q6J("nzLoading",n.submitButtonLoading)}},dependencies:[_.O5,h._Y,h.Fj,h.JJ,h.JL,E.oO,M.qK,F.t3,F.SK,f.Lr,f.Nx,f.iK,f.Fd,h.sg,h.u,y.g],encapsulation:2}),o})(),nn=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-environment"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[N.lC],encapsulation:2}),o})();const on=[{title:"\u96c6\u7fa4"},{title:"\u73af\u5883"},{title:"VALUE"},{title:"\u72b6\u6001"}],an=[{key:"clusterName",copy:!0},{key:"environment"},{key:"value"},{key:"publishStatus"}],rn=[{title:"KEY"},{title:"\u63cf\u8ff0"},{title:"\u521b\u5efa\u8005"},{title:"\u521b\u5efa\u65f6\u95f4"},{title:"\u72b6\u6001"},{title:"\u64cd\u4f5c",right:!0}],sn=[{key:"key",copy:!0},{key:"description"},{key:"operator"},{key:"createTime"},{key:"status"},{type:"btn",right:!0,btns:[{title:"\u67e5\u770b"},{title:"\u5220\u9664"}]}],ln=["variableDetailStatusTpl"];function un(o,s){1&o&&(e.TgZ(0,"span",7),e._uU(1,"\u672a\u53d1\u5e03"),e.qZA())}function pn(o,s){1&o&&(e.TgZ(0,"span",8),e._uU(1,"\u5df2\u53d1\u5e03"),e.qZA())}function cn(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1,"\u7f3a\u5931"),e.qZA())}function dn(o,s){1&o&&(e.ynx(0,3),e.YNc(1,un,2,0,"span",4),e.YNc(2,pn,2,0,"span",5),e.YNc(3,cn,2,0,"span",6),e.BQk()),2&o&&(e.Q6J("ngSwitch",s.item.publishStatus),e.xp6(1),e.Q6J("ngSwitchCase","UNPUBLISHED"),e.xp6(1),e.Q6J("ngSwitchCase","PUBLISHED"),e.xp6(1),e.Q6J("ngSwitchCase","DEFECT"))}let hn=(()=>{class o{constructor(t){this.api=t,this.envKey="",this.globalEnvDetailList=[],this.globalEnvDetailTableHeadName=[...on],this.globalEnvDetailTableBody=[...an]}ngOnInit(){this.getEnvDetail()}ngAfterViewInit(){this.globalEnvDetailTableBody[3].title=this.variableDetailStatusTpl}getEnvDetail(){this.api.get("variable",{key:this.envKey||""}).subscribe(t=>{0===t.code&&(this.globalEnvDetailList=t.data.variables)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(T.s))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-environment-detail"]],viewQuery:function(t,n){if(1&t&&e.Gf(ln,7,e.Rgc),2&t){let u;e.iGM(u=e.CRH())&&(n.variableDetailStatusTpl=u.first)}},decls:4,vars:4,consts:[[1,"drawer-table"],[1,"mr10","mt10",3,"nzTbody","nzThead","nzData","nzNoScroll"],["variableDetailStatusTpl",""],[3,"ngSwitch"],["class","red-bold",4,"ngSwitchCase"],["class","green-bold",4,"ngSwitchCase"],["class","grey-bold",4,"ngSwitchCase"],[1,"red-bold"],[1,"green-bold"],[1,"grey-bold"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"eo-ng-apinto-table",1),e.qZA(),e.YNc(2,dn,4,4,"ng-template",null,2,e.W1O)),2&t&&(e.xp6(1),e.Q6J("nzTbody",n.globalEnvDetailTableBody)("nzThead",n.globalEnvDetailTableHeadName)("nzData",n.globalEnvDetailList)("nzNoScroll",!0))},dependencies:[_.RF,_.n9,O.a],encapsulation:2}),o})();const mn=["variableStatusTpl"];function gn(o,s){1&o&&(e.TgZ(0,"span",15),e._uU(1,"\u4f7f\u7528\u4e2d"),e.qZA())}function fn(o,s){1&o&&(e.TgZ(0,"span",16),e._uU(1,"\u7a7a\u95f2"),e.qZA())}function bn(o,s){1&o&&(e.ynx(0,12),e.YNc(1,gn,2,0,"span",13),e.YNc(2,fn,2,0,"span",14),e.BQk()),2&o&&(e.Q6J("ngSwitch",s.item.status),e.xp6(1),e.Q6J("ngSwitchCase","IN_USE"),e.xp6(1),e.Q6J("ngSwitchCase","UNUSED"))}let _n=(()=>{class o{constructor(t,n,u,d,S){this.message=t,this.modalService=n,this.api=u,this.router=d,this.navigationService=S,this.clusterName="",this.globalEnvForms={variables:[],total:0},this.nzDisabled=!1,this.globalEnvTableHeadName=[...rn],this.globalEnvTableBody=[...sn],this.statusList=[{label:"\u4f7f\u7528\u4e2d",value:"IN_USE"},{label:"\u7a7a\u95f2",value:"UNUSED"}],this.searchForm={key:"",status:""},this.variablePage={pageNum:1,pageSize:20,total:0},this.globalEnvTableClick=L=>{this.openDrawer(L.data)},this.navigationService.reqFlashBreadcrumb([{title:"\u73af\u5883\u53d8\u91cf",routerLink:"deploy/variable"}])}ngOnInit(){this.getVariables()}ngAfterViewInit(){this.globalEnvTableBody[4].title=this.variableStatusTpl,this.globalEnvTableBody[5].btns[0].click=t=>{this.openDrawer(t.data)},this.globalEnvTableBody[5].btns[1].click=t=>{this.deleteModal(t.data)},this.globalEnvTableBody[5].btns[1].disabledFn=(t,n)=>this.nzDisabled||"IN_USE"===n.data.status}disabledEdit(t){this.nzDisabled=t}deleteModal(t,n){n?.stopPropagation(),this.modalService.create({nzTitle:"\u5220\u9664",nzContent:"\u8be5\u6570\u636e\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u627e\u56de\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\uff1f",nzClosable:!0,nzClassName:"delete-modal",nzWidth:v.G_,nzOkDanger:!0,nzOnOk:()=>{this.delete(t)}})}getVariables(){this.api.get("variables",{pageNum:this.variablePage.pageNum,pageSize:this.variablePage.pageSize,key:this.searchForm?.key||"",status:this.searchForm?.status||""}).subscribe(t=>{0===t.code&&(this.globalEnvForms=t.data,this.variablePage.total=t.data.total)})}delete(t){this.api.delete("variable",{key:t.key||""}).subscribe(n=>{0===n.code&&(this.message.success(n.msg||"\u5220\u9664\u6210\u529f",{nzDuration:1e3}),this.getVariables())})}addConfig(){this.router.navigate(["/","deploy","variable","create"])}resetSearch(){this.searchForm.key="",this.searchForm.status=""}openDrawer(t){this.editConfigDrawerRef=this.modalService.create({nzTitle:"\u67e5\u770b\u73af\u5883\u53d8\u91cf",nzWidth:v.iE,nzContent:hn,nzComponentParams:{envKey:t.key},nzFooter:null})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(p._B),e.Y36(T.s),e.Y36(N.F0),e.Y36(C.a))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-environment-list"]],viewQuery:function(t,n){if(1&t&&e.Gf(mn,7,e.Rgc),2&t){let u;e.iGM(u=e.CRH())&&(n.variableStatusTpl=u.first)}},decls:20,vars:13,consts:[[1,""],[1,"list-header","pl-btnbase","pr-btnrbase","py-btnybase","flex","flex-nowrap","items-center","justify-between"],["eo-ng-button","","eoNgUserAccess","deploy/variable",1,"ant-btn-primary",3,"disabledEdit","click"],[2,"display","'flex'"],["eo-ng-input","","placeholder","\u8bf7\u8f93\u5165",3,"ngModel","ngModelChange"],[1,"ml-btnybase"],["nzPlaceHolder","\u8bf7\u9009\u62e9",3,"ngModel","nzOptions","ngModelChange"],["eo-ng-button","",1,"ml-btnybase",3,"click"],["eo-ng-button","",1,"ant-btn-primary","ml-btnybase",3,"click"],[1,"list-content","pb-[4px]"],[1,"",3,"nzTbody","nzThead","nzData","nzTrClick","nzMaxOperatorButton","nzShowPagination","nzFrontPagination","nzTotal","nzPageIndex","nzPageSize","nzPageIndexChange","nzPageSizeChange"],["variableStatusTpl",""],[3,"ngSwitch"],["style","color: #00785a",4,"ngSwitchCase"],["style","color: #2878ff",4,"ngSwitchCase"],[2,"color","#00785a"],[2,"color","#2878ff"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),e.NdJ("disabledEdit",function(d){return n.disabledEdit(d)})("click",function(){return n.addConfig()}),e._uU(4," \u65b0\u5efa\u914d\u7f6e "),e.qZA()(),e.TgZ(5,"div",3)(6,"label"),e._uU(7,"KEY\uff1a"),e.qZA(),e.TgZ(8,"input",4),e.NdJ("ngModelChange",function(d){return n.searchForm.key=d}),e.qZA(),e.TgZ(9,"label",5),e._uU(10,"\u72b6\u6001\uff1a"),e.qZA(),e.TgZ(11,"eo-ng-select",6),e.NdJ("ngModelChange",function(d){return n.searchForm.status=d}),e.qZA(),e.TgZ(12,"button",7),e.NdJ("click",function(){return n.resetSearch()}),e._uU(13," \u91cd\u7f6e "),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){return n.getVariables()}),e._uU(15," \u67e5\u8be2 "),e.qZA()()(),e.TgZ(16,"div",9)(17,"eo-ng-apinto-table",10),e.NdJ("nzPageIndexChange",function(d){return n.variablePage.pageNum=d})("nzPageSizeChange",function(d){return n.variablePage.pageSize=d})("nzPageIndexChange",function(){return n.getVariables()})("nzPageSizeChange",function(){return n.getVariables()}),e.qZA()()(),e.YNc(18,bn,3,3,"ng-template",null,11,e.W1O)),2&t&&(e.xp6(8),e.Q6J("ngModel",n.searchForm.key),e.xp6(3),e.Q6J("ngModel",n.searchForm.status)("nzOptions",n.statusList),e.xp6(6),e.Q6J("nzTbody",n.globalEnvTableBody)("nzThead",n.globalEnvTableHeadName)("nzData",n.globalEnvForms.variables)("nzTrClick",n.globalEnvTableClick)("nzMaxOperatorButton",2)("nzShowPagination",!0)("nzFrontPagination",!1)("nzTotal",n.variablePage.total)("nzPageIndex",n.variablePage.pageNum)("nzPageSize",n.variablePage.pageSize))},dependencies:[_.RF,_.n9,m.Hf,h.Fj,h.JJ,h.On,E.oO,M.qK,y.g,O.a],styles:["label[_ngcontent-%COMP%]{line-height:32px!important}input.ant-input[_ngcontent-%COMP%]:not(.w206):not(.w131):not(.w240), eo-ng-select.ant-select[_ngcontent-%COMP%]{width:216px!important}"]}),o})(),Cn=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-plugin"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[N.lC],encapsulation:2}),o})();var Pe=b(9538);function yn(o,s){1&o&&(e.ynx(0),e._uU(1,"\u82f1\u6587\u6570\u5b57\u4e0b\u5212\u7ebf\u4efb\u610f\u4e00\u79cd\uff0c\u9996\u5b57\u6bcd\u5fc5\u987b\u4e3a\u82f1\u6587"),e.BQk())}function Tn(o,s){1&o&&(e.ynx(0),e._uU(1,"\u5fc5\u586b\u9879"),e.BQk())}function vn(o,s){if(1&o&&(e.YNc(0,yn,2,0,"ng-container",17),e.YNc(1,Tn,2,0,"ng-container",17)),2&o){const t=s.$implicit;e.Q6J("ngIf",t.hasError("pattern")),e.xp6(1),e.Q6J("ngIf",t.hasError("required"))}}let Be=(()=>{class o{constructor(t,n,u,d){this.api=t,this.router=n,this.fb=u,this.navigationService=d,this.editPage=!1,this.validateForm=new h.cw({}),this.extendsList=[],this.relysList=[],this.nzDisabled=!1,this.nodesTableShow=!1,this.clusterCanBeCreated=!1,this.testFlag=!1,this.testPassAddr="",this.submitButtonLoading=!1,this.autoTips=z.Sm,this.validateForm=this.fb.group({name:["",[h.kI.required,h.kI.pattern("^[a-zA-Z][a-zA-Z0-9_]*")]],extended:["",[h.kI.required]],rely:[""],desc:[""]}),this.navigationService.reqFlashBreadcrumb([{title:"\u8282\u70b9\u63d2\u4ef6",routerLink:"deploy/plugin"},{title:"\u65b0\u5efa\u63d2\u4ef6"}])}ngOnInit(){this.editPage?(this.getPluginMessage(),this.validateForm.controls.name.disable(),this.validateForm.controls.rely.disable(),this.validateForm.controls.extended.disable()):this.getExtendsList(),this.getRelysList()}disabledEdit(t){this.nzDisabled=t}ngAfterViewInit(){}getPluginMessage(){this.api.get("plugin",{name:this.name}).subscribe(t=>{0===t.code&&(this.navigationService.reqFlashBreadcrumb([{title:"\u8282\u70b9\u63d2\u4ef6",routerLink:"deploy/plugin"},{title:"\u7f16\u8f91\u63d2\u4ef6"}]),(0,Pe.m)(this.validateForm,{name:t.data.plugin.name,rely:t.data.plugin.rely||"",extended:t.data.plugin.extended,desc:t.data.plugin.desc||""}),this.getExtendsList())})}getExtendsList(){this.api.get("plugin/extendeds").subscribe(t=>{0===t.code&&(this.extendsList=t.data.extendeds.map(n=>({label:n,value:n})),this.editPage?this.extendsList=[...this.extendsList,{label:this.validateForm.controls.extended.value,value:this.validateForm.controls.extended.value}]:this.validateForm.controls.extended.setValue(this.extendsList[0]?.value))})}getRelysList(){this.api.get("basic/info/plugins").subscribe(t=>{0===t.code&&(this.relysList=t.data.plugins.map(n=>({label:n.name,value:n.name})))})}savePlugin(){if(this.validateForm.valid){const t={name:this.validateForm.controls.name.value||"",extended:this.validateForm.controls.extended.value||"",rely:this.validateForm.controls.rely.value||"",desc:this.validateForm.controls.desc.value||""};this.submitButtonLoading=!0,this.editPage?this.api.put("plugin",{name:this.validateForm.controls.name.value||"",desc:this.validateForm.controls.desc.value||""}).subscribe(n=>{this.submitButtonLoading=!1,0===n.code&&this.router.navigate(["/","deploy","plugin"])}):this.api.post("plugin",t).subscribe(n=>{this.submitButtonLoading=!1,0===n.code&&this.router.navigate(["/","deploy","plugin"])})}else Object.values(this.validateForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}backToList(){this.router.navigate(["/","deploy","plugin"])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(T.s),e.Y36(N.F0),e.Y36(h.QS),e.Y36(C.a))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-plugin-create"]],inputs:{editPage:"editPage",name:"name"},decls:32,vars:20,consts:[[1,""],["nz-form","",3,"nzNoColon","nzAutoTips","formGroup"],[1,"list-header","mt-formtop","flex-nowrap","items-center","justify-between"],["nzRequired","",3,"nzSpan"],[3,"nzSpan","nzErrorTip"],["eo-ng-input","","formControlName","name","placeholder","\u82f1\u6587\u6570\u5b57\u4e0b\u5212\u7ebf\u7ec4\u5408\uff0c\u9996\u5b57\u6bcd\u5fc5\u987b\u4e3a\u82f1\u6587","eoNgUserAccess","deploy/plugin",1,"w-INPUT_NORMAL",3,"disabledEdit"],["clusterNameInput",""],["nameErrorTpl",""],[3,"nzSpan"],["formControlName","extended",1,"w-INPUT_NORMAL",3,"nzOptions","nzDisabled"],["formControlName","rely","nzAllowClear","","nzPlaceHolder","\u8bf7\u9009\u62e9",1,"w-INPUT_NORMAL",3,"nzOptions","nzDisabled"],[1,"mb-0"],["rows","6","eo-ng-input","","formControlName","desc","placeholder","\u8bf7\u8f93\u5165","eoNgUserAccess","deploy/plugin",1,"w-INPUT_NORMAL"],[1,"mb-0","sticky","bg-white","bottom-0","py-mbase","z-50"],[3,"nzOffset","nzSpan"],["eoNgUserAccess","deploy/plugin","type","submit","eo-ng-button","",1,"ant-btn-primary",3,"nzLoading","click"],["eo-ng-button","",1,"ml-btnybase",3,"click"],[4,"ngIf"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"nz-form-item")(4,"nz-form-label",3),e._uU(5,"\u63d2\u4ef6\u540d\u79f0\uff1a"),e.qZA(),e.TgZ(6,"nz-form-control",4)(7,"input",5,6),e.NdJ("disabledEdit",function(d){return n.disabledEdit(d)}),e.qZA(),e.YNc(9,vn,2,2,"ng-template",null,7,e.W1O),e.qZA()(),e.TgZ(11,"nz-form-item")(12,"nz-form-label",3),e._uU(13,"\u6269\u5c55ID\uff1a"),e.qZA(),e.TgZ(14,"nz-form-control",8),e._UZ(15,"eo-ng-select",9),e.qZA()(),e.TgZ(16,"nz-form-item")(17,"nz-form-label",8),e._uU(18,"\u4f9d\u8d56\u63d2\u4ef6\uff1a"),e.qZA(),e.TgZ(19,"nz-form-control",8),e._UZ(20,"eo-ng-select",10),e.qZA()(),e.TgZ(21,"nz-form-item",11)(22,"nz-form-label",8),e._uU(23,"\u63cf\u8ff0\uff1a"),e.qZA(),e.TgZ(24,"nz-form-control",8),e._UZ(25,"textarea",12),e.qZA()()()(),e.TgZ(26,"nz-form-item",13)(27,"nz-form-control",14)(28,"button",15),e.NdJ("click",function(){return n.savePlugin()}),e._uU(29),e.qZA(),e.TgZ(30,"button",16),e.NdJ("click",function(){return n.backToList()}),e._uU(31," \u53d6\u6d88 "),e.qZA()()()()),2&t){const u=e.MAs(10);e.xp6(1),e.Q6J("nzNoColon",!0)("nzAutoTips",n.autoTips)("formGroup",n.validateForm),e.xp6(3),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12)("nzErrorTip",u),e.xp6(6),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12),e.xp6(1),e.Q6J("nzOptions",n.extendsList)("nzDisabled",n.nzDisabled),e.xp6(2),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12),e.xp6(1),e.Q6J("nzOptions",n.relysList)("nzDisabled",n.nzDisabled),e.xp6(2),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12),e.xp6(3),e.Q6J("nzOffset",7)("nzSpan",18),e.xp6(1),e.Q6J("nzLoading",n.submitButtonLoading),e.xp6(1),e.hij(" ",n.editPage?"\u63d0\u4ea4":"\u4fdd\u5b58"," ")}},dependencies:[_.O5,m.Hf,h._Y,h.Fj,h.JJ,h.JL,E.oO,M.qK,F.t3,F.SK,f.Lr,f.Nx,f.iK,f.Fd,h.sg,h.u,y.g],encapsulation:2}),o})();var Ze=b(9646);const zn=[{type:"sort",width:40},{title:"\u63d2\u4ef6\u540d\u79f0"},{title:"\u6269\u5c55ID"},{title:"\u63cf\u8ff0"},{title:"\u66f4\u65b0\u65f6\u95f4"},{title:"\u64cd\u4f5c",right:!0}],Dn=["pluginName"];function Fn(o,s){1&o&&(e.ynx(0),e.TgZ(1,"span",12),e._uU(2,"\xa0\u5185\u7f6e"),e.qZA(),e.BQk())}function An(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",6)(1,"span",7),e.NdJ("click",function(){const d=e.CHM(t).item,S=e.oxw();return e.KtG(S.pluginTableClick(d))}),e._uU(2),e.qZA(),e.YNc(3,Fn,3,0,"ng-container",8),e.TgZ(4,"span",9),e.NdJ("copyCallback",function(){e.CHM(t);const u=e.oxw();return e.KtG(u.copyCallback())})("click",function(u){return u.stopPropagation()}),e.O4$(),e.TgZ(5,"svg",10),e._UZ(6,"use",11),e.qZA()()()}if(2&o){const t=s.item;e.xp6(1),e.Q6J("nzTooltipTitle",t.name)("nzTooltipVisible",!1)("nzTooltipTrigger","hover"),e.xp6(1),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.isBuilt),e.xp6(1),e.Q6J("copyText",t.name)}}let Nn=(()=>{class o{constructor(t,n,u,d,S,L){this.message=t,this.modalService=n,this.api=u,this.router=d,this.navigationService=S,this.service=L,this.nzDisabled=!1,this.pluginsList=[],this.pluginsTableHeadName=[...zn],this.pluginsTableBody=[],this.dragPlugin=(Y,j)=>{let Ie=0,Le=0;const we=this.pluginsList.map(se=>(se.name===Y.data.name?Ie=this.pluginsList.indexOf(se):se.name===j.data.name&&(Le=this.pluginsList.indexOf(se)),se.name));return we.splice(Ie,1),we.splice(Le,0,Y.data.name),this.getDragCheck(we)},this.pluginTableClick=Y=>{this.router.navigate(["/","deploy","plugin","message",Y.data.name])},this.navigationService.reqFlashBreadcrumb([{title:"\u8282\u70b9\u63d2\u4ef6"}])}ngOnInit(){this.getPluginsData()}ngAfterViewInit(){this.pluginsTableBody=this.service.createPluginsTbody(this)}getPluginsData(){this.api.get("plugins").subscribe(t=>{0===t.code&&(this.pluginsList=t.data.plugins)})}disabledEdit(t){this.nzDisabled=t}delete(t){this.modalService.create({nzTitle:"\u5220\u9664",nzContent:"\u8be5\u6570\u636e\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u627e\u56de\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\uff1f",nzClosable:!0,nzClassName:"delete-modal",nzWidth:v.G_,nzOkDanger:!0,nzOnOk:()=>{this.deletePlugin(t)}})}deletePlugin(t){this.api.delete("plugin",{name:t.name}).subscribe(n=>{0===n.code&&(this.message.success(n.msg||"\u5220\u9664\u6210\u529f",{nzDuration:1e3}),this.getPluginsData())})}getDragCheck(t){this.api.put("plugin/sort",{names:t}).subscribe(n=>(0===n.code&&(this.message.success(n.msg||"\u5220\u9664\u6210\u529f",{nzDuration:1e3}),this.getPluginsData()),(0,Ze.of)(!0)))}addPlugin(){this.router.navigate(["/","deploy","plugin","create"])}copyCallback(){this.message.success("\u590d\u5236\u6210\u529f",{nzDuration:1e3})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(p._B),e.Y36(T.s),e.Y36(N.F0),e.Y36(C.a),e.Y36(W))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-plugin-list"]],viewQuery:function(t,n){if(1&t&&e.Gf(Dn,7,e.Rgc),2&t){let u;e.iGM(u=e.CRH())&&(n.pluginName=u.first)}},decls:8,vars:8,consts:[[1,""],[1,"list-header","pl-btnbase","pr-btnrbase","py-btnybase","flex","flex-nowrap","items-center","justify-between"],["eo-ng-button","","eoNgUserAccess","deploy/plugin",1,"ant-btn-primary",3,"disabledEdit","click"],[1,"list-content"],[3,"nzTbody","nzThead","nzData","nzMaxOperatorButton","nzDraggable","nzDragCheck","nzIsLevel","nzTrClick"],["pluginName",""],[1,"leading-[22px]","flex","items-center"],["eoNgFeedbackTooltip","",1,"mr-[8px]",3,"nzTooltipTitle","nzTooltipVisible","nzTooltipTrigger","click"],[4,"ngIf"],["eo-copy","","nzType","primary",1,"h-[20px]","leading-[22px]","text-[12px]","opacity-0","cursor-pointer","inline-flex","items-center",3,"copyText","copyCallback","click"],[1,"iconpark-icon"],["href","#copy"],[1,"text-theme","mr-[8px]"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("disabledEdit",function(d){return n.disabledEdit(d)})("click",function(){return n.addPlugin()}),e._uU(3," \u6dfb\u52a0\u63d2\u4ef6 "),e.qZA()(),e.TgZ(4,"div",3),e._UZ(5,"eo-ng-apinto-table",4),e.qZA()(),e.YNc(6,An,7,6,"ng-template",null,5,e.W1O)),2&t&&(e.xp6(5),e.Q6J("nzTbody",n.pluginsTableBody)("nzThead",n.pluginsTableHeadName)("nzData",n.pluginsList)("nzMaxOperatorButton",2)("nzDraggable",!0)("nzDragCheck",n.dragPlugin)("nzIsLevel",!1)("nzTrClick",n.pluginTableClick))},dependencies:[_.O5,p.Cl,M.qK,y.g,O.a,re.jw],encapsulation:2}),o})(),En=(()=>{class o{constructor(t,n){this.baseInfo=t,this.router=n,this.pluginName=""}ngOnInit(){this.pluginName=this.baseInfo.allParamsInfo.pluginName,this.pluginName||this.router.navigate(["/","deploy","plugin"])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(Z.D),e.Y36(N.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-plugin-message"]],decls:1,vars:2,consts:[[3,"editPage","name"]],template:function(t,n){1&t&&e._UZ(0,"eo-ng-deploy-plugin-create",0),2&t&&e.Q6J("editPage",!0)("name",n.pluginName)},dependencies:[Be],encapsulation:2}),o})();function wn(o,s){if(1&o&&(e.TgZ(0,"div",12),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.unpublishMsg," ")}}let xn=(()=>{class o{constructor(t,n,u){this.message=t,this.api=n,this.fb=u,this.autoTips=z.Sm,this.validatePublishForm=new h.cw({}),this.clusterName="",this.unpublishMsg="",this.nzDisabled=!1,this.publishSource="",this.publishData={source:"",plugins:[],isPublish:!1,versionName:""},this.publishTableHeadName=[...De],this.publishTableBody=[...Fe],this.statusList=[...X],this.closeModal=d=>{},this.validatePublishForm=this.fb.group({versionName:["",[h.kI.required]],desc:[""]})}ngOnInit(){this.getPublishData()}ngAfterViewInit(){this.publishTableBody[3].title=this.publishTypeTpl}disabledEdit(t){this.nzDisabled=t}getPublishData(){this.api.get("cluster/"+this.clusterName+"/plugin/to-publish").subscribe(t=>{0===t.code&&(this.publishData=t.data,this.publishData.plugins=t.data.plugins?.map(n=>(n.finishValue=`\u63d2\u4ef6\u987a\u5e8f\uff1a${n.releasedSort}\uff0c\u72b6\u6001\uff1a${this.getStatusString(n.releasedConfig.status)}\uff0c\u914d\u7f6e\uff1a${n.releasedConfig.config}`,n.noReleasedValue=`\u63d2\u4ef6\u987a\u5e8f\uff1a${n.nowSort}\uff0c\u72b6\u6001\uff1a${this.getStatusString(n.noReleasedConfig.status)}\uff0c\u914d\u7f6e\uff1a${n.noReleasedConfig.config}`,n))||[],this.validatePublishForm.controls.versionName.setValue(t.data.versionName),this.publishSource=t.data.source,this.unpublishMsg=t.data.unpublishedMsg,!this.publishData.isPublish&&!this.unpublishMsg&&(this.unpublishMsg=0===this.publishData.plugins.length?"\u65e0\u63d2\u4ef6\u53ef\u53d1\u5e03":"\u5f53\u524d\u63d2\u4ef6\u4e0d\u53ef\u53d1\u5e03"))})}getStatusString(t){return t?this.statusList.filter(n=>n.value===t)[0].label:"\u65e0"}save(){return this.validatePublishForm.valid&&this.publishData.isPublish?(this.api.post("cluster/"+this.clusterName+"/plugin/publish",{versionName:this.validatePublishForm.value.versionName,desc:this.validatePublishForm.value.desc,source:this.publishSource}).subscribe(t=>0===t.code&&(this.message.success(t.msg||"\u53d1\u5e03\u6210\u529f",{nzDuration:1e3}),this.closeModal(!0),!0)),!1):(Object.values(this.validatePublishForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))}),!1)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s),e.Y36(h.QS))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-plugin-publish"]],inputs:{publishTypeTpl:"publishTypeTpl"},decls:23,vars:9,consts:[["nz-form","",3,"nzNoColon","nzAutoTips","formGroup"],[1,"drawer-list-header"],[1,"label",2,"width","100px"],[1,"required-symbol"],["eo-ng-input","","eoNgUserAccess","deploy/cluster","formControlName","versionName","placeholder","\u8bf7\u8f93\u5165",1,"w-INPUT_NORMAL"],["rows","8","eo-ng-input","","eoNgUserAccess","deploy/cluster","formControlName","desc","placeholder","\u8bf7\u8f93\u5165",1,"w-INPUT_NORMAL"],[1,"mb-0"],[1,"label","table-label",2,"width","100px"],[3,"nzValidateStatus","nzErrorTip"],[2,"width","100%"],[1,"drawer-table",3,"nzTbody","nzThead","nzData","nzNoScroll","nzDataChange"],["unpublishMsgTpl",""],[1,"drawer-list-footer"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div")(1,"form",0)(2,"div",1)(3,"nz-form-item")(4,"label",2)(5,"span",3),e._uU(6,"*"),e.qZA(),e._uU(7,"\u53d1\u5e03\u540d\u79f0\uff1a"),e.qZA(),e.TgZ(8,"nz-form-control"),e._UZ(9,"input",4),e.qZA()(),e.TgZ(10,"nz-form-item")(11,"label",2),e._uU(12,"\u63cf\u8ff0\uff1a"),e.qZA(),e.TgZ(13,"nz-form-control"),e._UZ(14,"textarea",5),e.qZA()()(),e.TgZ(15,"nz-form-item",6)(16,"label",7),e._uU(17,"\u63d2\u4ef6\u5217\u8868\uff1a"),e.qZA(),e.TgZ(18,"nz-form-control",8)(19,"div",9)(20,"eo-ng-apinto-table",10),e.NdJ("nzDataChange",function(d){return n.publishData.plugins=d}),e.qZA()(),e.YNc(21,wn,2,1,"ng-template",null,11,e.W1O),e.qZA()()()()),2&t){const u=e.MAs(22);e.xp6(1),e.Q6J("nzNoColon",!0)("nzAutoTips",n.autoTips)("formGroup",n.validatePublishForm),e.xp6(17),e.Q6J("nzValidateStatus",n.publishData.isPublish?"":"error")("nzErrorTip",u),e.xp6(2),e.Q6J("nzTbody",n.publishTableBody)("nzThead",n.publishTableHeadName)("nzData",n.publishData.plugins)("nzNoScroll",!0)}},dependencies:[h._Y,h.Fj,h.JJ,h.JL,E.oO,F.t3,F.SK,f.Lr,f.Nx,f.Fd,h.sg,h.u,y.g,O.a],encapsulation:2}),o})();var Sn=b(4196),Ue=b(4675);const kn=function(){return["format","reset","copy","search","replace"]};let Pn=(()=>{class o{constructor(t,n,u,d){this.message=t,this.api=n,this.jsonService=u,this.fb=d,this.autoTips=z.Sm,this.validateConfigForm=new h.cw({}),this.clusterName="",this.statusList=[...X],this.nzDisabled=!1,this.renderList=[],this.config="",this.pluginConfigError=!1,this.startValidate=!1,this.pluginConfigFormaError=!1,this.closeModal=S=>{}}ngOnInit(){this.validateConfigForm=this.fb.group({name:[this.editData?.name||""],status:[this.editData?.status||""]}),this.config=this.editData?.config||"",this.getPluginConfigRender()}getPluginConfigRender(){this.api.get("plugins/render").subscribe(t=>{if(0===t.code&&(this.renderList=t.data.plugins,!this.editData?.config||"null"===this.editData?.config)){let n="";try{n=JSON.stringify(this.jsonService.handleJsonSchema2Json(JSON.parse(this.renderList.filter(u=>u.name===this.validateConfigForm.controls.name.value)[0].config)))}catch{console.warn("JSON\u6570\u636e\u89e3\u6790\u5931\u8d25"),n=this.renderList.filter(u=>u.name===this.validateConfigForm.controls.name.value)[0].config}this.config=n}})}handlerConfigChange(){this.startValidate&&(this.pluginConfigError=!this.config,this.pluginConfigFormaError=!1)}save(){if(this.startValidate=!0,this.pluginConfigError=!this.config,this.validateConfigForm.valid&&!this.pluginConfigError){let t="";try{t=JSON.parse(this.config||"{}")}catch{return t=this.config,this.pluginConfigError=!0,void(this.pluginConfigFormaError=!0)}this.api.post("cluster/"+this.clusterName+"/plugin",{name:this.validateConfigForm.value.name||"",status:this.validateConfigForm.value.status||"",config:t}).subscribe(n=>{0===n.code&&(this.message.success(n.msg||"\u6dfb\u52a0\u6210\u529f",{nzDuration:1e3}),this.closeModal(!0))})}else Object.values(this.validateConfigForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s),e.Y36(Sn.s),e.Y36(h.QS))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-plugin-config-form"]],inputs:{editData:"editData"},decls:17,vars:20,consts:[["nz-form","",1,"deploy-drawer",3,"nzNoColon","nzAutoTips","formGroup"],[3,"nzSpan"],["nzRequired","",3,"nzSpan"],["formControlName","status",1,"w-INPUT_NORMAL",3,"nzOptions","nzDisabled"],[1,"mb-0"],["nzRequired","",3,"nzNoColon","nzSpan"],[3,"nzSpan","nzValidateStatus","nzErrorTip"],["mode","typescript","name","config",2,"display","block",3,"oprBtns","code","autoFormat","readonly","codeChange"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0)(1,"nz-form-item")(2,"nz-form-label",1),e._uU(3,"\u63d2\u4ef6\u540d\u79f0\uff1a"),e.qZA(),e.TgZ(4,"nz-form-control",1)(5,"span"),e._uU(6),e.qZA()()(),e.TgZ(7,"nz-form-item")(8,"nz-form-label",2),e._uU(9,"\u72b6\u6001\uff1a"),e.qZA(),e.TgZ(10,"nz-form-control",1),e._UZ(11,"eo-ng-select",3),e.qZA()()(),e.TgZ(12,"nz-form-item",4)(13,"nz-form-label",5),e._uU(14,"\u63d2\u4ef6\u914d\u7f6e\uff1a"),e.qZA(),e.TgZ(15,"nz-form-control",6)(16,"eo-ng-codebox",7),e.NdJ("codeChange",function(d){return n.config=d})("codeChange",function(){return n.handlerConfigChange()}),e.qZA()()()),2&t&&(e.Q6J("nzNoColon",!0)("nzAutoTips",n.autoTips)("formGroup",n.validateConfigForm),e.xp6(2),e.Q6J("nzSpan",6),e.xp6(2),e.Q6J("nzSpan",13),e.xp6(2),e.Oqu(n.validateConfigForm.controls.name.value),e.xp6(2),e.Q6J("nzSpan",6),e.xp6(2),e.Q6J("nzSpan",13),e.xp6(1),e.Q6J("nzOptions",n.statusList)("nzDisabled",n.nzDisabled),e.xp6(2),e.Q6J("nzNoColon",!0)("nzSpan",6),e.xp6(2),e.Q6J("nzSpan",13)("nzValidateStatus",n.pluginConfigError?"error":"")("nzErrorTip",n.pluginConfigFormaError?"JSON\u683c\u5f0f\u6709\u8bef":"\u5fc5\u586b\u9879"),e.xp6(1),e.Q6J("oprBtns",e.DdM(19,kn))("code",n.config)("autoFormat",!0)("readonly",n.nzDisabled))},dependencies:[m.Hf,h._Y,h.JJ,h.JL,F.t3,F.SK,f.Lr,f.Nx,f.iK,f.Fd,h.sg,h.u,Ue.t],encapsulation:2}),o})(),Bn=(()=>{class o{constructor(t,n){this.message=t,this.api=n,this.operateRecordsData={historys:[],total:0},this.operateRecordTabelHeadName=[...ge],this.operateRecordTableBody=[...I],this.operateRecordsPage={pageNum:1,pageSize:15,total:0},this.pageSizeOptions=[15,20,50,100],this.clusterName="",this.statusList=[...X]}ngOnInit(){this.getOperateRecords()}ngAfterViewInit(){this.operateRecordTableBody[3].title=this.publishTypeTpl}getOperateRecords(){this.api.get("cluster/"+this.clusterName+"/plugin/update-history",{pageNum:this.operateRecordsPage.pageNum,pageSize:this.operateRecordsPage.pageSize}).subscribe(t=>{0===t.code&&(this.operateRecordsData.total=t.data.total,this.operateRecordsData.historys=t.data.histories.map(n=>(n.oldValue=`\u72b6\u6001\uff1a${this.getStatusString(n.oldConfig.status)}\uff0c\u914d\u7f6e\u4fe1\u606f\uff1a${n.oldConfig.config}`,n.newValue=`\u72b6\u6001\uff1a${this.getStatusString(n.newConfig.status)}\uff0c\u914d\u7f6e\u4fe1\u606f\uff1a${n.newConfig.config}`,n)))})}getStatusString(t){return t?this.statusList.filter(n=>n.value===t)[0]?.label:"\u65e0"}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-plugin-history-change"]],inputs:{publishTypeTpl:"publishTypeTpl"},decls:2,vars:10,consts:[[1,"drawer-list-content","drawer-table","pb-[4px]",2,"margin-top","0px"],["nzTableLayout","fixed",1,"drawer-table",3,"nzTbody","nzThead","nzData","nzNoScroll","nzShowPagination","nzFrontPagination","nzTotal","nzPageIndex","nzPageSize","nzPageSizeOptions","nzDataChange","nzPageIndexChange","nzPageSizeChange"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"eo-ng-apinto-table",1),e.NdJ("nzDataChange",function(d){return n.operateRecordsData.historys=d})("nzPageIndexChange",function(d){return n.operateRecordsPage.pageNum=d})("nzPageSizeChange",function(d){return n.operateRecordsPage.pageSize=d})("nzPageIndexChange",function(){return n.getOperateRecords()})("nzPageSizeChange",function(){return n.getOperateRecords()}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("nzTbody",n.operateRecordTableBody)("nzThead",n.operateRecordTabelHeadName)("nzData",n.operateRecordsData.historys)("nzNoScroll",!0)("nzShowPagination",!0)("nzFrontPagination",!1)("nzTotal",n.operateRecordsPage.total)("nzPageIndex",n.operateRecordsPage.pageNum)("nzPageSize",n.operateRecordsPage.pageSize)("nzPageSizeOptions",n.pageSizeOptions))},dependencies:[O.a],encapsulation:2}),o})();const Zn=["showInnerTableBtnTpl"],Un=["innerTableOldValueTpl"],In=["innerTableNewValueTpl"];function Ln(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"tr"),e._UZ(1,"td",7),e.TgZ(2,"td",8)(3,"div",9)(4,"eo-ng-apinto-table",10),e.NdJ("nzDataChange",function(u){e.CHM(t);const d=e.oxw().item;return e.KtG(d.data.details=u)}),e.qZA()()()()}if(2&o){const t=e.oxw().item,n=e.oxw();e.xp6(4),e.Q6J("nzTbody",n.publishRecordDetailsTableBody)("nzThead",n.publishRecordDetailsTabelHeadName)("nzData",t.data.details)("nzScrollY",9999)}}function On(o,s){1&o&&e.YNc(0,Ln,5,4,"tr",6),2&o&&e.Q6J("ngIf",s.item.data.isExpand)}function Rn(o,s){1&o&&e._UZ(0,"button",11),2&o&&e.Q6J("expand",s.item.isExpand)}function Mn(o,s){if(1&o&&(e.TgZ(0,"span",12),e._uU(1),e.qZA()),2&o){const t=s.item,n=e.oxw();e.Q6J("nzTooltipTitle",n.transferToJson("\u72b6\u6001\uff1a"+n.getStatusString(t.oldConfig.status)+"\uff0c\u914d\u7f6e\u4fe1\u606f\uff1a"+t.oldConfig.config))("nzTooltipVisible",!1)("nzTooltipTrigger","hover"),e.xp6(1),e.hij(" ","\u72b6\u6001\uff1a"+n.getStatusString(t.oldConfig.status)+"\uff0c\u914d\u7f6e\u4fe1\u606f\uff1a"+t.oldConfig.config," ")}}function Jn(o,s){if(1&o&&(e.TgZ(0,"span",12),e._uU(1),e.qZA()),2&o){const t=s.item,n=e.oxw();e.Q6J("nzTooltipTitle",n.transferToJson("\u72b6\u6001\uff1a"+n.getStatusString(t.newConfig.status)+"\uff0c\u914d\u7f6e\u4fe1\u606f\uff1a"+t.newConfig.config))("nzTooltipVisible",!1)("nzTooltipTrigger","hover"),e.xp6(1),e.hij(" ","\u72b6\u6001\uff1a"+n.getStatusString(t.newConfig.status)+"\uff0c\u914d\u7f6e\u4fe1\u606f\uff1a"+t.newConfig.config," ")}}let Yn=(()=>{class o{constructor(t,n){this.message=t,this.api=n,this.publishRecordsData={historys:[],total:0},this.publishRecordTabelHeadName=[...ce],this.publishRecordTableBody=[...de],this.publishRecordDetailsTabelHeadName=[...ge],this.publishRecordDetailsTableBody=[...I],this.pageSizeOptions=[15,20,50,100],this.statusList=[...X],this.publishRecordsPage={pageNum:1,pageSize:15,total:0},this.clusterName="",this.publishRTableClick=u=>{u.data.isExpand=!u.data.isExpand}}ngOnInit(){this.getPublishRecords()}ngAfterViewInit(){this.publishRecordTableBody[0].title=this.showInnerTableBtnTpl,this.publishRecordDetailsTableBody[1].title=this.innerTableOldValueTpl,this.publishRecordDetailsTableBody[2].title=this.innerTableNewValueTpl,this.publishRecordDetailsTableBody[3].title=this.publishTypeTpl}getPublishRecords(){this.api.get("cluster/"+this.clusterName+"/plugin/publish-history",{pageNum:this.publishRecordsPage.pageNum,pageSize:this.publishRecordsPage.pageSize}).subscribe(t=>{if(0===t.code){for(const n of t.data.histories)n.isExpand=!1;this.publishRecordsData.historys=t.data.histories,this.publishRecordsData.total=t.data.total}})}expandChange(){this.publishRecordsData.historys=[...this.publishRecordsData.historys]}getStatusString(t){return this.statusList.filter(n=>n.value===t)[0]?.label||"\u65e0"}transferToJson(t){return t.replace(/(,\n)/g,",").replace(/(,\n)/g,",").replace(/(,)/g,",\n").replace(/(\uff0c)/g,"\uff0c\n")}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-plugin-history-publish"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Zn,7,e.Rgc),e.Gf(Un,7,e.Rgc),e.Gf(In,7,e.Rgc)),2&t){let u;e.iGM(u=e.CRH())&&(n.showInnerTableBtnTpl=u.first),e.iGM(u=e.CRH())&&(n.innerTableOldValueTpl=u.first),e.iGM(u=e.CRH())&&(n.innerTableNewValueTpl=u.first)}},inputs:{publishTypeTpl:"publishTypeTpl"},decls:10,vars:12,consts:[[1,"drawer-list-content","drawer-table",2,"margin-top","0px"],[1,"drawer-table",3,"nzTbody","nzThead","nzData","nzTrBottomTmp","nzTrClick","nzNoScroll","nzShowPagination","nzFrontPagination","nzTotal","nzPageIndex","nzPageSize","nzPageSizeOptions","nzDataChange","nzPageIndexChange","nzPageSizeChange"],["nzTrBottomTmp",""],["showInnerTableBtnTpl",""],["innerTableOldValueTpl",""],["innerTableNewValueTpl",""],[4,"ngIf"],[2,"border-right","none","background-color","#e8e8e8"],["colspan","3",2,"border","none","padding","0","margin-top","-2px"],[2,"width","100%"],["nzTableLayout","fixed",1,"floatR","innerTable",3,"nzTbody","nzThead","nzData","nzScrollY","nzDataChange"],["eo-ng-row-expand-button","",3,"expand"],["eoNgFeedbackTooltip","","nzTooltipOverlayClassName","tooltip-json",3,"nzTooltipTitle","nzTooltipVisible","nzTooltipTrigger"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"eo-ng-apinto-table",1),e.NdJ("nzDataChange",function(d){return n.publishRecordsData.historys=d})("nzPageIndexChange",function(d){return n.publishRecordsPage.pageNum=d})("nzPageSizeChange",function(d){return n.publishRecordsPage.pageSize=d})("nzPageIndexChange",function(){return n.getPublishRecords()})("nzPageSizeChange",function(){return n.getPublishRecords()}),e.qZA()(),e.YNc(2,On,1,1,"ng-template",null,2,e.W1O),e.YNc(4,Rn,1,1,"ng-template",null,3,e.W1O),e.YNc(6,Mn,2,4,"ng-template",null,4,e.W1O),e.YNc(8,Jn,2,4,"ng-template",null,5,e.W1O)),2&t){const u=e.MAs(3);e.xp6(1),e.Q6J("nzTbody",n.publishRecordTableBody)("nzThead",n.publishRecordTabelHeadName)("nzData",n.publishRecordsData.historys)("nzTrBottomTmp",u)("nzTrClick",n.publishRTableClick)("nzNoScroll",!0)("nzShowPagination",!0)("nzFrontPagination",!1)("nzTotal",n.publishRecordsPage.total)("nzPageIndex",n.publishRecordsPage.pageNum)("nzPageSize",n.publishRecordsPage.pageSize)("nzPageSizeOptions",n.pageSizeOptions)}},dependencies:[_.O5,p.Cl,ae.Uo,ae.$Z,ke,O.a],encapsulation:2}),o})();const Qn=["operatorStatusTpl"],qn=["publishStatusTpl"],Hn=["publishTypeTpl"],Vn=["pluginStatusTpl"];function Gn(o,s){1&o&&(e.TgZ(0,"span",20),e._uU(1,"\u65b0"),e.qZA())}function Wn(o,s){1&o&&(e.TgZ(0,"span",21),e._uU(1,"\u6539"),e.qZA())}function jn(o,s){1&o&&(e.TgZ(0,"span",22),e._uU(1,"\u5220"),e.qZA())}function Kn(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",11)(1,"span",12),e._uU(2),e.qZA(),e.ynx(3,13),e.YNc(4,Gn,2,0,"span",14),e.YNc(5,Wn,2,0,"span",15),e.YNc(6,jn,2,0,"span",16),e.BQk(),e.TgZ(7,"span",17),e.NdJ("copyCallback",function(){e.CHM(t);const u=e.oxw();return e.KtG(u.copyCallback())})("click",function(u){return u.stopPropagation()}),e.O4$(),e.TgZ(8,"svg",18),e._UZ(9,"use",19),e.qZA()()()}if(2&o){const t=s.item;e.xp6(1),e.Q6J("nzTooltipTitle",t.name)("nzTooltipVisible",!1),e.xp6(1),e.hij(" ",t.name,""),e.xp6(1),e.Q6J("ngSwitch",t.changeStatus),e.xp6(1),e.Q6J("ngSwitchCase","NEW"),e.xp6(1),e.Q6J("ngSwitchCase","MODIFY"),e.xp6(1),e.Q6J("ngSwitchCase","DELETE"),e.xp6(1),e.Q6J("copyText",t.name)}}function $n(o,s){1&o&&(e.TgZ(0,"span",26),e._uU(1,"\u672a\u53d1\u5e03"),e.qZA())}function Xn(o,s){1&o&&(e.TgZ(0,"span",27),e._uU(1,"\u5df2\u53d1\u5e03"),e.qZA())}function ei(o,s){1&o&&(e.TgZ(0,"span",28),e._uU(1,"\u7f3a\u5931"),e.qZA())}function ti(o,s){1&o&&(e.ynx(0,13),e.YNc(1,$n,2,0,"span",23),e.YNc(2,Xn,2,0,"span",24),e.YNc(3,ei,2,0,"span",25),e.BQk()),2&o&&(e.Q6J("ngSwitch",s.item.publish),e.xp6(1),e.Q6J("ngSwitchCase","UNPUBLISHED"),e.xp6(1),e.Q6J("ngSwitchCase","PUBLISHED"),e.xp6(1),e.Q6J("ngSwitchCase","DEFECT"))}function ni(o,s){1&o&&(e.TgZ(0,"span",27),e._uU(1,"\u65b0\u589e"),e.qZA())}function ii(o,s){1&o&&(e.TgZ(0,"span",28),e._uU(1,"\u66f4\u65b0"),e.qZA())}function oi(o,s){1&o&&(e.TgZ(0,"span",30),e._uU(1,"\u5220\u9664"),e.qZA())}function ai(o,s){1&o&&(e.ynx(0,13),e.YNc(1,ni,2,0,"span",24),e.YNc(2,ii,2,0,"span",25),e.YNc(3,oi,2,0,"span",29),e.BQk()),2&o&&(e.Q6J("ngSwitch",s.item.optType),e.xp6(1),e.Q6J("ngSwitchCase","NEW"),e.xp6(1),e.Q6J("ngSwitchCase","MODIFY"),e.xp6(1),e.Q6J("ngSwitchCase","DELETE"))}function ri(o,s){1&o&&(e.TgZ(0,"span",27),e._uU(1,"\u542f\u7528"),e.qZA())}function si(o,s){1&o&&(e.TgZ(0,"span",32),e._uU(1,"\u5168\u5c40\u542f\u7528"),e.qZA())}function li(o,s){1&o&&(e.TgZ(0,"span",30),e._uU(1,"\u7981\u7528"),e.qZA())}function ui(o,s){1&o&&(e.ynx(0,13),e.YNc(1,ri,2,0,"span",24),e.YNc(2,si,2,0,"span",31),e.YNc(3,li,2,0,"span",29),e.BQk()),2&o&&(e.Q6J("ngSwitch",s.item.status),e.xp6(1),e.Q6J("ngSwitchCase","ENABLE"),e.xp6(1),e.Q6J("ngSwitchCase","GLOBAL"),e.xp6(1),e.Q6J("ngSwitchCase","DISABLE"))}const pi=[{path:"",component:be,data:{id:"1"},children:[{path:"cluster",component:be,data:{id:"101",parentId:"1"},children:[{path:"",component:At},{path:"create",component:xe},{path:"content/:clusterName",component:l,children:[{path:"env",component:_t},{path:"cert",component:fe},{path:"",component:Kt},{path:"plugin",component:(()=>{class o{constructor(t,n,u,d,S,L,Y){this.baseInfo=t,this.message=n,this.modalService=u,this.api=d,this.router=S,this.navigationService=L,this.service=Y,this.clusterName="",this.nowUrl=this.router.routerState.snapshot.url,this.pluginsList=[],this.nzDisabled=!1,this.pluginsTableHeadName=[...ze],this.pluginsTableBody=[...this.service.createPluginTbody(this)],this.autoTips=z.Sm,this.pluginTableClick=j=>{this.openDrawer("editConfig",j.data)},this.closeModal=j=>{j&&this.getPluginsList(),this.drawerRef?.close()},this.navigationService.reqFlashBreadcrumb([{title:"\u7f51\u5173\u96c6\u7fa4",routerLink:"deploy/cluster"},{title:"\u8282\u70b9\u63d2\u4ef6"}])}ngOnInit(){this.clusterName=this.baseInfo.allParamsInfo.clusterName,this.clusterName||this.router.navigate(["/"]),this.getPluginsList()}ngAfterViewInit(){this.pluginsTableBody[0].title=this.operatorStatusTpl,this.pluginsTableBody[1].title=this.publishStatusTpl,this.pluginsTableBody[2].title=this.pluginStatusTpl}getPluginsList(){this.api.get("cluster/"+this.clusterName+"/plugins").subscribe(t=>{0===t.code&&(this.pluginsList=t.data.plugins)})}disabledEdit(t){this.nzDisabled=t}delete(t,n){n?.stopPropagation(),this.modalService.create({nzTitle:"\u5220\u9664",nzContent:"\u8be5\u6570\u636e\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u627e\u56de\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\uff1f",nzClosable:!0,nzClassName:"delete-modal",nzWidth:v.G_,nzOkDanger:!0,nzOnOk:()=>{this.deleteConfig(t)}})}deleteConfig(t){this.api.delete("cluster/"+this.clusterName+"/variable",{key:t.key}).subscribe(n=>{0===n.code&&(this.message.success(n.msg||"\u5220\u9664\u6210\u529f",{nzDuration:1e3}),this.getPluginsList())})}openDrawer(t,n,u){switch(u?.stopPropagation(),t){case"editConfig":this.drawerRef=this.modalService.create({nzTitle:"\u7f16\u8f91\u914d\u7f6e",nzWidth:v.iE,nzContent:Pn,nzComponentParams:{clusterName:this.clusterName,editData:n,closeModal:this.closeModal,nzDisabled:this.nzDisabled},nzOkDisabled:this.nzDisabled,nzOkText:"\u63d0\u4ea4",nzOnOk:d=>(d.save(),!1)});break;case"operateRecords":this.drawerRef=this.modalService.create({nzTitle:"\u66f4\u6539\u5386\u53f2",nzWidth:v.iE,nzContent:Bn,nzComponentParams:{publishTypeTpl:this.publishTypeTpl,clusterName:this.clusterName},nzFooter:null});break;case"publishRecords":this.drawerRef=this.modalService.create({nzTitle:"\u53d1\u5e03\u5386\u53f2",nzWidth:v.iE,nzContent:Yn,nzComponentParams:{clusterName:this.clusterName,publishTypeTpl:this.publishTypeTpl},nzFooter:null});break;case"publish":this.drawerRef=this.modalService.create({nzTitle:"\u53d1\u5e03",nzWidth:v.iE,nzContent:xn,nzComponentParams:{clusterName:this.clusterName,publishTypeTpl:this.publishTypeTpl,closeModal:this.closeModal},nzOkDisabled:this.nzDisabled,nzOkText:"\u63d0\u4ea4",nzOnOk:d=>(d.save(),!1)})}}copyCallback(){this.message.success("\u590d\u5236\u6210\u529f",{nzDuration:1e3})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(Z.D),e.Y36(p.VY),e.Y36(p._B),e.Y36(T.s),e.Y36(N.F0),e.Y36(C.a),e.Y36(W))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-deploy-cluster-plugin"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Qn,7,e.Rgc),e.Gf(qn,7,e.Rgc),e.Gf(Hn,7,e.Rgc),e.Gf(Vn,7,e.Rgc)),2&t){let u;e.iGM(u=e.CRH())&&(n.operatorStatusTpl=u.first),e.iGM(u=e.CRH())&&(n.publishStatusTpl=u.first),e.iGM(u=e.CRH())&&(n.publishTypeTpl=u.first),e.iGM(u=e.CRH())&&(n.pluginStatusTpl=u.first)}},decls:20,vars:4,consts:[[1,""],[1,"list-header","pl-btnbase","pr-btnrbase","py-btnybase","flex","flex-nowrap","items-center","justify-between"],["eo-ng-button","","eoNgUserAccess","deploy/cluster",1,"ant-btn-primary",3,"click","disabledEdit"],["eo-ng-button","",1,"ml-btnybase","floatR",3,"click"],["eo-ng-button","",1,"floatR",3,"click"],[1,"list-content"],[1,"",3,"nzTbody","nzThead","nzData","nzMaxOperatorButton","nzDataChange"],["operatorStatusTpl",""],["publishStatusTpl",""],["publishTypeTpl",""],["pluginStatusTpl",""],[1,"leading-[22px]","flex","items-center"],["eoNgFeedbackTooltip","","nzTooltipPlacement","top","nzTooltipTrigger","hover",1,"truncate",3,"nzTooltipTitle","nzTooltipVisible"],[3,"ngSwitch"],["class","status-new-icon",4,"ngSwitchCase"],["class","status-change-icon",4,"ngSwitchCase"],["class","status-delete-icon",4,"ngSwitchCase"],["eo-copy","","nzType","primary",1,"h-[20px]","leading-[22px]","text-[12px]","opacity-0","cursor-pointer","inline-flex","items-center",3,"copyText","copyCallback","click"],[1,"iconpark-icon"],["href","#copy"],[1,"status-new-icon"],[1,"status-change-icon"],[1,"status-delete-icon"],["class","red-bold",4,"ngSwitchCase"],["class","green-bold",4,"ngSwitchCase"],["style","font-weight: bold",4,"ngSwitchCase"],[1,"red-bold"],[1,"green-bold"],[2,"font-weight","bold"],["class","grey-bold",4,"ngSwitchCase"],[1,"grey-bold"],["class","blue-bold",4,"ngSwitchCase"],[1,"blue-bold"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),e.NdJ("click",function(){return n.openDrawer("publish")})("disabledEdit",function(d){return n.disabledEdit(d)}),e._uU(4," \u53d1\u5e03 "),e.qZA()(),e.TgZ(5,"div")(6,"button",3),e.NdJ("click",function(){return n.openDrawer("publishRecords")}),e._uU(7," \u53d1\u5e03\u5386\u53f2 "),e.qZA(),e.TgZ(8,"button",4),e.NdJ("click",function(){return n.openDrawer("operateRecords")}),e._uU(9," \u66f4\u6539\u5386\u53f2 "),e.qZA()()(),e.TgZ(10,"div",5)(11,"eo-ng-apinto-table",6),e.NdJ("nzDataChange",function(d){return n.pluginsList=d}),e.qZA()()(),e.YNc(12,Kn,10,8,"ng-template",null,7,e.W1O),e.YNc(14,ti,4,4,"ng-template",null,8,e.W1O),e.YNc(16,ai,4,4,"ng-template",null,9,e.W1O),e.YNc(18,ui,4,4,"ng-template",null,10,e.W1O)),2&t&&(e.xp6(11),e.Q6J("nzTbody",n.pluginsTableBody)("nzThead",n.pluginsTableHeadName)("nzData",n.pluginsList)("nzMaxOperatorButton",1))},dependencies:[_.RF,_.n9,p.Cl,M.qK,y.g,O.a,re.jw],encapsulation:2}),o})()},{path:"message",component:(()=>{class o{constructor(t,n,u,d,S,L,Y){this.message=t,this.api=n,this.router=u,this.fb=d,this.service=S,this.baseInfo=L,this.navigationService=Y,this.clusterName="",this.validateForm=new h.cw({}),this.environmentList=[],this.submitButtonLoading=!1,this.autoTips=z.Sm,this.validateForm=this.fb.group({title:["",[h.kI.required]],env:["",[h.kI.required]],desc:[""]})}ngOnInit(){this.navigationService.reqFlashBreadcrumb([{title:"\u7f51\u5173\u96c6\u7fa4",routerLink:"deploy/cluster"},{title:"\u96c6\u7fa4\u7ba1\u7406"}]),this.clusterName=this.baseInfo.allParamsInfo.clusterName,this.getClusterMessage(),this.getEnvList()}getClusterMessage(){this.api.get("cluster",{clusterName:this.clusterName}).subscribe(t=>{0===t.code&&(this.service.clusterDesc=t.data.cluster.desc,this.service.clusterName=t.data.cluster.title,(0,Pe.m)(this.validateForm,t.data.cluster))})}getEnvList(){this.api.get("enum/envs").subscribe(t=>{0===t.code&&(this.environmentList=t.data.envs.map(n=>({label:n.name,value:n.value})),this.validateForm.controls.env.setValue(this.environmentList[0].value),this.validateForm.controls.env.updateValueAndValidity({onlySelf:!0}))})}saveCluster(){this.validateForm.valid?(this.submitButtonLoading=!0,this.api.put(`cluster/${this.clusterName}`,{env:this.validateForm.controls.env.value,title:this.validateForm.controls.title.value,desc:this.validateForm.controls.desc.value}).subscribe(t=>{this.submitButtonLoading=!1,0===t.code&&(this.service.clusterDesc=this.validateForm.controls.desc.value,this.service.clusterName=this.validateForm.controls.title.value,this.message.success(t.msg||"\u4fee\u6539\u96c6\u7fa4\u4fe1\u606f\u6210\u529f"))})):Object.values(this.validateForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.VY),e.Y36(T.s),e.Y36(N.F0),e.Y36(h.QS),e.Y36(W),e.Y36(Z.D),e.Y36(C.a))},o.\u0275cmp=e.Xpm({type:o,selectors:[["eo-ng-cluster-message"]],decls:22,vars:13,consts:[[1,""],["nz-form","",3,"nzNoColon","nzAutoTips","formGroup"],[1,"mt-formtop"],["nzRequired","",3,"nzSpan"],[3,"nzSpan"],["eo-ng-input","","formControlName","title","placeholder","\u8bf7\u8f93\u5165\u96c6\u7fa4\u540d\u79f0",1,"w-INPUT_NORMAL"],["clusterNameInput",""],["formControlName","env","nzAllowClear","",1,"w-INPUT_NORMAL",3,"nzOptions"],[1,"mb-0"],["rows","6","eo-ng-input","","formControlName","desc","placeholder","\u8bf7\u8f93\u5165","eoNgUserAccess","deploy/cluster",1,"w-INPUT_NORMAL"],[1,"mb-0","sticky","bg-white","bottom-0","py-mbase","z-50"],[3,"nzOffset","nzSpan"],["type","submit","eo-ng-button","","eoNgUserAccess","deploy/cluster",1,"ant-btn-primary",3,"nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"form",1)(2,"nz-form-item",2)(3,"nz-form-label",3),e._uU(4,"\u96c6\u7fa4\u540d\u79f0\uff1a"),e.qZA(),e.TgZ(5,"nz-form-control",4),e._UZ(6,"input",5,6),e.qZA()(),e.TgZ(8,"nz-form-item")(9,"nz-form-label",3),e._uU(10,"\u73af\u5883\uff1a"),e.qZA(),e.TgZ(11,"nz-form-control",4),e._UZ(12,"eo-ng-select",7),e.qZA()(),e.TgZ(13,"nz-form-item",8)(14,"nz-form-label",4),e._uU(15,"\u63cf\u8ff0\uff1a"),e.qZA(),e.TgZ(16,"nz-form-control",4),e._UZ(17,"textarea",9),e.qZA()(),e.TgZ(18,"nz-form-item",10)(19,"nz-form-control",11)(20,"button",12),e.NdJ("click",function(){return n.saveCluster()}),e._uU(21," \u63d0\u4ea4 "),e.qZA()()()()()),2&t&&(e.xp6(1),e.Q6J("nzNoColon",!0)("nzAutoTips",n.autoTips)("formGroup",n.validateForm),e.xp6(2),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12),e.xp6(4),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12),e.xp6(1),e.Q6J("nzOptions",n.environmentList),e.xp6(2),e.Q6J("nzSpan",7),e.xp6(2),e.Q6J("nzSpan",12),e.xp6(3),e.Q6J("nzOffset",7)("nzSpan",12),e.xp6(1),e.Q6J("nzLoading",n.submitButtonLoading))},dependencies:[m.Hf,h._Y,h.Fj,h.JJ,h.JL,E.oO,M.qK,F.t3,F.SK,f.Lr,f.Nx,f.iK,f.Fd,h.sg,h.u,y.g],encapsulation:2}),o})()}]}]},{path:"variable",component:nn,data:{id:"102",parentId:"1"},children:[{path:"",component:_n},{path:"create",component:tn}]},{path:"plugin",component:Cn,children:[{path:"",component:Nn},{path:"create",component:Be},{path:"message/:pluginName",component:En}]}]}];let ci=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[N.Bz.forChild(pi),N.Bz]}),o})();var di=b(6681),hi=b(3278),mi=b(7127),gi=b(8694),fi=b(8019),bi=b(9356),_i=b(2129),Ci=b(8002),yi=b(605),Ti=b(1293),vi=b(4383),zi=b(8213),Di=b(7218),Fi=b(8284),Ai=b(5156),Ni=b(7570),Ei=b(2732),wi=b(2968),xi=b(7901),Si=b(3111),ki=b(445),Pi=b(4903),Bi=b(6287),Zi=b(2382);let Ri=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[ki.vT,_.ez,Zi.PV,Bi.T,Pi.g]}),o})(),Mi=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[bi.pM,_i.XS,_.ez,di._,m.HO,h.u5,Ei.D,yi.Q7,p.hB,p.mx,ee.iJ,mi.um,ae.HQ,E.FC,hi.YT,Ti.Sn,fi.Hb,gi.l,Ci.r,vi.Rt,M.r1,wi.m,f.U5,h.UX,Fi.wm,Ni.cg,zi.Wr,F.Jb,Ai.Qp,Di.C,xi.Z,ci,Si.a,Ri,re.WF,Ue.V]}),o})()},4196:(le,Q,b)=>{"use strict";b.d(Q,{s:()=>N});var _=b(4650);let N=(()=>{class v{constructor(){this.dataType=["string","boolean","number","integer"],this.jsonKey=["eo:type","dependencies","skill","switch","label","ui:sort","properties","type"]}handleJsonSchema2Json(z){const D={};for(const e in z.properties){const p=z.properties[e],T=p.type;if(!this.jsonKey.includes(e))if(D[e]={},this.dataType.includes(T)||"object"===T||"array"===T)if("array"===T){const C=p.items;D[e]=this.dataType.includes(C.type)?!1===C.required?C.default||null:C.default||["string"===C.type?!1!==C.required&&C?.enum?.length>0?C.enum[0]:!1===C.required?null:"":"number"===C.type?!1!==C.required&&C.enum.length>0?C.enum[0]:!1===C.required?null:0:"boolean"===C.type?!1!==C.required&&C.enum.length>0?C.enum[0]:!1===C.required&&null:null]:[this.handleJsonSchema2Json(C)]}else"object"===T?D[e]=this.handleJsonSchema2Json(p):"number"===T||"integer"===T?D[e]=!1!==p.required&&p?.enum?.length>0?p.enum[0]:!1===p.required?null:0:"boolean"===T?D[e]=!1!==p.required&&p?.enum?.length>0?p.enum[0]:!1===p.required&&null:"string"===T&&(D[e]=!1!==p.required&&p?.enum?.length>0?p.enum[0]:!1===p.required?null:"");else D[e]=p.default||""}return D}}return v.\u0275fac=function(z){return new(z||v)},v.\u0275prov=_.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},5343:(le,Q)=>{"use strict";Q.byteLength=function e(f){var y=D(f),U=y[1];return 3*(y[0]+U)/4-U},Q.toByteArray=function T(f){var y,H,x=D(f),U=x[0],J=x[1],B=new N(function p(f,y,x){return 3*(y+x)/4-x}(0,U,J)),q=0,G=J>0?U-4:U;for(H=0;H<G;H+=4)y=_[f.charCodeAt(H)]<<18|_[f.charCodeAt(H+1)]<<12|_[f.charCodeAt(H+2)]<<6|_[f.charCodeAt(H+3)],B[q++]=y>>16&255,B[q++]=y>>8&255,B[q++]=255&y;return 2===J&&(y=_[f.charCodeAt(H)]<<2|_[f.charCodeAt(H+1)]>>4,B[q++]=255&y),1===J&&(y=_[f.charCodeAt(H)]<<10|_[f.charCodeAt(H+1)]<<4|_[f.charCodeAt(H+2)]>>2,B[q++]=y>>8&255,B[q++]=255&y),B},Q.fromByteArray=function F(f){for(var y,x=f.length,U=x%3,J=[],B=16383,q=0,G=x-U;q<G;q+=B)J.push(E(f,q,q+B>G?G:q+B));return 1===U?J.push(b[(y=f[x-1])>>2]+b[y<<4&63]+"=="):2===U&&J.push(b[(y=(f[x-2]<<8)+f[x-1])>>10]+b[y>>4&63]+b[y<<2&63]+"="),J.join("")};for(var b=[],_=[],N=typeof Uint8Array<"u"?Uint8Array:Array,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,z=v.length;h<z;++h)b[h]=v[h],_[v.charCodeAt(h)]=h;function D(f){var y=f.length;if(y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=f.indexOf("=");return-1===x&&(x=y),[x,x===y?0:4-x%4]}function C(f){return b[f>>18&63]+b[f>>12&63]+b[f>>6&63]+b[63&f]}function E(f,y,x){for(var J=[],B=y;B<x;B+=3)J.push(C((f[B]<<16&16711680)+(f[B+1]<<8&65280)+(255&f[B+2])));return J.join("")}_["-".charCodeAt(0)]=62,_["_".charCodeAt(0)]=63},3172:(le,Q,b)=>{"use strict";var N=b(5343),v=b(8461),h="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;Q.lW=p,Q.h2=50;var z=2147483647;function e(r){if(r>z)throw new RangeError('The value "'+r+'" is invalid for option "size"');var i=new Uint8Array(r);return Object.setPrototypeOf(i,p.prototype),i}function p(r,i,a){if("number"==typeof r){if("string"==typeof i)throw new TypeError('The "string" argument must be of type string. Received type number');return F(r)}return T(r,i,a)}function T(r,i,a){if("string"==typeof r)return function f(r,i){if(("string"!=typeof i||""===i)&&(i="utf8"),!p.isEncoding(i))throw new TypeError("Unknown encoding: "+i);var a=0|G(r,i),l=e(a),c=l.write(r,i);return c!==a&&(l=l.slice(0,c)),l}(r,i);if(ArrayBuffer.isView(r))return function x(r){if(V(r,Uint8Array)){var i=new Uint8Array(r);return U(i.buffer,i.byteOffset,i.byteLength)}return y(r)}(r);if(null==r)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(V(r,ArrayBuffer)||r&&V(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(V(r,SharedArrayBuffer)||r&&V(r.buffer,SharedArrayBuffer)))return U(r,i,a);if("number"==typeof r)throw new TypeError('The "value" argument must not be of type number. Received type number');var l=r.valueOf&&r.valueOf();if(null!=l&&l!==r)return p.from(l,i,a);var c=function J(r){if(p.isBuffer(r)){var i=0|B(r.length),a=e(i);return 0===a.length||r.copy(a,0,0,i),a}return void 0!==r.length?"number"!=typeof r.length||oe(r.length)?e(0):y(r):"Buffer"===r.type&&Array.isArray(r.data)?y(r.data):void 0}(r);if(c)return c;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof r[Symbol.toPrimitive])return p.from(r[Symbol.toPrimitive]("string"),i,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}function C(r){if("number"!=typeof r)throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function F(r){return C(r),e(r<0?0:0|B(r))}function y(r){for(var i=r.length<0?0:0|B(r.length),a=e(i),l=0;l<i;l+=1)a[l]=255&r[l];return a}function U(r,i,a){if(i<0||r.byteLength<i)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<i+(a||0))throw new RangeError('"length" is outside of buffer bounds');var l;return l=void 0===i&&void 0===a?new Uint8Array(r):void 0===a?new Uint8Array(r,i):new Uint8Array(r,i,a),Object.setPrototypeOf(l,p.prototype),l}function B(r){if(r>=z)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+z.toString(16)+" bytes");return 0|r}function G(r,i){if(p.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||V(r,ArrayBuffer))return r.byteLength;if("string"!=typeof r)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);var a=r.length,l=arguments.length>2&&!0===arguments[2];if(!l&&0===a)return 0;for(var c=!1;;)switch(i){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":return ee(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a;case"hex":return a>>>1;case"base64":return _e(r).length;default:if(c)return l?-1:ee(r).length;i=(""+i).toLowerCase(),c=!0}}function H(r,i,a){var l=!1;if((void 0===i||i<0)&&(i=0),i>this.length||((void 0===a||a>this.length)&&(a=this.length),a<=0)||(a>>>=0)<=(i>>>=0))return"";for(r||(r="utf8");;)switch(r){case"hex":return Fe(this,i,a);case"utf8":case"utf-8":return he(this,i,a);case"ascii":return X(this,i,a);case"latin1":case"binary":return De(this,i,a);case"base64":return ve(this,i,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ge(this,i,a);default:if(l)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),l=!0}}function K(r,i,a){var l=r[i];r[i]=r[a],r[a]=l}function $(r,i,a,l,c){if(0===r.length)return-1;if("string"==typeof a?(l=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),oe(a=+a)&&(a=c?0:r.length-1),a<0&&(a=r.length+a),a>=r.length){if(c)return-1;a=r.length-1}else if(a<0){if(!c)return-1;a=0}if("string"==typeof i&&(i=p.from(i,l)),p.isBuffer(i))return 0===i.length?-1:ie(r,i,a,l,c);if("number"==typeof i)return i&=255,"function"==typeof Uint8Array.prototype.indexOf?c?Uint8Array.prototype.indexOf.call(r,i,a):Uint8Array.prototype.lastIndexOf.call(r,i,a):ie(r,[i],a,l,c);throw new TypeError("val must be string, number or Buffer")}function ie(r,i,a,l,c){var k,m=1,g=r.length,A=i.length;if(void 0!==l&&("ucs2"===(l=String(l).toLowerCase())||"ucs-2"===l||"utf16le"===l||"utf-16le"===l)){if(r.length<2||i.length<2)return-1;m=2,g/=2,A/=2,a/=2}function w(Ce,ye){return 1===m?Ce[ye]:Ce.readUInt16BE(ye*m)}if(c){var R=-1;for(k=a;k<g;k++)if(w(r,k)===w(i,-1===R?0:k-R)){if(-1===R&&(R=k),k-R+1===A)return R*m}else-1!==R&&(k-=k-R),R=-1}else for(a+A>g&&(a=g-A),k=a;k>=0;k--){for(var P=!0,ne=0;ne<A;ne++)if(w(r,k+ne)!==w(i,ne)){P=!1;break}if(P)return k}return-1}function ue(r,i,a,l){a=Number(a)||0;var c=r.length-a;l?(l=Number(l))>c&&(l=c):l=c;var m=i.length;l>m/2&&(l=m/2);for(var g=0;g<l;++g){var A=parseInt(i.substr(2*g,2),16);if(oe(A))return g;r[a+g]=A}return g}function pe(r,i,a,l){return te(ee(i,r.length-a),r,a,l)}function ce(r,i,a,l){return te(function Ae(r){for(var i=[],a=0;a<r.length;++a)i.push(255&r.charCodeAt(a));return i}(i),r,a,l)}function de(r,i,a,l){return te(_e(i),r,a,l)}function Te(r,i,a,l){return te(function Ne(r,i){for(var a,l,m=[],g=0;g<r.length&&!((i-=2)<0);++g)l=(a=r.charCodeAt(g))>>8,m.push(a%256),m.push(l);return m}(i,r.length-a),r,a,l)}function ve(r,i,a){return N.fromByteArray(0===i&&a===r.length?r:r.slice(i,a))}function he(r,i,a){a=Math.min(r.length,a);for(var l=[],c=i;c<a;){var w,k,R,P,m=r[c],g=null,A=m>239?4:m>223?3:m>191?2:1;if(c+A<=a)switch(A){case 1:m<128&&(g=m);break;case 2:128==(192&(w=r[c+1]))&&(P=(31&m)<<6|63&w)>127&&(g=P);break;case 3:k=r[c+2],128==(192&(w=r[c+1]))&&128==(192&k)&&(P=(15&m)<<12|(63&w)<<6|63&k)>2047&&(P<55296||P>57343)&&(g=P);break;case 4:k=r[c+2],R=r[c+3],128==(192&(w=r[c+1]))&&128==(192&k)&&128==(192&R)&&(P=(15&m)<<18|(63&w)<<12|(63&k)<<6|63&R)>65535&&P<1114112&&(g=P)}null===g?(g=65533,A=1):g>65535&&(l.push((g-=65536)>>>10&1023|55296),g=56320|1023&g),l.push(g),c+=A}return function ze(r){var i=r.length;if(i<=me)return String.fromCharCode.apply(String,r);for(var a="",l=0;l<i;)a+=String.fromCharCode.apply(String,r.slice(l,l+=me));return a}(l)}!(p.TYPED_ARRAY_SUPPORT=function D(){try{var r=new Uint8Array(1),i={foo:function(){return 42}};return Object.setPrototypeOf(i,Uint8Array.prototype),Object.setPrototypeOf(r,i),42===r.foo()}catch{return!1}}())&&typeof console<"u"&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(p.prototype,"parent",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.buffer}}),Object.defineProperty(p.prototype,"offset",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.byteOffset}}),p.poolSize=8192,p.from=function(r,i,a){return T(r,i,a)},Object.setPrototypeOf(p.prototype,Uint8Array.prototype),Object.setPrototypeOf(p,Uint8Array),p.alloc=function(r,i,a){return function E(r,i,a){return C(r),r<=0?e(r):void 0!==i?"string"==typeof a?e(r).fill(i,a):e(r).fill(i):e(r)}(r,i,a)},p.allocUnsafe=function(r){return F(r)},p.allocUnsafeSlow=function(r){return F(r)},p.isBuffer=function(i){return null!=i&&!0===i._isBuffer&&i!==p.prototype},p.compare=function(i,a){if(V(i,Uint8Array)&&(i=p.from(i,i.offset,i.byteLength)),V(a,Uint8Array)&&(a=p.from(a,a.offset,a.byteLength)),!p.isBuffer(i)||!p.isBuffer(a))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(i===a)return 0;for(var l=i.length,c=a.length,m=0,g=Math.min(l,c);m<g;++m)if(i[m]!==a[m]){l=i[m],c=a[m];break}return l<c?-1:c<l?1:0},p.isEncoding=function(i){switch(String(i).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(i,a){if(!Array.isArray(i))throw new TypeError('"list" argument must be an Array of Buffers');if(0===i.length)return p.alloc(0);var l;if(void 0===a)for(a=0,l=0;l<i.length;++l)a+=i[l].length;var c=p.allocUnsafe(a),m=0;for(l=0;l<i.length;++l){var g=i[l];if(V(g,Uint8Array))m+g.length>c.length?p.from(g).copy(c,m):Uint8Array.prototype.set.call(c,g,m);else{if(!p.isBuffer(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(c,m)}m+=g.length}return c},p.byteLength=G,p.prototype._isBuffer=!0,p.prototype.swap16=function(){var i=this.length;if(i%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<i;a+=2)K(this,a,a+1);return this},p.prototype.swap32=function(){var i=this.length;if(i%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<i;a+=4)K(this,a,a+3),K(this,a+1,a+2);return this},p.prototype.swap64=function(){var i=this.length;if(i%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<i;a+=8)K(this,a,a+7),K(this,a+1,a+6),K(this,a+2,a+5),K(this,a+3,a+4);return this},p.prototype.toLocaleString=p.prototype.toString=function(){var i=this.length;return 0===i?"":0===arguments.length?he(this,0,i):H.apply(this,arguments)},p.prototype.equals=function(i){if(!p.isBuffer(i))throw new TypeError("Argument must be a Buffer");return this===i||0===p.compare(this,i)},p.prototype.inspect=function(){var i="",a=Q.h2;return i=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(i+=" ... "),"<Buffer "+i+">"},h&&(p.prototype[h]=p.prototype.inspect),p.prototype.compare=function(i,a,l,c,m){if(V(i,Uint8Array)&&(i=p.from(i,i.offset,i.byteLength)),!p.isBuffer(i))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof i);if(void 0===a&&(a=0),void 0===l&&(l=i?i.length:0),void 0===c&&(c=0),void 0===m&&(m=this.length),a<0||l>i.length||c<0||m>this.length)throw new RangeError("out of range index");if(c>=m&&a>=l)return 0;if(c>=m)return-1;if(a>=l)return 1;if(this===i)return 0;for(var g=(m>>>=0)-(c>>>=0),A=(l>>>=0)-(a>>>=0),w=Math.min(g,A),k=this.slice(c,m),R=i.slice(a,l),P=0;P<w;++P)if(k[P]!==R[P]){g=k[P],A=R[P];break}return g<A?-1:A<g?1:0},p.prototype.includes=function(i,a,l){return-1!==this.indexOf(i,a,l)},p.prototype.indexOf=function(i,a,l){return $(this,i,a,l,!0)},p.prototype.lastIndexOf=function(i,a,l){return $(this,i,a,l,!1)},p.prototype.write=function(i,a,l,c){if(void 0===a)c="utf8",l=this.length,a=0;else if(void 0===l&&"string"==typeof a)c=a,l=this.length,a=0;else{if(!isFinite(a))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");a>>>=0,isFinite(l)?(l>>>=0,void 0===c&&(c="utf8")):(c=l,l=void 0)}var m=this.length-a;if((void 0===l||l>m)&&(l=m),i.length>0&&(l<0||a<0)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");c||(c="utf8");for(var g=!1;;)switch(c){case"hex":return ue(this,i,a,l);case"utf8":case"utf-8":return pe(this,i,a,l);case"ascii":case"latin1":case"binary":return ce(this,i,a,l);case"base64":return de(this,i,a,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Te(this,i,a,l);default:if(g)throw new TypeError("Unknown encoding: "+c);c=(""+c).toLowerCase(),g=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var me=4096;function X(r,i,a){var l="";a=Math.min(r.length,a);for(var c=i;c<a;++c)l+=String.fromCharCode(127&r[c]);return l}function De(r,i,a){var l="";a=Math.min(r.length,a);for(var c=i;c<a;++c)l+=String.fromCharCode(r[c]);return l}function Fe(r,i,a){var l=r.length;(!i||i<0)&&(i=0),(!a||a<0||a>l)&&(a=l);for(var c="",m=i;m<a;++m)c+=Ee[r[m]];return c}function ge(r,i,a){for(var l=r.slice(i,a),c="",m=0;m<l.length-1;m+=2)c+=String.fromCharCode(l[m]+256*l[m+1]);return c}function I(r,i,a){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+i>a)throw new RangeError("Trying to access beyond buffer length")}function Z(r,i,a,l,c,m){if(!p.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(i>c||i<m)throw new RangeError('"value" argument is out of bounds');if(a+l>r.length)throw new RangeError("Index out of range")}function M(r,i,a,l,c,m){if(a+l>r.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function O(r,i,a,l,c){return i=+i,a>>>=0,c||M(r,0,a,4),v.write(r,i,a,l,23,4),a+4}function fe(r,i,a,l,c){return i=+i,a>>>=0,c||M(r,0,a,8),v.write(r,i,a,l,52,8),a+8}p.prototype.slice=function(i,a){var l=this.length;(i=~~i)<0?(i+=l)<0&&(i=0):i>l&&(i=l),(a=void 0===a?l:~~a)<0?(a+=l)<0&&(a=0):a>l&&(a=l),a<i&&(a=i);var c=this.subarray(i,a);return Object.setPrototypeOf(c,p.prototype),c},p.prototype.readUintLE=p.prototype.readUIntLE=function(i,a,l){i>>>=0,a>>>=0,l||I(i,a,this.length);for(var c=this[i],m=1,g=0;++g<a&&(m*=256);)c+=this[i+g]*m;return c},p.prototype.readUintBE=p.prototype.readUIntBE=function(i,a,l){i>>>=0,a>>>=0,l||I(i,a,this.length);for(var c=this[i+--a],m=1;a>0&&(m*=256);)c+=this[i+--a]*m;return c},p.prototype.readUint8=p.prototype.readUInt8=function(i,a){return i>>>=0,a||I(i,1,this.length),this[i]},p.prototype.readUint16LE=p.prototype.readUInt16LE=function(i,a){return i>>>=0,a||I(i,2,this.length),this[i]|this[i+1]<<8},p.prototype.readUint16BE=p.prototype.readUInt16BE=function(i,a){return i>>>=0,a||I(i,2,this.length),this[i]<<8|this[i+1]},p.prototype.readUint32LE=p.prototype.readUInt32LE=function(i,a){return i>>>=0,a||I(i,4,this.length),(this[i]|this[i+1]<<8|this[i+2]<<16)+16777216*this[i+3]},p.prototype.readUint32BE=p.prototype.readUInt32BE=function(i,a){return i>>>=0,a||I(i,4,this.length),16777216*this[i]+(this[i+1]<<16|this[i+2]<<8|this[i+3])},p.prototype.readIntLE=function(i,a,l){i>>>=0,a>>>=0,l||I(i,a,this.length);for(var c=this[i],m=1,g=0;++g<a&&(m*=256);)c+=this[i+g]*m;return c>=(m*=128)&&(c-=Math.pow(2,8*a)),c},p.prototype.readIntBE=function(i,a,l){i>>>=0,a>>>=0,l||I(i,a,this.length);for(var c=a,m=1,g=this[i+--c];c>0&&(m*=256);)g+=this[i+--c]*m;return g>=(m*=128)&&(g-=Math.pow(2,8*a)),g},p.prototype.readInt8=function(i,a){return i>>>=0,a||I(i,1,this.length),128&this[i]?-1*(255-this[i]+1):this[i]},p.prototype.readInt16LE=function(i,a){i>>>=0,a||I(i,2,this.length);var l=this[i]|this[i+1]<<8;return 32768&l?4294901760|l:l},p.prototype.readInt16BE=function(i,a){i>>>=0,a||I(i,2,this.length);var l=this[i+1]|this[i]<<8;return 32768&l?4294901760|l:l},p.prototype.readInt32LE=function(i,a){return i>>>=0,a||I(i,4,this.length),this[i]|this[i+1]<<8|this[i+2]<<16|this[i+3]<<24},p.prototype.readInt32BE=function(i,a){return i>>>=0,a||I(i,4,this.length),this[i]<<24|this[i+1]<<16|this[i+2]<<8|this[i+3]},p.prototype.readFloatLE=function(i,a){return i>>>=0,a||I(i,4,this.length),v.read(this,i,!0,23,4)},p.prototype.readFloatBE=function(i,a){return i>>>=0,a||I(i,4,this.length),v.read(this,i,!1,23,4)},p.prototype.readDoubleLE=function(i,a){return i>>>=0,a||I(i,8,this.length),v.read(this,i,!0,52,8)},p.prototype.readDoubleBE=function(i,a){return i>>>=0,a||I(i,8,this.length),v.read(this,i,!1,52,8)},p.prototype.writeUintLE=p.prototype.writeUIntLE=function(i,a,l,c){i=+i,a>>>=0,l>>>=0,c||Z(this,i,a,l,Math.pow(2,8*l)-1,0);var g=1,A=0;for(this[a]=255&i;++A<l&&(g*=256);)this[a+A]=i/g&255;return a+l},p.prototype.writeUintBE=p.prototype.writeUIntBE=function(i,a,l,c){i=+i,a>>>=0,l>>>=0,c||Z(this,i,a,l,Math.pow(2,8*l)-1,0);var g=l-1,A=1;for(this[a+g]=255&i;--g>=0&&(A*=256);)this[a+g]=i/A&255;return a+l},p.prototype.writeUint8=p.prototype.writeUInt8=function(i,a,l){return i=+i,a>>>=0,l||Z(this,i,a,1,255,0),this[a]=255&i,a+1},p.prototype.writeUint16LE=p.prototype.writeUInt16LE=function(i,a,l){return i=+i,a>>>=0,l||Z(this,i,a,2,65535,0),this[a]=255&i,this[a+1]=i>>>8,a+2},p.prototype.writeUint16BE=p.prototype.writeUInt16BE=function(i,a,l){return i=+i,a>>>=0,l||Z(this,i,a,2,65535,0),this[a]=i>>>8,this[a+1]=255&i,a+2},p.prototype.writeUint32LE=p.prototype.writeUInt32LE=function(i,a,l){return i=+i,a>>>=0,l||Z(this,i,a,4,4294967295,0),this[a+3]=i>>>24,this[a+2]=i>>>16,this[a+1]=i>>>8,this[a]=255&i,a+4},p.prototype.writeUint32BE=p.prototype.writeUInt32BE=function(i,a,l){return i=+i,a>>>=0,l||Z(this,i,a,4,4294967295,0),this[a]=i>>>24,this[a+1]=i>>>16,this[a+2]=i>>>8,this[a+3]=255&i,a+4},p.prototype.writeIntLE=function(i,a,l,c){if(i=+i,a>>>=0,!c){var m=Math.pow(2,8*l-1);Z(this,i,a,l,m-1,-m)}var g=0,A=1,w=0;for(this[a]=255&i;++g<l&&(A*=256);)i<0&&0===w&&0!==this[a+g-1]&&(w=1),this[a+g]=(i/A>>0)-w&255;return a+l},p.prototype.writeIntBE=function(i,a,l,c){if(i=+i,a>>>=0,!c){var m=Math.pow(2,8*l-1);Z(this,i,a,l,m-1,-m)}var g=l-1,A=1,w=0;for(this[a+g]=255&i;--g>=0&&(A*=256);)i<0&&0===w&&0!==this[a+g+1]&&(w=1),this[a+g]=(i/A>>0)-w&255;return a+l},p.prototype.writeInt8=function(i,a,l){return i=+i,a>>>=0,l||Z(this,i,a,1,127,-128),i<0&&(i=255+i+1),this[a]=255&i,a+1},p.prototype.writeInt16LE=function(i,a,l){return i=+i,a>>>=0,l||Z(this,i,a,2,32767,-32768),this[a]=255&i,this[a+1]=i>>>8,a+2},p.prototype.writeInt16BE=function(i,a,l){return i=+i,a>>>=0,l||Z(this,i,a,2,32767,-32768),this[a]=i>>>8,this[a+1]=255&i,a+2},p.prototype.writeInt32LE=function(i,a,l){return i=+i,a>>>=0,l||Z(this,i,a,4,2147483647,-2147483648),this[a]=255&i,this[a+1]=i>>>8,this[a+2]=i>>>16,this[a+3]=i>>>24,a+4},p.prototype.writeInt32BE=function(i,a,l){return i=+i,a>>>=0,l||Z(this,i,a,4,2147483647,-2147483648),i<0&&(i=4294967295+i+1),this[a]=i>>>24,this[a+1]=i>>>16,this[a+2]=i>>>8,this[a+3]=255&i,a+4},p.prototype.writeFloatLE=function(i,a,l){return O(this,i,a,!0,l)},p.prototype.writeFloatBE=function(i,a,l){return O(this,i,a,!1,l)},p.prototype.writeDoubleLE=function(i,a,l){return fe(this,i,a,!0,l)},p.prototype.writeDoubleBE=function(i,a,l){return fe(this,i,a,!1,l)},p.prototype.copy=function(i,a,l,c){if(!p.isBuffer(i))throw new TypeError("argument should be a Buffer");if(l||(l=0),!c&&0!==c&&(c=this.length),a>=i.length&&(a=i.length),a||(a=0),c>0&&c<l&&(c=l),c===l||0===i.length||0===this.length)return 0;if(a<0)throw new RangeError("targetStart out of bounds");if(l<0||l>=this.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("sourceEnd out of bounds");c>this.length&&(c=this.length),i.length-a<c-l&&(c=i.length-a+l);var m=c-l;return this===i&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(a,l,c):Uint8Array.prototype.set.call(i,this.subarray(l,c),a),m},p.prototype.fill=function(i,a,l,c){if("string"==typeof i){if("string"==typeof a?(c=a,a=0,l=this.length):"string"==typeof l&&(c=l,l=this.length),void 0!==c&&"string"!=typeof c)throw new TypeError("encoding must be a string");if("string"==typeof c&&!p.isEncoding(c))throw new TypeError("Unknown encoding: "+c);if(1===i.length){var m=i.charCodeAt(0);("utf8"===c&&m<128||"latin1"===c)&&(i=m)}}else"number"==typeof i?i&=255:"boolean"==typeof i&&(i=Number(i));if(a<0||this.length<a||this.length<l)throw new RangeError("Out of range index");if(l<=a)return this;var g;if(a>>>=0,l=void 0===l?this.length:l>>>0,i||(i=0),"number"==typeof i)for(g=a;g<l;++g)this[g]=i;else{var A=p.isBuffer(i)?i:p.from(i,c),w=A.length;if(0===w)throw new TypeError('The value "'+i+'" is invalid for argument "value"');for(g=0;g<l-a;++g)this[g+a]=A[g%w]}return this};var be=/[^+/0-9A-Za-z-_]/g;function ee(r,i){i=i||1/0;for(var a,l=r.length,c=null,m=[],g=0;g<l;++g){if((a=r.charCodeAt(g))>55295&&a<57344){if(!c){if(a>56319){(i-=3)>-1&&m.push(239,191,189);continue}if(g+1===l){(i-=3)>-1&&m.push(239,191,189);continue}c=a;continue}if(a<56320){(i-=3)>-1&&m.push(239,191,189),c=a;continue}a=65536+(c-55296<<10|a-56320)}else c&&(i-=3)>-1&&m.push(239,191,189);if(c=null,a<128){if((i-=1)<0)break;m.push(a)}else if(a<2048){if((i-=2)<0)break;m.push(a>>6|192,63&a|128)}else if(a<65536){if((i-=3)<0)break;m.push(a>>12|224,a>>6&63|128,63&a|128)}else{if(!(a<1114112))throw new Error("Invalid code point");if((i-=4)<0)break;m.push(a>>18|240,a>>12&63|128,a>>6&63|128,63&a|128)}}return m}function _e(r){return N.toByteArray(function W(r){if((r=(r=r.split("=")[0]).trim().replace(be,"")).length<2)return"";for(;r.length%4!=0;)r+="=";return r}(r))}function te(r,i,a,l){for(var c=0;c<l&&!(c+a>=i.length||c>=r.length);++c)i[c+a]=r[c];return c}function V(r,i){return r instanceof i||null!=r&&null!=r.constructor&&null!=r.constructor.name&&r.constructor.name===i.name}function oe(r){return r!=r}var Ee=function(){for(var r="0123456789abcdef",i=new Array(256),a=0;a<16;++a)for(var l=16*a,c=0;c<16;++c)i[l+c]=r[a]+r[c];return i}()},8461:(le,Q)=>{Q.read=function(b,_,N,v,h){var z,D,e=8*h-v-1,p=(1<<e)-1,T=p>>1,C=-7,E=N?h-1:0,F=N?-1:1,f=b[_+E];for(E+=F,z=f&(1<<-C)-1,f>>=-C,C+=e;C>0;z=256*z+b[_+E],E+=F,C-=8);for(D=z&(1<<-C)-1,z>>=-C,C+=v;C>0;D=256*D+b[_+E],E+=F,C-=8);if(0===z)z=1-T;else{if(z===p)return D?NaN:1/0*(f?-1:1);D+=Math.pow(2,v),z-=T}return(f?-1:1)*D*Math.pow(2,z-v)},Q.write=function(b,_,N,v,h,z){var D,e,p,T=8*z-h-1,C=(1<<T)-1,E=C>>1,F=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,f=v?0:z-1,y=v?1:-1,x=_<0||0===_&&1/_<0?1:0;for(_=Math.abs(_),isNaN(_)||_===1/0?(e=isNaN(_)?1:0,D=C):(D=Math.floor(Math.log(_)/Math.LN2),_*(p=Math.pow(2,-D))<1&&(D--,p*=2),(_+=D+E>=1?F/p:F*Math.pow(2,1-E))*p>=2&&(D++,p/=2),D+E>=C?(e=0,D=C):D+E>=1?(e=(_*p-1)*Math.pow(2,h),D+=E):(e=_*Math.pow(2,E-1)*Math.pow(2,h),D=0));h>=8;b[N+f]=255&e,f+=y,e/=256,h-=8);for(D=D<<h|e,T+=h;T>0;b[N+f]=255&D,f+=y,D/=256,T-=8);b[N+f-y]|=128*x}}}]);