"use strict";(self.webpackChunkapinto=self.webpackChunkapinto||[]).push([[837],{6544:(E,z,a)=>{a.d(z,{O:()=>c});var u=a(4650);let c=(()=>{class h{constructor(g,e){this.renderer=g,this.el=e,this.moveFun=d=>{const f=this.affectDom[0].clientWidth+0+d.movementX;if(f<=this.minWidth||f>=this.maxWidth)return;const C=`${f}px`,r=this.affectDom.length;for(let _=0;_<r;_++)this.affectDom[_].style.width=C},this.affectDom=document.getElementsByClassName("spreed-content")}onMounseDown(g){g.stopPropagation(),document.onmousemove=this.moveFun,document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}}}return h.\u0275fac=function(g){return new(g||h)(u.Y36(u.Qsj),u.Y36(u.SBq))},h.\u0275dir=u.lG2({type:h,selectors:[["","eo-ng-tree-drag",""]],hostBindings:function(g,e){1&g&&u.NdJ("mousedown",function(b){return e.onMounseDown(b)})},inputs:{minWidth:"minWidth",maxWidth:"maxWidth"}}),h})()},3837:(E,z,a)=>{a.r(z),a.d(z,{PluginManagementModule:()=>Ie});var u=a(6895),c=a(9132),h=a(727),x=a(7504),g=a(1461),e=a(4650),d=a(3),b=a(4963),F=a(7579),f=a(8513);let C=(()=>{class i{constructor(t,n){this.api=t,this.baseInfo=n,this.flashFlag=new F.x,this.nodesList=[],this.groupUuid="",this.queryName="",this.showAll=!0,this.radioValue="",this.pluginList=[],this.totalNum=0}reqFlashGroup(){this.flashFlag.next(!0)}repFlashGroup(){return this.flashFlag.asObservable()}reqFlashList(){this.flashFlag.next(!0)}repFlashList(){return this.flashFlag.asObservable()}getPluginList(){this.groupUuid=this.baseInfo.allParamsInfo.pluginGroupId,this.api.get("system/plugin/installed",{group:this.groupUuid||"",search:this.queryName||""}).subscribe(t=>{if(0===t.code){this.nodesList=this.nodesTransfer(t.data.groups),this.totalNum=0;for(const n of this.nodesList)this.totalNum+=n.count||0;this.pluginList=t.data.plugins.map(n=>({...n,title:n.cname,desc:n.resume,iconAddr:n.icon}))}})}nodesTransfer(t){const n=[];for(const o in t)t[o].key=t[o].uuid,t[o].title=`${t[o].name}\uff08${t[o].count||0}\uff09`,this.groupUuid&&t[o].uuid===this.groupUuid&&(t[o].selected=!0,this.showAll=!1),t[o].children?.length>0&&(t[o].children=this.nodesTransfer(t[o].children)),n.push(t[o]);return n}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(d.s),e.LFG(f.D))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var r=a(4006),_=a(4162),T=a(3679),p=a(6704),Z=a(3224);function Y(i,s){1&i&&(e.TgZ(0,"div",8),e.NdJ("click",function(n){return n.stopPropagation()}),e._uU(1," \u5fc5\u586b\u9879 "),e.qZA())}let O=(()=>{class i{constructor(t,n,o){this.api=t,this.message=n,this.service=o,this.autoTips=g.Sm,this.fileError=!1,this.fileList=[],this.beforeUpload=l=>(this.fileList=[],this.fileList=this.fileList.concat(l),this.fileError=0===this.fileList.length,!1)}removeFile(){return this.fileList=[],this.fileError=!0,!0}checkValid(){return this.fileError=0===this.fileList.length,!this.fileError}submit(){if(!this.checkValid())return;const t=new FormData;t.append("plugin",this.fileList[0]),this.api.post("system/plugin/install",t).subscribe(n=>{0===n.code&&(this.message.success(n.msg||"\u5b89\u88c5\u63d2\u4ef6\u6210\u529f"),this.service.getPluginList(),this.closeModal&&this.closeModal())})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.s),e.Y36(b.A),e.Y36(C))},i.\u0275cmp=e.Xpm({type:i,selectors:[["eo-ng-plugin-create"]],decls:11,vars:10,consts:[["nz-form","","autocomplete","off",3,"nzNoColon","nzAutoTips"],[1,"form-row","mb-0"],["nzRequired","",3,"nzSpan"],[3,"nzSpan"],["nzAccept",".zip,.gz",3,"nzFileList","nzBeforeUpload","nzLimit","nzRemove","nzFileListChange"],["id","uploadBtn","eo-ng-button","",3,"nzDanger"],["class","ant-form-item-explain-error",3,"click",4,"ngIf"],[1,"ant-form-item-extra","activation-extra",2,"padding-left","0",3,"click"],[1,"ant-form-item-explain-error",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0)(1,"nz-form-item",1)(2,"nz-form-label",2),e._uU(3,"\u4e0a\u4f20\u6587\u4ef6\uff1a"),e.qZA(),e.TgZ(4,"nz-form-control",3)(5,"nz-upload",4),e.NdJ("nzFileListChange",function(l){return n.fileList=l}),e.TgZ(6,"button",5),e._uU(7," \u9009\u62e9\u6587\u4ef6 "),e.qZA()(),e.YNc(8,Y,2,0,"div",6),e.TgZ(9,"div",7),e.NdJ("click",function(l){return l.stopPropagation()}),e._uU(10," \u4ec5\u652f\u6301\u5b98\u65b9\u63d0\u4f9b\u63d2\u4ef6\u914d\u7f6e\u6a21\u677f\u6587\u4ef6 "),e.qZA()()()()),2&t&&(e.Q6J("nzNoColon",!0)("nzAutoTips",n.autoTips),e.xp6(2),e.Q6J("nzSpan",6),e.xp6(2),e.Q6J("nzSpan",14),e.xp6(1),e.Q6J("nzFileList",n.fileList)("nzBeforeUpload",n.beforeUpload)("nzLimit",1)("nzRemove",n.removeFile),e.xp6(1),e.Q6J("nzDanger",n.fileError),e.xp6(2),e.Q6J("ngIf",n.fileError))},dependencies:[u.O5,r._Y,r.JL,r.F,_.qK,T.t3,T.SK,p.Lr,p.Nx,p.iK,p.Fd,Z.FY],encapsulation:2}),i})();const G=[{label:"\u5168\u90e8",value:""},{label:"\u5df2\u542f\u7528",value:!0},{label:"\u672a\u542f\u7528",value:!1}],Q=[{title:"\u53c2\u6570\u540d"},{title:"\u53c2\u6570\u503c"},{title:"\u63cf\u8ff0"}],q=[{key:"name"},{key:"value",type:"input",placeholderKey:"placeholder"},{key:"desc"}];var A=a(9561),P=a(2266),I=a(4607);function B(i,s){1&i&&(e.TgZ(0,"span",13),e._uU(1,"Apinto \u5185\u7f6e"),e.qZA())}function R(i,s){if(1&i&&(e.ynx(0),e.YNc(1,B,2,0,"span",12),e.BQk()),2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",null==t?null:t.isInner)}}function H(i,s){if(1&i&&e.YNc(0,R,2,1,"ng-container",11),2&i){const t=e.oxw(2);e.Q6J("ngIf","plugin"===t.type)}}function K(i,s){if(1&i&&(e.TgZ(0,"div",14),e._UZ(1,"img",15),e.qZA()),2&i){const t=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Q6J("src",t.iconAddr?n.urlPrefix+"plugin/icon/"+t.id+"/"+t.iconAddr:"./assets/default-plugin-icon.svg",e.LSH)}}function $(i,s){1&i&&(e.TgZ(0,"span",16),e._uU(1,"\u5df2\u542f\u7528"),e.qZA())}function V(i,s){1&i&&(e.TgZ(0,"span",17),e._uU(1," \u672a\u542f\u7528"),e.qZA())}function W(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div")(2,"div",2)(3,"nz-card",3),e.NdJ("click",function(){const l=e.CHM(t).$implicit,m=e.oxw();return e.KtG(m.handlerCardClick(l))}),e._UZ(4,"nz-card-meta",4),e.YNc(5,H,1,1,"ng-template",null,5,e.W1O),e.YNc(7,K,2,1,"ng-template",null,6,e.W1O),e.TgZ(9,"p",7),e._uU(10),e.qZA()(),e.TgZ(11,"div",8),e.YNc(12,$,2,0,"span",9),e.YNc(13,V,2,0,"span",10),e.qZA()()(),e.BQk()}if(2&i){const t=s.$implicit,n=e.MAs(6),o=e.MAs(8);e.xp6(3),e.Q6J("nzHoverable",!0),e.xp6(1),e.Q6J("nzTitle",t.title)("nzDescription",n)("nzAvatar",o),e.xp6(6),e.Oqu(t.desc),e.xp6(2),e.Q6J("ngIf",t.enable),e.xp6(1),e.Q6J("ngIf",!t.enable)}}let j=(()=>{class i{constructor(t){this.urlPrefix=t,this.cardList=[],this.type="plugin",this.cardClick=new e.vpe}handlerCardClick(t){this.cardClick.emit(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.T))},i.\u0275cmp=e.Xpm({type:i,selectors:[["eo-ng-card-list"]],inputs:{cardList:"cardList",type:"type"},outputs:{cardClick:"cardClick"},decls:2,vars:1,consts:[[1,"p-[20px]","grid","gap-6","py-5","2xl:grid-cols-4","xl:grid-cols-3","lg:grid-cols-2","md:grid-cols-1"],[4,"ngFor","ngForOf"],[1,"relative","min-w-[250px]","max-w-[400px]","h-[100%]"],[1,"min-w-[250px]","max-w-[400px]","min-h-[120px]","h-[100%]",3,"nzHoverable","click"],[3,"nzTitle","nzDescription","nzAvatar"],["cardStatusTml",""],["avatarTemplate",""],[1,"mt-[20px]","card-desc-text"],[1,"absolute","top-[14px]","right-[24px]"],["class","text-[12px] font-medium text-[#0A89FF] bg-[#0A89FF1A] px-[4px] py-[2px] leading-[20px] rounded",4,"ngIf"],["class","text-[12px] font-medium text-[#bbbbbb] bg-[#bbbbbb1A] px-[4px] py-[2px] leading-[20px] rounded",4,"ngIf"],[4,"ngIf"],["class","mr-[8px] text-[12px] font-medium text-[#00785A] bg-[#00785A1A] px-[4px] py-[2px] leading-[20px] rounded",4,"ngIf"],[1,"mr-[8px]","text-[12px]","font-medium","text-[#00785A]","bg-[#00785A1A]","px-[4px]","py-[2px]","leading-[20px]","rounded"],[2,"height","45px","width","45px"],["alt","icon","width","35px","height","35px",3,"src"],[1,"text-[12px]","font-medium","text-[#0A89FF]","bg-[#0A89FF1A]","px-[4px]","py-[2px]","leading-[20px]","rounded"],[1,"text-[12px]","font-medium","text-[#bbbbbb]","bg-[#bbbbbb1A]","px-[4px]","py-[2px]","leading-[20px]","rounded"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,W,14,7,"ng-container",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",n.cardList))},dependencies:[u.sg,u.O5,I.bd,I.l7],styles:["[_nghost-%COMP%]     nz-card.ant-card-hoverable:hover{border-color:var(--primary-color);box-shadow:none}[_nghost-%COMP%]     nz-card>.ant-card-body{padding:18px 22px}[_nghost-%COMP%]     nz-card .ant-card-meta-title{font-size:14px;font-weight:700;max-width:calc(100% - 50px)}[_nghost-%COMP%]     .ant-card-meta-detail>div:not(:last-child){margin-bottom:0}[_nghost-%COMP%]     p.card-desc-text{font-size:12px;word-break:break-all;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}"]}),i})();var k=a(999),D=a(5341),y=a(7919);const X=["eoNgTreeDefault"];function ee(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"eo-ng-card-list",8),e.NdJ("cardClick",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.handerCardClick(o))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("cardList",t.filterPluginList())}}function te(i,s){1&i&&e._UZ(0,"eo-ng-empty",9)}let J=(()=>{class i{constructor(t,n,o,l,m,L,M){this.api=t,this.modalService=n,this.navigationService=o,this.router=l,this.route=m,this.baseInfo=L,this.service=M,this.nzDisabled=!1,this.radioOptions=[...G],this.radioValue="",this.showAll=!0,this.groupUuid="",this.queryName="",this.mdFileName="",this.subscription=new h.w0,this.subscription1=new h.w0,this.nodesList=[],this.closeModal=()=>{this.modalRef?.close()},this.navigationService.reqFlashBreadcrumb([{title:"\u4f01\u4e1a\u63d2\u4ef6"}])}ngOnInit(){this.groupUuid=this.baseInfo.allParamsInfo.pluginGroupId,this.subscription=this.router.events.subscribe(t=>{t instanceof c.m2&&(this.groupUuid=this.baseInfo.allParamsInfo.pluginGroupId,this.service.groupUuid=this.groupUuid,this.service.getPluginList())}),this.subscription1=this.service.repFlashList().subscribe(()=>{this.queryName=this.service.queryName,this.service.getPluginList()})}ngOnDestroy(){this.subscription.unsubscribe(),this.subscription1.unsubscribe(),this.service.pluginList=[]}filterPluginList(){return""===this.radioValue?this.service.pluginList:this.service.pluginList.filter(t=>t.enable===this.radioValue)}viewAllPlugins(){this.showAll=!0,this.groupUuid&&this.eoNgTreeDefault?.getTreeNodeByKey(this.groupUuid)?.isSelected&&(this.eoNgTreeDefault.getTreeNodeByKey(this.groupUuid).isSelected=!1),this.activatedNode?.isSelected&&(this.activatedNode.isSelected=!1),this.router.navigate(["/","module-plugin","group","list",""])}disabledEdit(t){this.nzDisabled=t}installPlugin(){this.modalRef=this.modalService.create({nzTitle:"\u5b89\u88c5\u63d2\u4ef6",nzWidth:x.G_,nzContent:O,nzComponentParams:{closeModal:this.closeModal},nzOkDisabled:this.nzDisabled,nzOnOk:t=>(t.submit(),!1)})}handerCardClick(t){this.router.navigate(["../../message",t.id||"test",""],{relativeTo:this.route})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.s),e.Y36(A._B),e.Y36(P.a),e.Y36(c.F0),e.Y36(c.gz),e.Y36(f.D),e.Y36(C))},i.\u0275cmp=e.Xpm({type:i,selectors:[["eo-ng-plugin-list"]],viewQuery:function(t,n){if(1&t&&e.Gf(X,5),2&t){let o;e.iGM(o=e.CRH())&&(n.eoNgTreeDefault=o.first)}},decls:11,vars:5,consts:[[1,"h-[100%]"],[1,"list-header","pl-btnbase","pr-btnrbase","py-btnybase","flex","flex-nowrap","items-center","justify-between"],["eo-ng-button","","eoNgUserAccess","module-plugin",1,"ant-btn-primary",3,"disabledEdit","click"],["nzStyle","button","nzButtonStyle","solid",3,"ngModel","nzOptions","nzDisabled","ngModelChange"],[1,"list-content","pb-[4px]","h-[calc(100%_-_64px)]","overflow-y-auto","border-0","border-t-[1px]","border-solid","border-color-base"],[3,"cardList","cardClick",4,"ngIf","ngIfElse"],["class","w-[100%]"],["emptyTpl",""],[3,"cardList","cardClick"],["nzMainTitle","\u6682\u65e0\u6570\u636e","nzInputImage","simple"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),e.NdJ("disabledEdit",function(l){return n.disabledEdit(l)})("click",function(){return n.installPlugin()}),e._uU(4," \u4e0a\u4f20\u63d2\u4ef6 "),e.qZA()(),e.TgZ(5,"div")(6,"eo-ng-radio-group",3),e.NdJ("ngModelChange",function(l){return n.radioValue=l}),e.qZA()()(),e.TgZ(7,"div",4),e.YNc(8,ee,1,1,"eo-ng-card-list",5),e.YNc(9,te,1,0,"ng-template",6,7,e.W1O),e.qZA()()),2&t){const o=e.MAs(10);e.xp6(6),e.Q6J("ngModel",n.radioValue)("nzOptions",n.radioOptions)("nzDisabled",n.nzDisabled),e.xp6(2),e.Q6J("ngIf",n.filterPluginList().length)("ngIfElse",o)}},dependencies:[u.O5,r.JJ,r.On,j,k.g,_.qK,D.wT,y.M],styles:["[_nghost-%COMP%]    {display:block;height:100%;overflow:hidden}"]}),i})(),ne=(()=>{class i{constructor(t){this.router=t,"/module-plugin"===this.router.url&&this.router.navigate(["/","module-plugin","group","list"])}ngDoCheck(){"/module-plugin"===this.router.url&&this.router.navigate(["/","module-plugin","group","list"])}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(c.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["eo-ng-plugin-management"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[c.lC],encapsulation:2}),i})();var w=a(2366),ie=a(2663);function oe(i,s){1&i&&(e.TgZ(0,"nz-form-item",4)(1,"nz-form-label",5),e._uU(2,"\u6a21\u5757\u540d\uff1a"),e.qZA(),e.TgZ(3,"nz-form-control"),e._UZ(4,"input",6),e.qZA()())}function se(i,s){1&i&&(e.TgZ(0,"nz-form-item",4)(1,"nz-form-label",5),e._uU(2,"\u670d\u52a1\u5668\u5730\u5740\uff1a"),e.qZA(),e.TgZ(3,"nz-form-control"),e._UZ(4,"input",7),e.qZA()())}function le(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"label",10),e._uU(3,"Header\u53c2\u6570\uff1a"),e.qZA()(),e.TgZ(4,"div",11)(5,"div",12)(6,"eo-ng-apinto-table",13),e.NdJ("nzDataChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.headerList=o)}),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("nzTbody",t.configTableBody)("nzThead",t.configTableHeadName)("nzData",t.headerList)("nzNoScroll",!0)("nzCheckAddRow",t.nzCheckAddRow)}}function ae(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"label",10),e._uU(3,"Query\u53c2\u6570\uff1a"),e.qZA()(),e.TgZ(4,"div",11)(5,"div",14)(6,"eo-ng-apinto-table",13),e.NdJ("nzDataChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.queryList=o)}),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("nzTbody",t.configTableBody)("nzThead",t.configTableHeadName)("nzData",t.queryList)("nzNoScroll",!0)("nzCheckAddRow",t.nzCheckAddRow)}}function re(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",15)(1,"div",9)(2,"label",10),e._uU(3,"Initialize\u53c2\u6570\uff1a"),e.qZA()(),e.TgZ(4,"div",11)(5,"div",14)(6,"eo-ng-apinto-table",13),e.NdJ("nzDataChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.initializeList=o)}),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("nzTbody",t.configTableBody)("nzThead",t.configTableHeadName)("nzData",t.initializeList)("nzNoScroll",!0)("nzCheckAddRow",t.nzCheckAddRow)}}let ue=(()=>{class i{constructor(t,n,o,l){this.fb=t,this.api=n,this.message=o,this.navService=l,this.pluginId="",this.configTableHeadName=[...Q],this.configTableBody=[...q],this.name="",this.server="",this.showServer=!1,this.nameConflict=!1,this.autoTips=g.Sm,this.validateForm=new r.cw({}),this.headerList=[],this.queryList=[],this.initializeList=[],this.navigationList=[],this.nzDisabled=!1,this.closeModal=null,this.nzCheckAddRow=()=>!1,this.validateForm=this.fb.group({name:["",[r.kI.required]],server:["",[r.kI.required]]})}ngOnInit(){}checkValid(){let t=!0;return this.nameConflict&&this.validateForm.controls.name.invalid&&(t=!1,this.validateForm.controls.name.markAsDirty(),this.validateForm.controls.name.updateValueAndValidity({onlySelf:!0})),this.showServer&&this.validateForm.controls.server.invalid&&(t=!1,this.validateForm.controls.server.markAsDirty(),this.validateForm.controls.server.updateValueAndValidity({onlySelf:!0})),t}enablePlugin(){if(this.checkValid()){const t={name:this.nameConflict?this.validateForm.controls.name.value:this.name||"",server:this.validateForm.controls.server.value,header:this.headerList.map(n=>({name:n.name,value:n.value})),query:this.queryList.map(n=>({name:n.name,value:n.value})),initialize:this.initializeList.map(n=>({name:n.name,value:n.value}))};this.api.post("system/plugin/enable",t,{id:this.pluginId}).subscribe(n=>{if(0===n.code){this.message.success(n.msg||"\u542f\u7528\u63d2\u4ef6\u6210\u529f");const o=this.navService.getMenuList().subscribe(()=>{o.unsubscribe()});this.refreshPage&&this.refreshPage(),this.closeModal&&this.closeModal()}})}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.QS),e.Y36(d.s),e.Y36(b.A),e.Y36(P.a))},i.\u0275cmp=e.Xpm({type:i,selectors:[["eo-ng-plugin-config"]],decls:7,vars:8,consts:[["nz-form","","autocomplete","off",3,"nzNoColon","nzAutoTips","formGroup"],["class","form-row",4,"ngIf"],["nz-row","","nzJustify","start","nzAligh","top","class","mb-formtop",4,"ngIf"],["nz-row","","nzJustify","start","nzAligh","top",4,"ngIf"],[1,"form-row"],["nzRequired","",1,"w-[124px]"],["eo-ng-input","","name","name","required","","placeholder","\u8bf7\u8f93\u5165","formControlName","name",1,"w-INPUT_NORMAL"],["eo-ng-input","","name","server","required","","placeholder","\u8bf7\u8f93\u5165","formControlName","server",1,"w-INPUT_NORMAL"],["nz-row","","nzJustify","start","nzAligh","top",1,"mb-formtop"],["nz-col",""],[1,"label","table-label","block","w-[124px]"],["nz-col","",1,"",2,"width","100%"],[1,"drawer-list-content"],[1,"drawer-table",3,"nzTbody","nzThead","nzData","nzNoScroll","nzCheckAddRow","nzDataChange"],[1,"drawer-list-content",2,"padding-bottom","0px"],["nz-row","","nzJustify","start","nzAligh","top"]],template:function(t,n){1&t&&(e.TgZ(0,"div")(1,"form",0),e.YNc(2,oe,5,0,"nz-form-item",1),e.YNc(3,se,5,0,"nz-form-item",1),e.qZA(),e.YNc(4,le,7,5,"div",2),e.YNc(5,ae,7,5,"div",2),e.YNc(6,re,7,5,"div",3),e.qZA()),2&t&&(e.xp6(1),e.Q6J("nzNoColon",!0)("nzAutoTips",n.autoTips)("formGroup",n.validateForm),e.xp6(1),e.Q6J("ngIf",n.nameConflict),e.xp6(1),e.Q6J("ngIf",n.showServer),e.xp6(1),e.Q6J("ngIf",null==n.headerList?null:n.headerList.length),e.xp6(1),e.Q6J("ngIf",null==n.queryList?null:n.queryList.length),e.xp6(1),e.Q6J("ngIf",null==n.initializeList?null:n.initializeList.length))},dependencies:[u.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.sg,r.u,w.oO,T.t3,T.SK,p.Lr,p.Nx,p.iK,p.Fd,ie.a],encapsulation:2}),i})();var N=a(5432);function ce(i,s){1&i&&(e.TgZ(0,"span",13),e._uU(1,"\u5df2\u542f\u7528"),e.qZA())}function de(i,s){1&i&&(e.TgZ(0,"span",14),e._uU(1," \u672a\u542f\u7528"),e.qZA())}function ge(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.enablePlugin())}),e._uU(1," \u542f\u7528 "),e.qZA()}}function pe(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.disablePluginModal(!1))}),e._uU(1," \u505c\u7528 "),e.qZA()}}function me(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.disablePluginModal(!0))}),e._uU(1," \u5378\u8f7d "),e.qZA()}}function he(i,s){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,ge,2,0,"button",15),e.YNc(2,pe,2,0,"button",16),e.YNc(3,me,2,0,"button",16),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.enable),e.xp6(1),e.Q6J("ngIf",t.enable&&t.canDisable),e.xp6(1),e.Q6J("ngIf",!t.enable&&t.uninstall)}}function fe(i,s){1&i&&e._UZ(0,"eo-ng-empty",19)}function _e(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"markdown",20),e.NdJ("load",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.loadMd())})("error",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.onError(o))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("src",t.getMd())("srcRelativeLink",!0)}}let S=(()=>{class i{constructor(t,n,o,l,m,L,M,ke,De){this.message=t,this.modalService=n,this.api=o,this.baseInfo=l,this.navigationService=m,this.markdownService=L,this.router=M,this.fb=ke,this.urlPrefix=De,this.title="",this.resume="",this.icon="./assets/default-plugin-icon.svg",this.enable=!1,this.uninstall=!1,this.pluginId="",this.mdFileName="",this.showEmpty=!1,this.canDisable=!1,this.showBtn=!1,this.getPluginDetail=()=>{this.api.get("system/plugin/info",{id:this.pluginId}).subscribe(v=>{0===v.code&&(this.title=v.data.plugin.cname,this.resume=v.data.plugin.resume,this.icon=v.data.plugin.icon?`${this.urlPrefix}plugin/icon/${this.pluginId}/${v.data.plugin.icon}`:"./assets/default-plugin-icon.svg",this.enable=v.data.plugin.enable,this.uninstall=v.data.plugin.uninstall,this.canDisable=v.data.plugin.canDisable,this.showBtn=!0)})},this.navigationService.reqFlashBreadcrumb([{title:"\u4f01\u4e1a\u63d2\u4ef6",routerLink:["/","module-plugin","group","list",""]},{title:"\u63d2\u4ef6\u8be6\u60c5"}])}ngOnInit(){this.pluginId=this.baseInfo.allParamsInfo.pluginId,this.mdFileName=this.baseInfo.allParamsInfo.mdFileName,this.getPluginDetail(),this.markdownService.renderer.link=(t,n,o)=>{let l="";return l=t&&/^(?![http])[.]*/.test(t)&&/^(?![#])[.]*/.test(t)&&t.includes(".md")||t&&/^(?![http])[.]*/.test(t)&&/^(?![#])[.]*/.test(t)?`<a href="plugin/message/${this.pluginId}/${t}">${o}</a>`:'<a  role="link"  tabindex="0" target="_blank" rel="nofollow noopener noreferrer" href="'+t+'">'+o+"</a>",l},this.markdownService.renderer.image=(t,n,o)=>{let l;if(t&&/^(?![http])[.]*/.test(t)){const m=t.replace("./resource","/resource");l=`<image src="${this.urlPrefix}plugin/info/${this.pluginId}${m}" alt=${o}/>`}else l=`<image src="${t}" alt=${o}/>`;return l}}getMd(){return`../../plugin/md/${this.pluginId}/${this.mdFileName||""}`}loadMd(){this.showEmpty=!1}onError(t){console.error("\u89e3\u6790md\u6587\u6863\u51fa\u73b0\u95ee\u9898",t),this.showEmpty=!0}enablePlugin(){const t={name:"",server:"",headerList:[],queryList:[],initializeList:[],showServer:!1,nameConflict:!1};this.api.get("system/plugin/enable",{id:this.pluginId}).subscribe(n=>{if(30001===n.code){this.message.success(n.msg||"\u542f\u7528\u63d2\u4ef6\u6210\u529f");const o=this.navigationService.getMenuList().subscribe(()=>{o.unsubscribe()});this.getPluginDetail()}else 0===n.code&&(t.name=n.data.module.name,t.server=n.data.module.server,t.headerList=n.data.render.headers.map(o=>{o.placeholder=o.placeholder||"\u8bf7\u8f93\u5165";const l=this.findConfigValue(n.data.module.header,o.name);return o.value=void 0===l?o.value:l,o}),t.queryList=n.data.render.querys.map(o=>{o.placeholder=o.placeholder||"\u8bf7\u8f93\u5165";const l=this.findConfigValue(n.data.module.query,o.name);return o.value=void 0===l?o.value:l,o}),t.initializeList=n.data.render.initialize.map(o=>{o.placeholder=o.placeholder||"\u8bf7\u8f93\u5165";const l=this.findConfigValue(n.data.module.initialize,o.name);return o.value=void 0===l?o.value:l,o}),t.showServer=n.data.render.internet,t.nameConflict=n.data.render.nameConflict,t.showServer||t.nameConflict||t.headerList.length||t.queryList.length||t.initializeList.length?this.modalRef=this.modalService.create({nzTitle:"\u542f\u7528",nzWidth:x.iE,nzContent:ue,nzComponentParams:{...t,refreshPage:this.getPluginDetail,pluginId:this.pluginId,validateForm:this.fb.group({name:[t.name,[r.kI.required]],server:[t.server,[r.kI.required]]}),closeModal:()=>{this.modalRef?.close()}},nzOkText:"\u786e\u5b9a",nzCancelText:"\u53d6\u6d88",nzOnOk:o=>(o.enablePlugin(),!1)}):this.api.post("system/plugin/enable",{name:t.name},{id:this.pluginId}).subscribe(o=>{if(0===o.code){this.message.success(o.msg||"\u542f\u7528\u63d2\u4ef6\u6210\u529f");const l=this.navigationService.getMenuList().subscribe(()=>{l.unsubscribe()});this.getPluginDetail(),this.modalRef?.close()}}))})}findConfigValue(t,n){for(const o of t)if(o.name===n)return o.value}disablePluginModal(t){this.modalRef=this.modalService.create({nzTitle:t?"\u5378\u8f7d":"\u505c\u7528",nzContent:`\u8be5\u63d2\u4ef6${t?"\u5378\u8f7d\u540e\u5c06\u65e0\u6cd5\u627e\u56de":"\u505c\u7528\u540e\u5c06\u65e0\u6cd5\u518d\u4f7f\u7528"}\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u8981${t?"\u5378\u8f7d":"\u505c\u7528"}\uff1f`,nzClosable:!0,nzClassName:"delete-modal",nzWidth:x.G_,nzOkText:"\u786e\u5b9a",nzOkDanger:!0,nzCancelText:"\u53d6\u6d88",nzOnOk:()=>(t?this.deletePlugin():this.disablePlugin(),!1)})}disablePlugin(){this.api.post("system/plugin/disable",{},{id:this.pluginId}).subscribe(t=>{if(0===t.code){this.message.success(t.msg||"\u7981\u7528\u6210\u529f");const n=this.navigationService.getMenuList().subscribe(()=>{n.unsubscribe()});this.getPluginDetail(),this.modalRef?.close()}})}deletePlugin(){this.api.post("system/plugin/uninstall",{},{id:this.pluginId}).subscribe(t=>{if(0===t.code){this.message.success(t.msg||"\u5378\u8f7d\u6210\u529f");const n=this.navigationService.getMenuList().subscribe(()=>{n.unsubscribe()});this.router.navigate(["/","module-plugin","group","list"]),this.modalRef?.close()}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(b.A),e.Y36(A._B),e.Y36(d.s),e.Y36(f.D),e.Y36(P.a),e.Y36(N.Zy),e.Y36(c.F0),e.Y36(r.QS),e.Y36(d.T))},i.\u0275cmp=e.Xpm({type:i,selectors:[["eo-ng-plugin-message"]],decls:17,vars:8,consts:[[1,"mx-[40px]","my-[20px]"],[1,"flex","justify-between","mb-btnybase","items-center"],[1,"flex"],[1,"mr-btnrbase","w-[50px]","h-[50px]"],["alt","icon","width","50px","height","50px",1,"mr-btnrbase",3,"src"],[1,"flex","flex-col","justify-around"],[1,"text-[14px]","font-medium"],["class","mr-[8px] font-medium text-[#0A89FF] bg-[#0A89FF1A] px-[4px] py-[2px] leading-[20px] rounded",4,"ngIf"],["class","mr-[8px] font-medium text-[#bbbbbb] bg-[#bbbbbb1A] px-[4px] py-[2px] leading-[20px] rounded",4,"ngIf"],[4,"ngIf"],[1,"flex-1","p-[40px]","markdown-block","overflow-auto"],["nzMainTitle","\u6682\u65e0\u6570\u636e","nzInputImage","simple",4,"ngIf"],["class","markdown-body",3,"src","srcRelativeLink","load","error",4,"ngIf"],[1,"mr-[8px]","font-medium","text-[#0A89FF]","bg-[#0A89FF1A]","px-[4px]","py-[2px]","leading-[20px]","rounded"],[1,"mr-[8px]","font-medium","text-[#bbbbbb]","bg-[#bbbbbb1A]","px-[4px]","py-[2px]","leading-[20px]","rounded"],["class","ml-btnybase ant-btn-primary","eo-ng-button","","eoNgUserAccess","module-plugin",3,"click",4,"ngIf"],["class","ml-btnybase","eo-ng-button","","eoNgUserAccess","module-plugin",3,"click",4,"ngIf"],["eo-ng-button","","eoNgUserAccess","module-plugin",1,"ml-btnybase","ant-btn-primary",3,"click"],["eo-ng-button","","eoNgUserAccess","module-plugin",1,"ml-btnybase",3,"click"],["nzMainTitle","\u6682\u65e0\u6570\u636e","nzInputImage","simple"],[1,"markdown-body",3,"src","srcRelativeLink","load","error"]],template:function(t,n){1&t&&(e.TgZ(0,"header",0)(1,"div",1)(2,"div",2)(3,"div",3),e._UZ(4,"img",4),e.qZA(),e.TgZ(5,"div",5)(6,"p",6),e._uU(7),e.qZA(),e.TgZ(8,"p"),e.YNc(9,ce,2,0,"span",7),e.YNc(10,de,2,0,"span",8),e.qZA()()(),e.YNc(11,he,4,3,"div",9),e.qZA(),e.TgZ(12,"p"),e._uU(13),e.qZA()(),e.TgZ(14,"section",10),e.YNc(15,fe,1,0,"eo-ng-empty",11),e.YNc(16,_e,1,2,"markdown",12),e.qZA()),2&t&&(e.xp6(4),e.Q6J("src",n.icon,e.LSH),e.xp6(3),e.Oqu(n.title),e.xp6(2),e.Q6J("ngIf",n.enable),e.xp6(1),e.Q6J("ngIf",!n.enable),e.xp6(1),e.Q6J("ngIf",n.showBtn),e.xp6(2),e.Oqu(n.resume),e.xp6(2),e.Q6J("ngIf",n.showEmpty),e.xp6(1),e.Q6J("ngIf",!n.showEmpty))},dependencies:[u.O5,k.g,_.qK,N.lF,y.M],styles:[".markdown-block[_ngcontent-%COMP%]{border-top:1px solid var(--border-color)}[_nghost-%COMP%]    {height:100%;display:flex;flex-direction:column;overflow-y:hidden}[_nghost-%COMP%]     img{max-width:100%}"]}),i})();var ve=a(2319),be=a(7706),xe=a(6544),U=a(1293);const Ce=["addGroupRef"],ze=["eoNgTreeDefault"],Te=function(i){return{"group-title-selected":i}};function ye(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div")(2,"div",4)(3,"div",5)(4,"eo-ng-search-input-group",6),e.NdJ("eoClick",function(){e.CHM(t);const o=e.oxw();return o.service.queryName="",e.KtG(o.getPluginList())}),e.TgZ(5,"input",7),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.service.queryName=o)})("blur",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.getPluginList())})("keyup.enter",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.getPluginList())}),e.qZA()()(),e.TgZ(6,"div",8,9)(8,"div",10),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.viewAllPlugins())}),e.O4$(),e.TgZ(9,"svg",11),e._UZ(10,"use",12),e.qZA(),e.kcU(),e.TgZ(11,"span"),e._uU(12),e.qZA()(),e.TgZ(13,"div")(14,"eo-ng-tree-default",13,14),e.NdJ("nzClick",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.activeNode(o))}),e.qZA()()(),e._UZ(16,"div",15),e.qZA()(),e.TgZ(17,"div",16),e._UZ(18,"router-outlet"),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(4),e.Q6J("eoInputVal",t.service.queryName)("eoNoWidth",!0),e.xp6(1),e.Q6J("ngModel",t.service.queryName),e.xp6(3),e.Q6J("ngClass",e.VKq(6,Te,t.service.showAll)),e.xp6(4),e.hij("\u6240\u6709\u63d2\u4ef6\uff08",t.service.totalNum,"\uff09"),e.xp6(2),e.Q6J("nzData",t.service.nodesList)}}function Fe(i,s){1&i&&e._UZ(0,"eo-ng-empty",17)}const Ae=[{path:"",component:ne,data:{id:10},children:[{path:"group",component:(()=>{class i{constructor(t,n,o,l,m){this.baseInfo=t,this.api=n,this.router=o,this.navigationService=l,this.service=m,this.addGroupRef="",this.activatedNode=null,this.clusterName="",this.clusterKey="",this.queryName="",this.navigationService.reqFlashBreadcrumb([{title:"\u4f01\u4e1a\u63d2\u4ef6"}])}ngOnInit(){this.service.getPluginList()}viewAllPlugins(){this.service.showAll=!0,this.service.groupUuid&&this.eoNgTreeDefault?.getTreeNodeByKey(this.service.groupUuid)?.isSelected&&(this.eoNgTreeDefault.getTreeNodeByKey(this.service.groupUuid).isSelected=!1),this.activatedNode?.isSelected&&(this.activatedNode.isSelected=!1),this.router.navigate(["/","module-plugin","group","list"])}getPluginList(){this.service.reqFlashList()}activeNode(t){t.keys[0]&&this.service.groupUuid!==t.keys[0]&&this.eoNgTreeDefault?.getTreeNodeByKey(this.service.groupUuid)?.isSelected&&(this.eoNgTreeDefault.getTreeNodeByKey(this.service.groupUuid).isSelected=!1),this.service.showAll=!1,t.node.isExpanded=!t.node.isExpanded,this.router.navigate(t.node.origin.uuid?["/","module-plugin","group","list",t.node.origin.uuid]:["/","module-plugin","group","list",""]),this.activatedNode=t.node}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.D),e.Y36(d.s),e.Y36(c.F0),e.Y36(ve.a),e.Y36(C))},i.\u0275cmp=e.Xpm({type:i,selectors:[["eo-ng-plugin-group"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Ce,7,e.Rgc),e.Gf(ze,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.addGroupRef=o.first),e.iGM(o=e.CRH())&&(n.eoNgTreeDefault=o.first)}},decls:4,vars:2,consts:[["class","flex flex-nowrap justify-start overflow-y-hidden max-h-[calc(100vh_-_50px)]",4,"ngIf","ngIfElse"],[1,"flex","flex-nowrap","justify-start","overflow-y-hidden","max-h-[calc(100vh_-_50px)]"],["class","w-[100%]"],["emptyTpl",""],[1,"inline-block","relative","min-w-GROUP","min-h-[calc(100vh_-_50px)]","spreed-content",2,"width","240px"],[1,"flex","items-center","justify-between","px-[11px]","py-btnbase"],[1,"w-[calc(100%)]",3,"eoInputVal","eoNoWidth","eoClick"],["type","text","eo-ng-input","","placeholder","\u641c\u7d22\u4f01\u4e1a\u63d2\u4ef6\u540d\u79f0",3,"ngModel","ngModelChange","blur","keyup.enter"],[1,"h-[calc(100%_-_56px)]","absolute","overflow-x-hidden","overflow-y-auto","w-[100%]"],["groupComponent",""],[1,"group-title","cursor-pointer",3,"ngClass","click"],[1,"iconpark-icon","mr5","fs18"],["href","#suoyou"],["nzBlockNode","",3,"nzData","nzClick"],["eoNgTreeDefault",""],["maxWidth","450","minWidth","200","eo-ng-tree-drag","",1,"divide_line_ldcc"],[1,"w-[100%]"],["nzMainTitle","\u6682\u65e0\u6570\u636e","nzInputImage","simple"]],template:function(t,n){if(1&t&&(e.YNc(0,ye,19,8,"div",0),e.TgZ(1,"div",1),e.YNc(2,Fe,1,0,"ng-template",2,3,e.W1O),e.qZA()),2&t){const o=e.MAs(3);e.Q6J("ngIf",n.service.nodesList.length>0)("ngIfElse",o)}},dependencies:[u.mk,u.O5,r.Fj,r.JJ,r.On,c.lC,be.h,xe.O,U.pu,w.oO,y.M],encapsulation:2}),i})(),children:[{path:"list",component:J,children:[{path:":pluginGroupId",component:J}]}]},{path:"message/:pluginId",component:S,children:[{path:":mdFileName",component:S}]}]}];let Pe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[c.Bz.forChild(Ae),c.Bz]}),i})();var we=a(2732),Ne=a(3111),Le=a(8344),Me=a(3349),Ze=a(7901);let Ie=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[u.ez,r.u5,r.UX,Pe,we.D,Ze.Z,U.Sn,w.FC,_.r1,p.U5,A.hB,D.sW,Z.cS,Me.gm,N.JP.forChild(),Ne.a,Le.HO,y.p]}),i})()}}]);